# 关系基础与等价关系 - 国际标准版

## Relation Foundation and Equivalence Relations - International Standard Version

## 📚 概述 / Overview

本文档展示从ZFC公理体系到关系基础与等价关系的完整形式化论证，遵循国际数学标准，为数论和抽象代数提供严格的数学基础。

This document demonstrates the complete formal argumentation from ZFC axiom system to relation foundation and equivalence relations, following international mathematical standards, providing rigorous mathematical foundation for number theory and abstract algebra.

## 🏗️ 1. 从ZFC到关系基础的构造 / Construction from ZFC to Relation Foundation

### 1.1 关系的形式化定义 / Formal Definition of Relations

**定义 1.1** (关系) / **Definition 1.1** (Relation)

设 $A$ 是一个集合，$A$ 上的关系是 $A \times A$ 的子集。

Let $A$ be a set, a relation on $A$ is a subset of $A \times A$.

**ZFC形式化表述** / **ZFC Formal Expression**:

```lean
def Relation (A : Type) := Set (A × A)

-- 关系的表示
-- Representation of relations
def Relates {A : Type} (R : Relation A) (a b : A) : Prop :=
  (a, b) ∈ R

-- 关系的基本性质
-- Basic properties of relations
def Reflexive {A : Type} (R : Relation A) : Prop :=
  ∀ a : A, Relates R a a

def Symmetric {A : Type} (R : Relation A) : Prop :=
  ∀ a b : A, Relates R a b → Relates R b a

def Antisymmetric {A : Type} (R : Relation A) : Prop :=
  ∀ a b : A, Relates R a b → Relates R b a → a = b

def Transitive {A : Type} (R : Relation A) : Prop :=
  ∀ a b c : A, Relates R a b → Relates R b c → Relates R a c
```

### 1.2 笛卡尔积的存在性 / Existence of Cartesian Product

**定理 1.1** (笛卡尔积的存在性) / **Theorem 1.1** (Existence of Cartesian Product)

对于任意集合 $A$ 和 $B$，笛卡尔积 $A \times B$ 存在。

For any sets $A$ and $B$, the Cartesian product $A \times B$ exists.

**证明** / **Proof**:

```lean
theorem cartesian_product_exists (A B : Set) : 
  ∃ C : Set, ∀ x, x ∈ C ↔ ∃ a b, a ∈ A ∧ b ∈ B ∧ x = (a, b) :=
begin
  -- 使用ZFC的幂集公理和分离公理
  -- Using ZFC Power Set Axiom and Separation Axiom
  let P := 𝒫(𝒫(A ∪ B)), -- Power set of power set of A ∪ B
  let C := {x ∈ P | ∃ a b, a ∈ A ∧ b ∈ B ∧ x = {{a}, {a, b}}},
  existsi C,
  -- 证明性质
  -- Prove properties
  intro x,
  split,
  { intro h,
    -- 证明 x ∈ C → ∃ a b, a ∈ A ∧ b ∈ B ∧ x = (a, b)
    -- Prove x ∈ C → ∃ a b, a ∈ A ∧ b ∈ B ∧ x = (a, b)
  },
  { intro h,
    -- 证明 ∃ a b, a ∈ A ∧ b ∈ B ∧ x = (a, b) → x ∈ C
    -- Prove ∃ a b, a ∈ A ∧ b ∈ B ∧ x = (a, b) → x ∈ C
  }
end
```

### 1.3 关系的基本性质 / Basic Properties of Relations

**定理 1.2** (关系性质的组合) / **Theorem 1.2** (Combination of Relation Properties)

关系的不同性质可以组合，形成不同类型的特殊关系。

Different properties of relations can be combined to form special types of relations.

**证明** / **Proof**:

```lean
-- 自反且对称的关系
-- Reflexive and symmetric relations
theorem reflexive_symmetric_relation {A : Type} (R : Relation A) :
  Reflexive R → Symmetric R → 
  ∀ a b : A, Relates R a b → Relates R b a :=
begin
  intros h_ref h_sym a b h,
  exact h_sym a b h
end

-- 自反且传递的关系
-- Reflexive and transitive relations
theorem reflexive_transitive_relation {A : Type} (R : Relation A) :
  Reflexive R → Transitive R → 
  ∀ a b c : A, Relates R a b → Relates R b c → Relates R a c :=
begin
  intros h_ref h_trans a b c h1 h2,
  exact h_trans a b c h1 h2
end
```

## 🎯 2. 等价关系的构造 / Construction of Equivalence Relations

### 2.1 等价关系的定义 / Definition of Equivalence Relation

**定义 2.1** (等价关系) / **Definition 2.1** (Equivalence Relation)

集合 $A$ 上的关系 $R$ 是等价关系，如果 $R$ 是自反、对称和传递的。

A relation $R$ on set $A$ is an equivalence relation if $R$ is reflexive, symmetric, and transitive.

**形式化定义** / **Formal Definition**:

```lean
def EquivalenceRelation {A : Type} (R : Relation A) : Prop :=
  Reflexive R ∧ Symmetric R ∧ Transitive R

-- 等价关系的例子
-- Examples of equivalence relations
def EqualityRelation {A : Type} : Relation A :=
  {x : A × A | x.1 = x.2}

theorem equality_is_equivalence {A : Type} :
  EquivalenceRelation (EqualityRelation A) :=
begin
  -- 证明相等关系是等价关系
  -- Prove that equality relation is an equivalence relation
  split,
  { -- 自反性 / Reflexivity
    intro a,
    simp [EqualityRelation, Relates],
    refl
  },
  split,
  { -- 对称性 / Symmetry
    intros a b h,
    simp [EqualityRelation, Relates] at h,
    simp [EqualityRelation, Relates],
    exact h.symm
  },
  { -- 传递性 / Transitivity
    intros a b c h1 h2,
    simp [EqualityRelation, Relates] at h1 h2,
    simp [EqualityRelation, Relates],
    exact eq.trans h1 h2
  }
end
```

### 2.2 等价类 / Equivalence Classes

**定义 2.2** (等价类) / **Definition 2.2** (Equivalence Class)

设 $R$ 是集合 $A$ 上的等价关系，对于 $a \in A$，$a$ 的等价类定义为：
$[a]_R = \{b \in A : a R b\}$

Let $R$ be an equivalence relation on set $A$, for $a \in A$, the equivalence class of $a$ is defined as:
$[a]_R = \{b \in A : a R b\}$

**形式化定义** / **Formal Definition**:

```lean
def EquivalenceClass {A : Type} (R : Relation A) (a : A) : Set A :=
  {b : A | Relates R a b}

-- 等价类的性质
-- Properties of equivalence classes
theorem equivalence_class_reflexive {A : Type} (R : Relation A) 
  (h : EquivalenceRelation R) (a : A) :
  a ∈ EquivalenceClass R a :=
begin
  -- 证明 a ∈ [a]_R
  -- Prove a ∈ [a]_R
  simp [EquivalenceClass],
  exact h.1 a
end

theorem equivalence_class_symmetric {A : Type} (R : Relation A) 
  (h : EquivalenceRelation R) (a b : A) :
  b ∈ EquivalenceClass R a → a ∈ EquivalenceClass R b :=
begin
  -- 证明 b ∈ [a]_R → a ∈ [b]_R
  -- Prove b ∈ [a]_R → a ∈ [b]_R
  intro h1,
  simp [EquivalenceClass] at h1,
  simp [EquivalenceClass],
  exact h.2.1 a b h1
end
```

### 2.3 商集 / Quotient Set

**定义 2.3** (商集) / **Definition 2.3** (Quotient Set)

设 $R$ 是集合 $A$ 上的等价关系，$A$ 关于 $R$ 的商集定义为：
$A/R = \{[a]_R : a \in A\}$

Let $R$ be an equivalence relation on set $A$, the quotient set of $A$ with respect to $R$ is defined as:
$A/R = \{[a]_R : a \in A\}$

**形式化定义** / **Formal Definition**:

```lean
def QuotientSet {A : Type} (R : Relation A) : Set (Set A) :=
  {C : Set A | ∃ a : A, C = EquivalenceClass R a}

-- 商集的基本性质
-- Basic properties of quotient set
theorem quotient_set_partition {A : Type} (R : Relation A) 
  (h : EquivalenceRelation R) :
  ∀ a b : A, 
  EquivalenceClass R a = EquivalenceClass R b ∨ 
  EquivalenceClass R a ∩ EquivalenceClass R b = ∅ :=
begin
  -- 证明等价类要么相等要么不相交
  -- Prove that equivalence classes are either equal or disjoint
  intros a b,
  by_cases h1 : Relates R a b,
  { -- 如果 a R b，则 [a]_R = [b]_R
    -- If a R b, then [a]_R = [b]_R
    left,
    ext x,
    split,
    { intro h2,
      simp [EquivalenceClass] at h2,
      simp [EquivalenceClass],
      exact h.2.2 a b x h1 h2
    },
    { intro h2,
      simp [EquivalenceClass] at h2,
      simp [EquivalenceClass],
      exact h.2.2 b a x (h.2.1 a b h1) h2
    }
  },
  { -- 如果 ¬(a R b)，则 [a]_R ∩ [b]_R = ∅
    -- If ¬(a R b), then [a]_R ∩ [b]_R = ∅
    right,
    ext x,
    split,
    { intro h2,
      simp [EquivalenceClass] at h2,
      exfalso,
      apply h1,
      exact h.2.2 x a b h2.1 h2.2
    },
    { intro h2,
      exfalso,
      exact h2
    }
  }
end
```

## 🔗 3. 等价关系的构造方法 / Construction Methods of Equivalence Relations

### 3.1 从函数构造等价关系 / Constructing Equivalence Relations from Functions

**定理 3.1** (函数诱导的等价关系) / **Theorem 3.1** (Equivalence Relation Induced by Function)

设 $f: A \rightarrow B$ 是一个函数，定义关系 $R_f$ 为：
$a R_f b \leftrightarrow f(a) = f(b)$
则 $R_f$ 是 $A$ 上的等价关系。

Let $f: A \rightarrow B$ be a function, define relation $R_f$ as:
$a R_f b \leftrightarrow f(a) = f(b)$
Then $R_f$ is an equivalence relation on $A$.

**证明** / **Proof**:

```lean
def FunctionInducedRelation {A B : Type} (f : A → B) : Relation A :=
  {x : A × A | f x.1 = f x.2}

theorem function_induced_equivalence {A B : Type} (f : A → B) :
  EquivalenceRelation (FunctionInducedRelation f) :=
begin
  split,
  { -- 自反性 / Reflexivity
    intro a,
    simp [FunctionInducedRelation, Relates],
    refl
  },
  split,
  { -- 对称性 / Symmetry
    intros a b h,
    simp [FunctionInducedRelation, Relates] at h,
    simp [FunctionInducedRelation, Relates],
    exact h.symm
  },
  { -- 传递性 / Transitivity
    intros a b c h1 h2,
    simp [FunctionInducedRelation, Relates] at h1 h2,
    simp [FunctionInducedRelation, Relates],
    exact eq.trans h1 h2
  }
end
```

### 3.2 等价关系的交与并 / Intersection and Union of Equivalence Relations

**定理 3.2** (等价关系的交) / **Theorem 3.2** (Intersection of Equivalence Relations)

设 $R$ 和 $S$ 是集合 $A$ 上的等价关系，则 $R \cap S$ 也是等价关系。

Let $R$ and $S$ be equivalence relations on set $A$, then $R \cap S$ is also an equivalence relation.

**证明** / **Proof**:

```lean
theorem intersection_equivalence {A : Type} (R S : Relation A) 
  (hR : EquivalenceRelation R) (hS : EquivalenceRelation S) :
  EquivalenceRelation (R ∩ S) :=
begin
  split,
  { -- 自反性 / Reflexivity
    intro a,
    split,
    { exact hR.1 a },
    { exact hS.1 a }
  },
  split,
  { -- 对称性 / Symmetry
    intros a b h,
    split,
    { exact hR.2.1 a b h.1 },
    { exact hS.2.1 a b h.2 }
  },
  { -- 传递性 / Transitivity
    intros a b c h1 h2,
    split,
    { exact hR.2.2 a b c h1.1 h2.1 },
    { exact hS.2.2 a b c h1.2 h2.2 }
  }
end
```

## 📊 4. 等价关系在数论中的应用 / Applications of Equivalence Relations in Number Theory

### 4.1 模n同余关系 / Congruence Modulo n

**定理 4.1** (模n同余关系) / **Theorem 4.1** (Congruence Modulo n)

对于正整数 $n$，关系 $\equiv_n$ 定义为：
$a \equiv_n b \leftrightarrow n \mid (a - b)$
则 $\equiv_n$ 是 $\mathbb{Z}$ 上的等价关系。

For positive integer $n$, relation $\equiv_n$ is defined as:
$a \equiv_n b \leftrightarrow n \mid (a - b)$
Then $\equiv_n$ is an equivalence relation on $\mathbb{Z}$.

**证明** / **Proof**:

```lean
def CongruenceModulo (n : ℕ) (hn : n > 0) : Relation ℤ :=
  {x : ℤ × ℤ | n ∣ (x.1 - x.2)}

theorem congruence_equivalence (n : ℕ) (hn : n > 0) :
  EquivalenceRelation (CongruenceModulo n hn) :=
begin
  split,
  { -- 自反性 / Reflexivity
    intro a,
    simp [CongruenceModulo, Relates],
    -- 证明 n ∣ (a - a)
    -- Prove n ∣ (a - a)
    have : a - a = 0, by ring,
    rw this,
    exact dvd_zero n
  },
  split,
  { -- 对称性 / Symmetry
    intros a b h,
    simp [CongruenceModulo, Relates] at h,
    simp [CongruenceModulo, Relates],
    -- 证明 n ∣ (b - a)
    -- Prove n ∣ (b - a)
    have : b - a = -(a - b), by ring,
    rw this,
    exact dvd_neg_of_dvd h
  },
  { -- 传递性 / Transitivity
    intros a b c h1 h2,
    simp [CongruenceModulo, Relates] at h1 h2,
    simp [CongruenceModulo, Relates],
    -- 证明 n ∣ (a - c)
    -- Prove n ∣ (a - c)
    have : a - c = (a - b) + (b - c), by ring,
    rw this,
    exact dvd_add h1 h2
  }
end
```

### 4.2 模n剩余类 / Residue Classes Modulo n

**定理 4.2** (模n剩余类) / **Theorem 4.2** (Residue Classes Modulo n)

对于正整数 $n$，$\mathbb{Z}$ 关于 $\equiv_n$ 的商集 $\mathbb{Z}/n\mathbb{Z}$ 有 $n$ 个元素。

For positive integer $n$, the quotient set $\mathbb{Z}/n\mathbb{Z}$ of $\mathbb{Z}$ with respect to $\equiv_n$ has $n$ elements.

**证明** / **Proof**:

```lean
theorem residue_classes_cardinality (n : ℕ) (hn : n > 0) :
  Fintype.card (QuotientSet (CongruenceModulo n hn)) = n :=
begin
  -- 证明模n剩余类的个数为n
  -- Prove that the number of residue classes modulo n is n
  -- 构造从 {0, 1, ..., n-1} 到商集的双射
  -- Construct a bijection from {0, 1, ..., n-1} to the quotient set
end
```

### 4.3 有理数的构造 / Construction of Rational Numbers

**定理 4.3** (有理数作为等价类) / **Theorem 4.3** (Rational Numbers as Equivalence Classes)

有理数可以构造为 $\mathbb{Z} \times \mathbb{Z}^*$ 上的等价类，其中等价关系定义为：
$(a, b) \sim (c, d) \leftrightarrow a \cdot d = b \cdot c$

Rational numbers can be constructed as equivalence classes on $\mathbb{Z} \times \mathbb{Z}^*$, where the equivalence relation is defined as:
$(a, b) \sim (c, d) \leftrightarrow a \cdot d = b \cdot c$

**证明** / **Proof**:

```lean
def RationalEquivalence : Relation (ℤ × ℤ) :=
  {x : (ℤ × ℤ) × (ℤ × ℤ) | x.1.1 * x.2.2 = x.1.2 * x.2.1}

theorem rational_equivalence_relation :
  EquivalenceRelation RationalEquivalence :=
begin
  split,
  { -- 自反性 / Reflexivity
    intro a,
    simp [RationalEquivalence, Relates],
    ring
  },
  split,
  { -- 对称性 / Symmetry
    intros a b h,
    simp [RationalEquivalence, Relates] at h,
    simp [RationalEquivalence, Relates],
    exact h.symm
  },
  { -- 传递性 / Transitivity
    intros a b c h1 h2,
    simp [RationalEquivalence, Relates] at h1 h2,
    simp [RationalEquivalence, Relates],
    -- 证明传递性
    -- Prove transitivity
    have h3 : a.1 * b.2 = a.2 * b.1, from h1,
    have h4 : b.1 * c.2 = b.2 * c.1, from h2,
    -- 使用代数运算证明
    -- Use algebraic operations to prove
  }
end
```

## 🔬 5. 等价关系的国际标准对照 / International Standard Comparison

### 5.1 与Bourbaki标准的对照 / Comparison with Bourbaki Standards

**Bourbaki等价关系公理** / **Bourbaki Equivalence Relation Axioms**:

1. **自反性** / **Reflexivity**: $\forall a \in A(a R a)$
2. **对称性** / **Symmetry**: $\forall a, b \in A(a R b \rightarrow b R a)$
3. **传递性** / **Transitivity**: $\forall a, b, c \in A(a R b \land b R c \rightarrow a R c)$

**与本文档的对应关系** / **Correspondence with This Document**:

- 自反性 ↔ Reflexive
- 对称性 ↔ Symmetric  
- 传递性 ↔ Transitive

### 5.2 与Wikipedia标准的对照 / Comparison with Wikipedia Standards

**Wikipedia等价关系定义** / **Wikipedia Equivalence Relation Definition**:

等价关系是满足以下三个性质的关系：

1. 自反性
2. 对称性
3. 传递性

**与本文档的对应关系** / **Correspondence with This Document**:

- 完全一致 / Completely consistent

## 📚 参考文献 / References

1. Bourbaki, N. (1974). *Éléments de mathématique: Théorie des ensembles*. Hermann.
2. Halmos, P. R. (1974). *Naive Set Theory*. Springer.
3. Wikipedia contributors. (2024). *Equivalence relation*. Wikipedia.
4. ZFC公理体系. (2024). *Zermelo-Fraenkel Set Theory*. Mathematical Logic.

## 🔗 相关链接 / Related Links

- [偏序关系](02-偏序关系-国际标准版.md)
- [全序关系](03-全序关系-国际标准版.md)
- [良序关系](04-良序关系-国际标准版.md)
- [序数理论](05-序数理论-国际标准版.md)
- [自然数构造](06-自然数构造-国际标准版.md)
- [ZFC公理体系](../ZFC公理体系完整形式化-国际标准对照版.md)

## 术语对照表 / Terminology Table

| 中文 | English |
|---|---|
| 关系 | Relation |
| 自反性 | Reflexivity |
| 对称性 | Symmetry |
| 传递性 | Transitivity |
| 等价关系 | Equivalence relation |
| 等价类 | Equivalence class |
| 商集/分割 | Quotient set/Partition |
| 复合关系 | Composition of relations |
| 逆关系 | Inverse relation |
| 映射/函数 | Mapping/Function |
