# 素数定理 - 五种表征

**创建日期**: 2025年12月1日
**领域**: 解析数论
**难度**: L3

---

## 元信息

| 属性 | 内容 |
|------|------|
| **定理** | 素数定理 (Prime Number Theorem) |
| **领域** | 解析数论 |
| **发现者** | Hadamard, de la Vallée Poussin (1896) |
| **前置知识** | 复分析、Riemann zeta函数 |

---

## 一、符号表征（形式化）

### 1.1 严格陈述

**素数定理**：设π(x)表示不超过x的素数个数，则：

$$\pi(x) \sim \frac{x}{\ln x} \quad (x \to \infty)$$

等价表述：
$$\lim_{x \to \infty} \frac{\pi(x) \ln x}{x} = 1$$

### 1.2 更精确形式

$$\pi(x) = \operatorname{Li}(x) + O(x e^{-c\sqrt{\ln x}})$$

其中 Li(x) = ∫₂ˣ dt/ln t 是对数积分。

### 1.3 Lean 4 形式化

```lean
import Mathlib.NumberTheory.PrimeCounting

-- 素数计数函数
def prime_counting (x : ℝ) : ℕ :=
  (Finset.filter Nat.Prime (Finset.range ⌊x⌋₊)).card

-- 素数定理（渐近形式）
theorem prime_number_theorem :
    Filter.Tendsto (fun x => (prime_counting x : ℝ) * Real.log x / x)
    Filter.atTop (nhds 1) := by
  sorry  -- 深刻的解析数论结果
```

---

## 二、几何表征（可视化）

### 2.1 素数分布图

```text
π(x)与x/ln(x)的比较：
    π(x)
    ↑
    │        ╱ 实际π(x)
    │      ╱
    │    ╱   x/ln(x)近似
    │  ╱
    │╱
    └──────────────────→ x

两条曲线渐近地"贴合"
```

### 2.2 素数间隙

```text
素数间隙 pₙ₊₁ - pₙ 的平均值 ≈ ln(pₙ)

    间隙
    ↑
    │    ∙  ∙
    │  ∙    ∙ ∙
    │∙  ∙ ∙    ∙
    └──────────────→ n

素数越大，平均间隙越大
```

---

## 三、直觉表征（类比）

### 3.1 一句话解释

> **素数定理**：素数像"随机数"一样分布，密度约为1/ln(n)

### 3.2 筛子类比

- 在1到n中，约有n/ln(n)个数"通过"素数筛
- 每个数是素数的"概率"约为1/ln(n)

### 3.3 为什么是ln(n)？

因为要"排除"2,3,5,...的倍数，排除率约为(1-1/2)(1-1/3)(1-1/5)... ≈ 1/ln(n)

---

## 四、计算表征（算法）

### 4.1 Python实现

```python
import numpy as np
from sympy import primepi, log

def verify_pnt(x_values):
    """验证素数定理"""
    for x in x_values:
        pi_x = primepi(x)
        approx = x / np.log(x)
        ratio = pi_x / approx if approx > 0 else 0
        print(f"x={x:>10}: π(x)={pi_x:>8}, x/ln(x)≈{approx:>10.1f}, ratio={ratio:.4f}")

# 验证
verify_pnt([100, 1000, 10000, 100000, 1000000])

# 输出：ratio趋近于1
```

### 4.2 素数生成

```python
def sieve_of_eratosthenes(n):
    """Eratosthenes筛法"""
    is_prime = [True] * (n + 1)
    is_prime[0] = is_prime[1] = False
    for i in range(2, int(n**0.5) + 1):
        if is_prime[i]:
            for j in range(i*i, n + 1, i):
                is_prime[j] = False
    return [i for i in range(n + 1) if is_prime[i]]
```

---

## 五、范畴表征（抽象）

### 5.1 L函数视角

```text
素数定理 ⟺ ζ(s)在Re(s)=1上无零点
├─ Riemann zeta函数: ζ(s) = Σ 1/nˢ
├─ 欧拉乘积: ζ(s) = Π (1 - p⁻ˢ)⁻¹
└─ 零点分布决定素数分布
```

### 5.2 推广

- Dirichlet L函数 → 算术级数中的素数
- Dedekind zeta → 代数数域中的素理想

### 5.3 Riemann假设

若ζ(s)的非平凡零点都满足Re(s)=1/2，则：
$$\pi(x) = \operatorname{Li}(x) + O(\sqrt{x} \ln x)$$

---

## 关联定理

| 定理 | 关系 |
|------|------|
| **Riemann假设** | 更精确的误差项 |
| **Dirichlet定理** | 算术级数中的素数 |
| **Chebyshev估计** | 素数定理的初等版本 |

---

**状态**: ✅ 完成
