# 中心极限定理 - 五种表征

**创建日期**: 2025年12月1日
**领域**: 概率论
**难度**: L2

---

## 元信息

| 属性 | 内容 |
|------|------|
| **定理** | 中心极限定理 (CLT) |
| **领域** | 概率论 |
| **发现者** | de Moivre, Laplace, Lindeberg, Feller |
| **前置知识** | 期望、方差、正态分布 |

---

## 一、符号表征（形式化）

### 1.1 严格陈述

**中心极限定理**：设X₁, X₂, ...是独立同分布随机变量，均值μ，方差σ²<∞，则：

$$\frac{\sum_{i=1}^n X_i - n\mu}{\sigma\sqrt{n}} \xrightarrow{d} N(0,1) \quad (n \to \infty)$$

### 1.2 等价形式

$$\sqrt{n}\leqqft(\bar{X}_n - \mu\right) \xrightarrow{d} N(0, \sigma^2)$$

### 1.3 Lean 4 形式化

```lean
-- 中心极限定理（概念性）
theorem central_limit_theorem {Ω : Type*} [MeasureSpace Ω]
    {X : ℕ → Ω → ℝ} (hX_iid : IID X) (hX_mean : ∀ n, 𝔼[X n] = μ)
    (hX_var : ∀ n, Var[X n] = σ²) (hσ : σ² < ∞) :
    ConvergesInDistribution (fun n => (∑ i in Finset.range n, X i - n*μ) / (σ*√n))
      (Normal 0 1) := by
  sorry  -- 需要概率论形式化
```

---

## 二、几何表征（可视化）

### 2.1 分布演化

```text
n增大时，Sₙ的标准化分布：

    n=1:  ▄▄▄ (原分布)
    n=5:  ▃▅▇▅▃
    n=30: 正态曲线 ╱╲

渐近趋向正态分布
```

### 2.2 直方图演示

```text
    │
    │     ╱╲
    │    ╱  ╲
    │   ╱    ╲
    │  ╱      ╲
    └──────────────
      -3σ  0  +3σ

标准化样本均值的分布
```

---

## 三、直觉表征（类比）

### 3.1 一句话解释

> **中心极限定理**：大量独立随机因素的叠加效应总是趋向正态分布

### 3.2 投票类比

- 每个人的选择是随机的
- 总票数 = 大量随机选择的和
- 总票数的分布接近正态

### 3.3 为什么是正态？

正态分布是"最无信息"的分布（最大熵），大量叠加后"细节"被平均掉

---

## 四、计算表征（算法）

### 4.1 Python实现

```python
import numpy as np
import matplotlib.pyplot as plt
from scipy import stats

def demonstrate_clt(dist, n_samples=10000, sample_sizes=[1, 5, 30, 100]):
    """
    演示中心极限定理
    dist: 原始分布
    """
    fig, axes = plt.subplots(1, len(sample_sizes), figsize=(16, 4))

    for ax, n in zip(axes, sample_sizes):
        # 生成n_samples个样本均值
        means = []
        for _ in range(n_samples):
            sample = dist.rvs(size=n)
            means.append(np.mean(sample))

        # 标准化
        mu = dist.mean()
        sigma = dist.std()
        standardized = (np.array(means) - mu) / (sigma / np.sqrt(n))

        # 绘制直方图
        ax.hist(standardized, bins=50, density=True, alpha=0.7)

        # 叠加标准正态
        x = np.linspace(-4, 4, 100)
        ax.plot(x, stats.norm.pdf(x), 'r-', linewidth=2)
        ax.set_title(f'n = {n}')

    plt.tight_layout()
    plt.savefig('clt_demo.png')

# 演示：均匀分布
demonstrate_clt(stats.uniform(0, 1))
```

### 4.2 数值验证

```python
def verify_clt(dist, n, n_samples=100000):
    """验证CLT的精度"""
    mu = dist.mean()
    sigma = dist.std()

    means = [np.mean(dist.rvs(size=n)) for _ in range(n_samples)]
    standardized = (np.array(means) - mu) / (sigma / np.sqrt(n))

    # 与标准正态比较
    ks_stat, p_value = stats.kstest(standardized, 'norm')
    print(f"n={n}: KS统计量={ks_stat:.4f}, p值={p_value:.4f}")

# 验证：指数分布
for n in [10, 30, 100, 500]:
    verify_clt(stats.expon(scale=1), n)
```

---

## 五、范畴表征（抽象）

### 5.1 范畴视角

```text
CLT = 概率测度空间的泛函极限
├─ 卷积：μ * ν（独立和的分布）
├─ 自卷积：μ^*n（n个独立和）
├─ 标准化后趋于高斯
└─ 正态分布是"吸引子"
```

### 5.2 推广

- **Berry-Esseen定理**：收敛速度O(1/√n)
- **Lindeberg条件**：不需要同分布
- **大偏差原理**：尾部行为

### 5.3 信息论视角

```text
正态分布 = 最大熵分布（给定均值和方差）
CLT = 随着卷积，熵增加趋于最大
```

---

## 关联定理

| 定理 | 关系 |
|------|------|
| **大数定律** | 样本均值的a.s.收敛 |
| **Berry-Esseen** | 收敛速度 |
| **Lindeberg-Feller** | 推广条件 |

---

**状态**: ✅ 完成
