# ä¸­å¿ƒæé™å®šç† - äº”ç§è¡¨å¾

**åˆ›å»ºæ—¥æœŸ**: 2025å¹´12æœˆ1æ—¥
**é¢†åŸŸ**: æ¦‚ç‡è®º
**éš¾åº¦**: L2

---

## å…ƒä¿¡æ¯

| å±æ€§ | å†…å®¹ |
|------|------|
| **å®šç†** | ä¸­å¿ƒæé™å®šç† (CLT) |
| **é¢†åŸŸ** | æ¦‚ç‡è®º |
| **å‘ç°è€…** | de Moivre, Laplace, Lindeberg, Feller |
| **å‰ç½®çŸ¥è¯†** | æœŸæœ›ã€æ–¹å·®ã€æ­£æ€åˆ†å¸ƒ |

---

## ä¸€ã€ç¬¦å·è¡¨å¾ï¼ˆå½¢å¼åŒ–ï¼‰

### 1.1 ä¸¥æ ¼é™ˆè¿°

**ä¸­å¿ƒæé™å®šç†**ï¼šè®¾Xâ‚, Xâ‚‚, ...æ˜¯ç‹¬ç«‹åŒåˆ†å¸ƒéšæœºå˜é‡ï¼Œå‡å€¼Î¼ï¼Œæ–¹å·®ÏƒÂ²<âˆï¼Œåˆ™ï¼š

$$\frac{\sum_{i=1}^n X_i - n\mu}{\sigma\sqrt{n}} \xrightarrow{d} N(0,1) \quad (n \to \infty)$$

### 1.2 ç­‰ä»·å½¢å¼

$$\sqrt{n}\left(\bar{X}_n - \mu\right) \xrightarrow{d} N(0, \sigma^2)$$

### 1.3 Lean 4 å½¢å¼åŒ–

```lean
-- ä¸­å¿ƒæé™å®šç†ï¼ˆæ¦‚å¿µæ€§ï¼‰
theorem central_limit_theorem {Î© : Type*} [MeasureSpace Î©]
    {X : â„• â†’ Î© â†’ â„} (hX_iid : IID X) (hX_mean : âˆ€ n, ğ”¼[X n] = Î¼)
    (hX_var : âˆ€ n, Var[X n] = ÏƒÂ²) (hÏƒ : ÏƒÂ² < âˆ) :
    ConvergesInDistribution (fun n => (âˆ‘ i in Finset.range n, X i - n*Î¼) / (Ïƒ*âˆšn))
      (Normal 0 1) := by
  sorry  -- éœ€è¦æ¦‚ç‡è®ºå½¢å¼åŒ–
```

---

## äºŒã€å‡ ä½•è¡¨å¾ï¼ˆå¯è§†åŒ–ï¼‰

### 2.1 åˆ†å¸ƒæ¼”åŒ–

```text
nå¢å¤§æ—¶ï¼ŒSâ‚™çš„æ ‡å‡†åŒ–åˆ†å¸ƒï¼š

    n=1:  â–„â–„â–„ (åŸåˆ†å¸ƒ)
    n=5:  â–ƒâ–…â–‡â–…â–ƒ
    n=30: æ­£æ€æ›²çº¿ â•±â•²

æ¸è¿‘è¶‹å‘æ­£æ€åˆ†å¸ƒ
```

### 2.2 ç›´æ–¹å›¾æ¼”ç¤º

```text
    â”‚
    â”‚     â•±â•²
    â”‚    â•±  â•²
    â”‚   â•±    â•²
    â”‚  â•±      â•²
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      -3Ïƒ  0  +3Ïƒ

æ ‡å‡†åŒ–æ ·æœ¬å‡å€¼çš„åˆ†å¸ƒ
```

---

## ä¸‰ã€ç›´è§‰è¡¨å¾ï¼ˆç±»æ¯”ï¼‰

### 3.1 ä¸€å¥è¯è§£é‡Š

> **ä¸­å¿ƒæé™å®šç†**ï¼šå¤§é‡ç‹¬ç«‹éšæœºå› ç´ çš„å åŠ æ•ˆåº”æ€»æ˜¯è¶‹å‘æ­£æ€åˆ†å¸ƒ

### 3.2 æŠ•ç¥¨ç±»æ¯”

- æ¯ä¸ªäººçš„é€‰æ‹©æ˜¯éšæœºçš„
- æ€»ç¥¨æ•° = å¤§é‡éšæœºé€‰æ‹©çš„å’Œ
- æ€»ç¥¨æ•°çš„åˆ†å¸ƒæ¥è¿‘æ­£æ€

### 3.3 ä¸ºä»€ä¹ˆæ˜¯æ­£æ€ï¼Ÿ

æ­£æ€åˆ†å¸ƒæ˜¯"æœ€æ— ä¿¡æ¯"çš„åˆ†å¸ƒï¼ˆæœ€å¤§ç†µï¼‰ï¼Œå¤§é‡å åŠ å"ç»†èŠ‚"è¢«å¹³å‡æ‰

---

## å››ã€è®¡ç®—è¡¨å¾ï¼ˆç®—æ³•ï¼‰

### 4.1 Pythonå®ç°

```python
import numpy as np
import matplotlib.pyplot as plt
from scipy import stats

def demonstrate_clt(dist, n_samples=10000, sample_sizes=[1, 5, 30, 100]):
    """
    æ¼”ç¤ºä¸­å¿ƒæé™å®šç†
    dist: åŸå§‹åˆ†å¸ƒ
    """
    fig, axes = plt.subplots(1, len(sample_sizes), figsize=(16, 4))

    for ax, n in zip(axes, sample_sizes):
        # ç”Ÿæˆn_samplesä¸ªæ ·æœ¬å‡å€¼
        means = []
        for _ in range(n_samples):
            sample = dist.rvs(size=n)
            means.append(np.mean(sample))

        # æ ‡å‡†åŒ–
        mu = dist.mean()
        sigma = dist.std()
        standardized = (np.array(means) - mu) / (sigma / np.sqrt(n))

        # ç»˜åˆ¶ç›´æ–¹å›¾
        ax.hist(standardized, bins=50, density=True, alpha=0.7)

        # å åŠ æ ‡å‡†æ­£æ€
        x = np.linspace(-4, 4, 100)
        ax.plot(x, stats.norm.pdf(x), 'r-', linewidth=2)
        ax.set_title(f'n = {n}')

    plt.tight_layout()
    plt.savefig('clt_demo.png')

# æ¼”ç¤ºï¼šå‡åŒ€åˆ†å¸ƒ
demonstrate_clt(stats.uniform(0, 1))
```

### 4.2 æ•°å€¼éªŒè¯

```python
def verify_clt(dist, n, n_samples=100000):
    """éªŒè¯CLTçš„ç²¾åº¦"""
    mu = dist.mean()
    sigma = dist.std()

    means = [np.mean(dist.rvs(size=n)) for _ in range(n_samples)]
    standardized = (np.array(means) - mu) / (sigma / np.sqrt(n))

    # ä¸æ ‡å‡†æ­£æ€æ¯”è¾ƒ
    ks_stat, p_value = stats.kstest(standardized, 'norm')
    print(f"n={n}: KSç»Ÿè®¡é‡={ks_stat:.4f}, på€¼={p_value:.4f}")

# éªŒè¯ï¼šæŒ‡æ•°åˆ†å¸ƒ
for n in [10, 30, 100, 500]:
    verify_clt(stats.expon(scale=1), n)
```

---

## äº”ã€èŒƒç•´è¡¨å¾ï¼ˆæŠ½è±¡ï¼‰

### 5.1 èŒƒç•´è§†è§’

```text
CLT = æ¦‚ç‡æµ‹åº¦ç©ºé—´çš„æ³›å‡½æé™
â”œâ”€ å·ç§¯ï¼šÎ¼ * Î½ï¼ˆç‹¬ç«‹å’Œçš„åˆ†å¸ƒï¼‰
â”œâ”€ è‡ªå·ç§¯ï¼šÎ¼^*nï¼ˆnä¸ªç‹¬ç«‹å’Œï¼‰
â”œâ”€ æ ‡å‡†åŒ–åè¶‹äºé«˜æ–¯
â””â”€ æ­£æ€åˆ†å¸ƒæ˜¯"å¸å¼•å­"
```

### 5.2 æ¨å¹¿

- **Berry-Esseenå®šç†**ï¼šæ”¶æ•›é€Ÿåº¦O(1/âˆšn)
- **Lindebergæ¡ä»¶**ï¼šä¸éœ€è¦åŒåˆ†å¸ƒ
- **å¤§åå·®åŸç†**ï¼šå°¾éƒ¨è¡Œä¸º

### 5.3 ä¿¡æ¯è®ºè§†è§’

```text
æ­£æ€åˆ†å¸ƒ = æœ€å¤§ç†µåˆ†å¸ƒï¼ˆç»™å®šå‡å€¼å’Œæ–¹å·®ï¼‰
CLT = éšç€å·ç§¯ï¼Œç†µå¢åŠ è¶‹äºæœ€å¤§
```

---

## å…³è”å®šç†

| å®šç† | å…³ç³» |
|------|------|
| **å¤§æ•°å®šå¾‹** | æ ·æœ¬å‡å€¼çš„a.s.æ”¶æ•› |
| **Berry-Esseen** | æ”¶æ•›é€Ÿåº¦ |
| **Lindeberg-Feller** | æ¨å¹¿æ¡ä»¶ |

---

**çŠ¶æ€**: âœ… å®Œæˆ
