---
msc_primary: "26A15"
msc_secondary: ["54C30"]
---

# 介值定理 - 五种表征

**创建日期**: 2025年12月1日
**领域**: 实分析
**难度**: L1

---

## 元信息

| 属性 | 内容 |
|------|------|
| **定理** | 介值定理 (Intermediate Value Theorem) |
| **领域** | 实分析 |
| **发现者** | Bolzano (1817), Cauchy (1821) |
| **前置知识** | 连续性、实数完备性 |
| **Mathlib** | `Mathlib.Topology.Order.IntermediateValue` |

---

## 一、符号表征（形式化）

### 1.1 严格陈述

**定理（介值定理）**：设 f: [a,b] → ℝ 连续，且 f(a) < f(b)（或 f(a) > f(b)），则对任意 c ∈ (f(a), f(b))，存在 ξ ∈ (a,b) 使得 f(ξ) = c。

**等价表述**：连续函数的像是连通集（区间）

### 1.2 Lean 4 形式化

```lean
import Mathlib.Topology.Order.IntermediateValue

-- 介值定理
theorem intermediate_value_theorem {f : ℝ → ℝ} {a b : ℝ} (hab : a ≤ b)
    (hf : Continuous f) {y : ℝ}
    (hy : y ∈ Set.Icc (f a) (f b) ∨ y ∈ Set.Icc (f b) (f a)) :
    ∃ x ∈ Set.Icc a b, f x = y := by
  exact intermediate_value_Icc hab hf.continuousOn hy

-- 零点存在定理（特例）
theorem bolzano {f : ℝ → ℝ} {a b : ℝ} (hab : a < b)
    (hf : ContinuousOn f (Set.Icc a b))
    (ha : f a < 0) (hb : 0 < f b) :
    ∃ c ∈ Set.Ioo a b, f c = 0 := by
  have h : (0 : ℝ) ∈ Set.Icc (f a) (f b) := ⟨le_of_lt ha, le_of_lt hb⟩
  obtain ⟨c, hc, hfc⟩ := intermediate_value_Icc (le_of_lt hab) hf h
  exact ⟨c, ⟨hc.1.lt_of_ne (fun h => by simp [h] at ha),
             hc.2.lt_of_ne (fun h => by simp [← h] at hb)⟩, hfc⟩
```

### 1.3 证明梗概

```text
        [介值定理证明]
              │
    使用实数完备性（上确界原理）
              │
    ┌─────────┴─────────┐
    │                   │
[构造集合]           [证明]
S = {x∈[a,b]: f(x)<c}  ξ = sup S
    │                   │
    │              f(ξ)=c
    │                   │
    └─────────┬─────────┘
              │
    用连续性排除 f(ξ)<c 和 f(ξ)>c
```

---

## 二、几何表征（可视化）

### 2.1 核心图示

```text
    y
    ↑
f(b)├─────────────────●
    │               ／
  c ├─ ─ ─ ─ ─ ─ ●─ ─ ─ ← 必经过这条水平线
    │          ／
    │        ／
    │      ／
f(a)├────●
    │
    └────┼────┼────┼────→ x
         a    ξ    b

    连续曲线从 f(a) 到 f(b)
    必须经过中间的每个值！
```

### 2.2 不能"跳过"

```text
    ┌──────────────────────┐
    │   连续函数不能"跳过"  │
    │                      │
    │      ●               │
    │     ╱                │
    │    ╱   不能这样！     │
    │   ╱    ╲             │
    │  ●      ●            │
    │                      │
    └──────────────────────┘

    如果函数值从下到上
    必须经过所有中间值
```

### 2.3 等高线直觉

```text
爬山类比：

    山顶 f(b) = 1000m
        ↑
        │  ← 必经800m
        │  ← 必经600m
        │  ← 必经400m
        ↓
    山脚 f(a) = 100m

    从山脚走到山顶
    必然经过每个高度！
```

---

## 三、直觉表征（类比）

### 3.1 一句话解释

> **介值定理**：连续画一条曲线，从A点到B点，中间的每个高度都会被经过

### 3.2 生活类比

**温度变化**：

```text
早上6点温度：10°C
下午2点温度：30°C

如果温度连续变化（没有瞬间跳变）
则在6点到14点之间
15°C, 20°C, 25°C 等温度都出现过！
```

**旅行类比**：

```text
从北京（北纬40°）开车到上海（北纬31°）

如果是陆地连续行驶（不能飞跃）
则必定经过北纬35°的某个地点
```

### 3.3 为什么是真的？

**直觉论证**：

```text
假设 f(a) < c < f(b)，但不存在 ξ 使 f(ξ)=c

那么对所有 x ∈ [a,b]：f(x) < c 或 f(x) > c

设 A = {x : f(x) < c}, B = {x : f(x) > c}

则 [a,b] = A ∪ B（不交并）
   a ∈ A, b ∈ B

但 A 和 B 都是开集（由连续性）
⟹ [a,b] 被分成两个不交开集
⟹ [a,b] 不连通

矛盾！（[a,b]是连通的）
```

---

## 四、计算表征（算法）

### 4.1 二分法（找零点）

```python
def bisection(f, a, b, tol=1e-10, max_iter=100):
    """
    二分法：利用介值定理找 f 的零点

    前提：f(a) 和 f(b) 异号
    """
    if f(a) * f(b) > 0:
        raise ValueError("f(a) 和 f(b) 必须异号")

    for _ in range(max_iter):
        c = (a + b) / 2
        if abs(f(c)) < tol:
            return c
        if f(a) * f(c) < 0:
            b = c
        else:
            a = c

    return (a + b) / 2

# 例：求 x³ - x - 1 = 0 的根
f = lambda x: x**3 - x - 1
root = bisection(f, 1, 2)
print(f"根 ≈ {root:.10f}")  # ≈ 1.3247179572
print(f"验证：f(root) = {f(root):.2e}")
```

### 4.2 介值定理的验证

```python
import numpy as np
import matplotlib.pyplot as plt

def verify_ivt(f, a, b, c, n_points=1000):
    """
    验证介值定理：在 [a,b] 上找 f(x)=c
    """
    x = np.linspace(a, b, n_points)
    y = f(x)

    # 检查 c 是否在 f 的值域内
    if not (min(y) <= c <= max(y)):
        print(f"c={c} 不在值域 [{min(y):.2f}, {max(y):.2f}] 内")
        return None

    # 找到 f(x) 最接近 c 的点
    idx = np.argmin(np.abs(y - c))
    xi = x[idx]

    print(f"找到 ξ ≈ {xi:.6f}，f(ξ) ≈ {f(xi):.6f}")

    # 可视化
    plt.figure(figsize=(10, 6))
    plt.plot(x, y, 'b-', label='f(x)')
    plt.axhline(y=c, color='r', linestyle='--', label=f'y = {c}')
    plt.plot(xi, c, 'go', markersize=10, label=f'ξ ≈ {xi:.3f}')
    plt.xlabel('x')
    plt.ylabel('y')
    plt.title('介值定理验证')
    plt.legend()
    plt.grid(True)
    plt.show()

    return xi

# 例：f(x) = sin(x) 在 [0, π] 上取值 0.5
# verify_ivt(np.sin, 0, np.pi, 0.5)
```

### 4.3 不动点的存在性

```python
def fixed_point_existence(f, a, b):
    """
    如果 f: [a,b] → [a,b] 连续
    则 f 有不动点（介值定理推论）
    """
    # 构造 g(x) = f(x) - x
    g = lambda x: f(x) - x

    # g(a) = f(a) - a ≥ 0（因为 f(a) ≥ a）
    # g(b) = f(b) - b ≤ 0（因为 f(b) ≤ b）

    # 由介值定理，存在 c 使 g(c) = 0，即 f(c) = c

    return bisection(g, a, b)

# 例：f(x) = cos(x) 在 [0, 1] 上有不动点
import math
f = math.cos
fp = fixed_point_existence(f, 0, 1)
print(f"不动点 ≈ {fp:.10f}")
print(f"验证：cos({fp}) = {math.cos(fp):.10f}")
```

---

## 五、范畴表征（抽象）

### 5.1 拓扑学视角

**定理的本质**：连续映射保持连通性

```text
[a,b] 是连通空间
f: [a,b] → ℝ 连续
⟹ f([a,b]) 是连通的
⟹ f([a,b]) 是ℝ中的区间
⟹ 介值定理成立
```

### 5.2 范畴论表述

```text
在 Top（拓扑空间范畴）中：

连通性是拓扑不变量
连续映射保持连通性

        f
    X ────→ Y
    │       │
连通 │       │ f(X)连通
    ↓       ↓
```

### 5.3 道路连通的推广

```text
[a,b]不仅连通，还是道路连通的

更一般地：
设 X 道路连通，f: X → ℝ 连续
则 f(X) 是ℝ的区间

这是介值定理的高维推广
```

### 5.4 单纯形的情形

```text
Sperner引理（组合版介值定理）：

三角形的三顶点标记 1, 2, 3
边界的标记规则...
⟹ 存在完全标记的小三角形

这是介值定理/Brouwer不动点的组合版本
```

---

## 六、应用与推论

### 6.1 重要推论

| 推论 | 内容 |
|------|------|
| **零点定理** | f(a)f(b)<0 ⟹ ∃c: f(c)=0 |
| **不动点存在** | f:[a,b]→[a,b]连续 ⟹ ∃不动点 |
| **达布定理** | 导数具有介值性质 |
| **方程有解** | 证明方程存在根 |

### 6.2 经典应用

**1. √2 的存在性**：

```text
f(x) = x² - 2 在 [1, 2] 上连续
f(1) = -1 < 0
f(2) = 2 > 0
⟹ ∃ c ∈ (1,2): c² = 2
```

**2. 奇次多项式有实根**：

```text
p(x) = xⁿ + ... (n奇数)
p(x) → +∞ as x → +∞
p(x) → -∞ as x → -∞
⟹ p 有实根
```

---

## 关联定理

| 定理 | 关系 |
|------|------|
| **极值定理** | 紧集上连续函数有界且取极值 |
| **一致连续定理** | 紧集上连续函数一致连续 |
| **Brouwer不动点** | 高维推广 |
| **Bolzano-Weierstrass** | 有界序列有收敛子列 |

---

**最后更新**: 2025年12月1日
**状态**: ✅ 完成
