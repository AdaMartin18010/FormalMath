# 控制收敛定理 - 五种表征

**创建日期**: 2025年12月1日
**领域**: 实分析/测度论
**难度**: L2

---

## 元信息

| 属性 | 内容 |
|------|------|
| **定理** | Lebesgue控制收敛定理 (DCT) |
| **领域** | 测度论、Lebesgue积分 |
| **发现者** | Henri Lebesgue (1910) |
| **前置知识** | 测度、Lebesgue积分、MCT |

---

## 一、符号表征（形式化）

### 1.1 严格陈述

**控制收敛定理**：设 {fₙ} 是可测函数列，f 是可测函数，满足：

1. fₙ → f a.e.（逐点收敛）
2. 存在可积函数 g ≥ 0，使得 |fₙ| ≤ g a.e. 对所有 n（控制条件）

则：
$$\lim_{n\to\infty} \int_X f_n \, d\mu = \int_X f \, d\mu$$

且 f 可积，∫|fₙ - f| → 0。

### 1.2 Lean 4 形式化

```lean
import Mathlib.MeasureTheory.Integral.Bochner

-- 控制收敛定理
theorem dominated_convergence {α : Type*} [MeasurableSpace α]
    {μ : Measure α} {f : ℕ → α → ℝ} {g : α → ℝ} {bound : α → ℝ}
    (hf_meas : ∀ n, Measurable (f n))
    (hf_lim : ∀ᵐ x ∂μ, Tendsto (fun n => f n x) atTop (𝓝 (g x)))
    (hf_bound : ∀ n, ∀ᵐ x ∂μ, |f n x| ≤ bound x)
    (hbound_int : Integrable bound μ) :
    Tendsto (fun n => ∫ x, f n x ∂μ) atTop (𝓝 (∫ x, g x ∂μ)) := by
  exact tendsto_integral_of_dominated_convergence bound hf_meas
    (fun n => (hf_bound n).mono fun x hx => le_abs_self _ |>.trans hx)
    hbound_int hf_lim
```

### 1.3 证明框架

```text
        [DCT证明]
              │
    定义 hₙ = g - fₙ ≥ 0 和 kₙ = g + fₙ ≥ 0
              │
    对 hₙ, kₙ 使用 Fatou 引理
              │
    ┌─────────┴─────────┐
    │                   │
liminf ∫hₙ ≥ ∫h    liminf ∫kₙ ≥ ∫k
    │                   │
    └─────────┬─────────┘
              │
    结合得 lim ∫fₙ = ∫f
```

---

## 二、几何表征（可视化）

### 2.1 核心图示

```text
        [控制函数g]
    y
    ↑       g(x)
    │    ╱──────╲
    │   ╱ fₙ波动 ╲
    │  ╱──────────╲
    │ ╱            ╲
    └─────────────────→ x
         -g(x)

    fₙ 被 g 从上下控制
    振荡在"管道"内
```

### 2.2 收敛过程

```text
    │   g
    │ ╱───────╲
    │╱ f₃──→f  ╲
    │ f₂        │
    │f₁         │
    │╲──────────╱
    │  -g
    └──────────────

    fₙ → f，面积也收敛
```

---

## 三、直觉表征（类比）

### 3.1 一句话解释

> **DCT**：如果函数列被一个"可积天花板"控制且逐点收敛，则积分也收敛

### 3.2 生活类比

**工资增长**：

```text
员工薪资 fₙ（第n年）
├─ 逐年变化趋向稳定值 f
├─ 总有上限 g（行业天花板）
├─ |fₙ| ≤ g 对所有年份
└─ 公司总支出 ∫fₙ → ∫f（稳定）
```

**温度测量**：

```text
温度读数 fₙ（第n次测量）
├─ 趋向真实温度 f
├─ 仪器误差有界：|fₙ| ≤ g
└─ 平均温度收敛到真实平均
```

### 3.3 为什么需要控制条件？

```text
反例：fₙ = n·χ_{[0,1/n]}

├─ fₙ → 0 逐点（除了x=0）
├─ 但 ∫fₙ = n · (1/n) = 1 恒为1
├─ ∫f = 0
└─ 没有控制函数！质量"逃逸"到无穷

控制条件阻止质量逃逸
```

---

## 四、计算表征（算法）

### 4.1 Python验证

```python
import numpy as np
from scipy import integrate

def verify_dct():
    """
    验证控制收敛定理

    fₙ(x) = x^n 在 [0, 1]
    f(x) = 0（x<1）
    g(x) = 1（控制函数）
    """
    def f_n(x, n):
        return x**n

    print("验证DCT: fₙ(x) = x^n 在 [0, 1]")
    print("控制函数 g(x) = 1")
    print()

    for n in [1, 2, 5, 10, 50, 100]:
        result, _ = integrate.quad(lambda x: f_n(x, n), 0, 1)
        print(f"∫f_{n} = {result:.6f} = 1/{n+1}")

    print(f"\n极限: ∫f = 0")
    print("（fₙ → 0 a.e.，仅在 x=1 处为1）")

verify_dct()

def dct_counterexample():
    """
    反例：没有控制函数时DCT失效
    """
    print("\n反例: fₙ = n·χ_{[0,1/n]}")

    def f_n(x, n):
        return n if 0 <= x <= 1/n else 0

    for n in [1, 10, 100, 1000]:
        result, _ = integrate.quad(lambda x: f_n(x, n), 0, 1)
        print(f"∫f_{n} = {result:.2f}")

    print("但 fₙ → 0 a.e.，所以 ∫f = 0")
    print("积分不收敛！因为没有可积控制函数")

dct_counterexample()
```

### 4.2 数值积分中的应用

```python
def numerical_integration_with_dct(f_sequence, g, a, b, tol=1e-6):
    """
    利用DCT思想的数值积分

    如果知道控制函数g，可以估计收敛速度
    """
    from scipy import integrate

    # 检查控制条件
    x_test = np.linspace(a, b, 1000)

    integrals = []
    for n, f_n in enumerate(f_sequence):
        # 验证控制
        f_vals = np.array([f_n(x) for x in x_test])
        g_vals = np.array([g(x) for x in x_test])

        if not np.all(np.abs(f_vals) <= g_vals + 1e-10):
            print(f"警告: f_{n} 不被 g 控制")

        result, _ = integrate.quad(f_n, a, b)
        integrals.append(result)

        # 检查收敛
        if len(integrals) > 1:
            if abs(integrals[-1] - integrals[-2]) < tol:
                print(f"在 n={n} 处收敛")
                break

    return integrals[-1]
```

---

## 五、范畴表征（抽象）

### 5.1 函数空间视角

```text
L¹(μ) 空间中的收敛

DCT说：如果 {fₙ} 在 L¹ 中有控制
├─ 逐点收敛 ⟹ L¹收敛
├─ ∫|fₙ - f| → 0
└─ 这是从弱拓扑到强拓扑的提升
```

### 5.2 与其他收敛的关系

```text
        [收敛关系图]
              │
    ┌─────────┴─────────┐
    │                   │
一致收敛 ──────→ L¹收敛
    │                   ↑
    │              有控制函数
    ↓                   │
逐点收敛 ─────────────→┘
              DCT
```

### 5.3 泛函分析视角

```text
DCT 的抽象版本：

设 X 是 Banach 空间，{xₙ} ⊂ X
├─ xₙ → x 弱收敛
├─ ||xₙ|| ≤ M（有界）
├─ 某些条件下：xₙ → x 强收敛
└─ DCT是 L¹ 的特例
```

---

## 六、与其他定理的关系

### 6.1 收敛定理比较

| 定理 | 条件 | 结论 |
|------|------|------|
| **MCT** | 单调递增，非负 | ∫↗∫ |
| **Fatou** | 非负 | liminf ∫ ≥ ∫ liminf |
| **DCT** | 有可积控制 | lim ∫ = ∫ lim |

### 6.2 证明依赖

```text
MCT ⟹ Fatou ⟹ DCT

DCT也可以直接从MCT证明
（通过考虑 g ± fₙ）
```

---

## 关联定理

| 定理 | 关系 |
|------|------|
| **单调收敛定理** | DCT的基础 |
| **Fatou引理** | DCT的中间步骤 |
| **Vitali收敛** | 更一般的收敛定理 |
| **有界收敛** | DCT的特例 |

---

**状态**: ✅ 完成
