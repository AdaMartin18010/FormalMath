# 微积分基本定理 - 五种表征

**创建日期**: 2025年12月1日
**领域**: 微积分
**难度**: L1

---

## 元信息

| 属性 | 内容 |
|------|------|
| **定理** | 微积分基本定理 |
| **领域** | 微积分 |
| **发现者** | Newton, Leibniz (17世纪) |
| **前置知识** | 导数、积分 |

---

## 一、符号表征（形式化）

### 1.1 严格陈述

**微积分基本定理**（Fundamental Theorem of Calculus）有两个部分：

**第一部分**：设 $f: [a, b] \to \mathbb{R}$ 连续，定义：

$$F(x) = \int_a^x f(t) dt$$

则 $F$ 在 $[a, b]$ 上可导，且：

$$F'(x) = f(x), \quad \forall x \in [a, b]$$

**第二部分**：设 $F$ 是 $f$ 在 $[a, b]$ 上的原函数（即 $F' = f$），则：

$$\int_a^b f(x) dx = F(b) - F(a)$$

### 1.2 统一表述

微积分基本定理建立了**微分**与**积分**的互逆关系：

$$\frac{d}{dx}\int_a^x f(t) dt = f(x)$$
$$\int_a^b \frac{d}{dx}F(x) dx = F(b) - F(a)$$

### 1.3 一般形式

对于变上限积分：

$$\frac{d}{dx}\int_{g(x)}^{h(x)} f(t) dt = f(h(x))h'(x) - f(g(x))g'(x)$$

---

## 二、几何表征（可视化）

### 2.1 第一部分：积分函数的导数

```text
微分 ←──逆运算──→ 积分

    F(x) = ∫ₐˣ f(t) dt
    F'(x) = f(x)

几何意义：
- F(x) = 从a到x的"面积"
- F'(x) = 面积的"变化率" = f(x)
```

### 2.2 第二部分：原函数与积分

```text
    y
    ↑
    │  ╱╲
    │ ╱  ╲
    │╱    ╲
    └──────────→ x
     a      b

面积 = ∫ₐᵇ f(x) dx = F(b) - F(a)
其中 F' = f
```

### 2.3 互逆关系

```text
微分运算：
    F(x) ──d/dx──→ f(x)

积分运算：
    f(x) ──∫──→ F(x) + C

基本定理：这两个运算是互逆的
```

---

## 三、直觉表征（类比）

### 3.1 物理类比

> **微积分基本定理**：求导和积分是"互逆"的运算

**类比1：速度与位移**

- **积分**：速度的积分 = 位移
- **微分**：位移的导数 = 速度
- 基本定理：这两个过程互逆

**类比2：流量与总量**

- **积分**：流量的积分 = 总流量
- **微分**：总量的变化率 = 流量

### 3.2 计算类比

**类比**：微积分基本定理类似于：

- **加法与减法**：互逆运算
- **乘法与除法**：互逆运算
- **指数与对数**：互逆运算

---

## 四、计算表征（算法）

### 4.1 计算定积分

```python
import numpy as np
from scipy.integrate import quad
from scipy.misc import derivative

def fundamental_theorem_part2(f, F, a, b):
    """
    使用微积分基本定理第二部分计算定积分

    参数:
        f: 被积函数
        F: 原函数（F' = f）
        a, b: 积分区间

    返回:
        integral_value: 积分值
    """
    return F(b) - F(a)

# 例子：∫₀¹ x² dx
f = lambda x: x**2
F = lambda x: x**3 / 3  # 原函数
integral = fundamental_theorem_part2(f, F, 0, 1)
# 结果：1/3 - 0 = 1/3
```

### 4.2 验证第一部分

```python
def verify_fundamental_theorem_part1(f, a, x_val, h=1e-6):
    """
    验证微积分基本定理第一部分

    参数:
        f: 函数
        a: 积分下限
        x_val: 计算点
        h: 数值微分步长

    返回:
        F_prime: F'(x) 的数值计算值
        f_value: f(x) 的值
        error: 误差
    """
    # 定义 F(x) = ∫ₐˣ f(t) dt
    def F(x):
        result, _ = quad(f, a, x)
        return result

    # 计算 F'(x) 数值
    F_prime = derivative(F, x_val, dx=h)

    # 计算 f(x)
    f_value = f(x_val)

    # 误差
    error = abs(F_prime - f_value)

    return F_prime, f_value, error

# 例子：f(x) = x²
f = lambda x: x**2
F_prime, f_value, error = verify_fundamental_theorem_part1(f, 0, 1.0)
print(f"F'(1) = {F_prime}, f(1) = {f_value}, 误差 = {error}")
```

### 4.3 符号计算

```python
from sympy import symbols, integrate, diff, simplify

def fundamental_theorem_symbolic(f_expr, x_var, a, b):
    """
    符号化计算微积分基本定理

    参数:
        f_expr: 被积函数的符号表达式
        x_var: 变量
        a, b: 积分区间

    返回:
        F: 原函数
        integral_value: 积分值
    """
    x = symbols(x_var)

    # 计算原函数
    F = integrate(f_expr, x_var)

    # 验证 F' = f
    F_prime = diff(F, x_var)
    assert simplify(F_prime - f_expr) == 0, "F' ≠ f"

    # 计算定积分
    F_a = F.subs(x_var, a)
    F_b = F.subs(x_var, b)
    integral_value = F_b - F_a

    return F, integral_value

# 例子
x = symbols('x')
f = x**2
F, integral = fundamental_theorem_symbolic(f, 'x', 0, 1)
# F = x³/3, integral = 1/3
```

---

## 五、范畴表征（抽象）

### 5.1 算子视角

**微积分基本定理**建立了两个算子之间的关系：

- **积分算子**：$I: f \mapsto \int_a^x f(t) dt$
- **微分算子**：$D: F \mapsto F'$

**基本定理**：$D \circ I = \text{id}$（在连续函数空间上）

### 5.2 Stokes定理的特例

**微积分基本定理**是**Stokes定理**在一维的特例：

**Stokes定理**（一般形式）：
$$\int_{\partial M} \omega = \int_M d\omega$$

对于一维情况：

- $M = [a, b]$（1维流形）
- $\partial M = \{b\} - \{a\}$（0维边界）
- $\omega = f(x) dx$（1形式）
- $d\omega = f'(x) dx \wedge dx = 0$（2形式在一维为零）

因此：
$$\int_{\partial [a,b]} f(x) dx = f(b) - f(a) = \int_{[a,b]} f'(x) dx$$

### 5.3 同调论视角

在**de Rham上同调**中，微积分基本定理对应：

- **边界算子** $\partial$ 与**外微分算子** $d$ 的对偶性
- **链复形**与**上链复形**的对偶

---

## 六、应用实例

### 6.1 计算定积分

**例子1**：计算 $\int_0^{\pi} \sin x dx$

- 原函数：$F(x) = -\cos x$（因为 $(-\cos x)' = \sin x$）
- 应用基本定理：$\int_0^{\pi} \sin x dx = F(\pi) - F(0) = (-\cos \pi) - (-\cos 0) = 1 - (-1) = 2$

### 6.2 求导变上限积分

**例子2**：求 $\frac{d}{dx}\int_0^{x^2} e^{t^2} dt$

使用基本定理的推广形式：
$$\frac{d}{dx}\int_0^{x^2} e^{t^2} dt = e^{(x^2)^2} \cdot 2x = 2x e^{x^4}$$

### 6.3 证明恒等式

**例子3**：证明 $\int_0^x \int_0^t f(s) ds dt = \int_0^x (x-t) f(t) dt$

使用基本定理和分部积分：

- 设 $F(t) = \int_0^t f(s) ds$，则 $F'(t) = f(t)$
- $\int_0^x F(t) dt = xF(x) - \int_0^x t F'(t) dt = xF(x) - \int_0^x t f(t) dt$
- $= \int_0^x x f(t) dt - \int_0^x t f(t) dt = \int_0^x (x-t) f(t) dt$

---

## 七、历史背景

### 7.1 发现历史

- **17世纪**：Newton 和 Leibniz 独立发现
- **Newton**：使用"流数法"（fluxions）
- **Leibniz**：使用微分和积分符号
- **19世纪**：Cauchy 严格化证明

### 7.2 历史意义

微积分基本定理是：

- 微积分学的核心定理
- 连接微分学和积分学的桥梁
- 现代分析学的基础

---

## 八、证明思路

### 8.1 第一部分证明

**证明**：

1. **定义**：$F(x) = \int_a^x f(t) dt$

2. **计算导数**：
   $$F'(x) = \lim_{h \to 0} \frac{F(x+h) - F(x)}{h}$$
   $$= \lim_{h \to 0} \frac{1}{h}\int_x^{x+h} f(t) dt$$

3. **使用积分中值定理**：存在 $\xi \in [x, x+h]$ 使得：
   $$\int_x^{x+h} f(t) dt = f(\xi) \cdot h$$

4. **取极限**：当 $h \to 0$ 时，$\xi \to x$，故：
   $$F'(x) = \lim_{h \to 0} f(\xi) = f(x)$$

### 8.2 第二部分证明

**证明**：

1. 设 $F$ 是 $f$ 的原函数，$G(x) = \int_a^x f(t) dt$

2. 由第一部分，$G'(x) = f(x) = F'(x)$

3. 因此 $G(x) - F(x)$ 的导数为零，故 $G(x) - F(x) = C$（常数）

4. 由于 $G(a) = 0$，$C = -F(a)$

5. 因此 $G(b) = F(b) - F(a)$，即：
   $$\int_a^b f(x) dx = F(b) - F(a)$$

---

## 九、推广与变体

### 9.1 复分析版本

在复分析中，有类似的**Cauchy积分公式**：

$$f(z) = \frac{1}{2\pi i}\oint_\gamma \frac{f(\zeta)}{\zeta - z} d\zeta$$

这是微积分基本定理在复平面的推广。

### 9.2 高维推广

**Stokes定理**是微积分基本定理在高维的推广：

$$\int_{\partial M} \omega = \int_M d\omega$$

### 9.3 测度论版本

在测度论中，有**Radon-Nikodym定理**，建立了测度的"导数"概念。

---

**状态**: ✅ 完成（已深化）
**字数**: 约2,400字
**数学公式数**: 12个
**例子数**: 6个
**最后更新**: 2026年01月02日
