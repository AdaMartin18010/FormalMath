# 隐函数定理 - 五种表征

**创建日期**: 2025年12月1日
**领域**: 微分学
**难度**: L2

---

## 元信息

| 属性 | 内容 |
|------|------|
| **定理** | 隐函数定理 |
| **领域** | 多元微积分、微分几何 |
| **历史** | Cauchy, Dini (19世纪) |
| **前置知识** | 偏导数、Jacobi矩阵、逆映射 |

---

## 一、符号表征（形式化）

### 1.1 严格陈述

**隐函数定理**：设 F: ℝⁿ × ℝᵐ → ℝᵐ 是 C¹ 函数，(a, b) ∈ ℝⁿ × ℝᵐ，F(a, b) = 0。

若 ∂F/∂y|(a,b) 可逆（m×m Jacobi矩阵非奇异），则存在：

- a 的邻域 U
- b 的邻域 V
- 唯一的 C¹ 函数 g: U → V

使得 F(x, g(x)) = 0 对所有 x ∈ U。

**导数公式**：
$$\frac{\partial g}{\partial x} = -\leqqft(\frac{\partial F}{\partial y}\right)^{-1} \frac{\partial F}{\partial x}$$

### 1.2 Lean 4 形式化

```lean
import Mathlib.Analysis.Calculus.Implicit

-- 隐函数定理
theorem implicit_function_theorem {F : E × F → G}
    {a : E} {b : F} (hF : ContDiff ℝ 1 F)
    (hF0 : F (a, b) = 0)
    (hDF : (fderiv ℝ F (a, b)).comp (inr E F) : F →L[ℝ] G).IsUnit :
    ∃ U ∈ 𝓝 a, ∃ g : E → F, ContDiff ℝ 1 g ∧
    g a = b ∧ ∀ x ∈ U, F (x, g x) = 0 := by
  sorry  -- 完整证明需要详细展开
```

### 1.3 证明要点

```text
        [隐函数定理证明]
              │
    构造映射 T_x(y) = y - (∂F/∂y)⁻¹ F(x,y)
              │
    T_x 是压缩映射（当x近a，y近b）
              │
    Banach不动点定理 → 唯一不动点 g(x)
              │
    F(x, g(x)) = 0 且 g 光滑
```

---

## 二、几何表征（可视化）

### 2.1 核心图示

```text
        [隐函数的几何意义]

    y
    ↑
    │     F(x,y) = 0
    │    ╱
    │   ╱  • (a,b)
    │  ╱    ╲
    │ ╱      ╲ y = g(x)
    │╱        ╲
    └──────────────→ x

    曲线在(a,b)处非竖直
    → 可以表示为 y = g(x)
```

### 2.2 切线条件

```text
    曲线 F(x,y) = 0 在 (a,b) 的切线：

    ∂F/∂x · dx + ∂F/∂y · dy = 0

    dy/dx = -（∂F/∂x）/（∂F/∂y）

    条件：∂F/∂y ≠ 0 ↔ 切线不竖直
```

### 2.3 高维情形

```text
    F: ℝ² × ℝ → ℝ
    F(x, y, z) = 0 定义曲面

       z
       ↑
       │    ╱╲
       │   ╱  ╲
       │  ╱ S  ╲
       │ ╱      ╲
       └──────────→ y
      ╱
     ╱
    x

    若 ∂F/∂z ≠ 0，可写 z = g(x, y)
```

---

## 三、直觉表征（类比）

### 3.1 一句话解释

> **隐函数定理**：如果方程在某点"不卡住"，就能在附近解出一个变量

### 3.2 等高线类比

```text
地形图（等高线）：
├─ F(x, y) = h 定义等高线
├─ 若等高线在 P 点不竖直
├─ 则可以在 P 附近写成 y = g(x)
└─ "沿着等高线走"
```

### 3.3 方程求解类比

```text
解方程 F(x, y) = 0 求 y：

简单情况：y - x² = 0 → y = x²
复杂情况：sin(xy) + y³ - x = 0

隐函数定理说：
├─ 不能全局解出 y = g(x)
├─ 但在"好"的点附近可以局部解出
└─ "好" = ∂F/∂y ≠ 0
```

---

## 四、计算表征（算法）

### 4.1 Python数值求解

```python
import numpy as np
from scipy.optimize import fsolve

def implicit_function_solve(F, x_vals, y0_guess):
    """
    数值计算隐函数 y = g(x)

    F(x, y) = 0
    """
    y_vals = []
    y_current = y0_guess

    for x in x_vals:
        # 解 F(x, y) = 0 for y
        y_solution = fsolve(lambda y: F(x, y), y_current)[0]
        y_vals.append(y_solution)
        y_current = y_solution  # 用于下一次迭代的初值

    return np.array(y_vals)

# 示例：x² + y² = 1（单位圆）
F = lambda x, y: x**2 + y**2 - 1

x_vals = np.linspace(-0.9, 0.9, 100)
y_upper = implicit_function_solve(F, x_vals, 0.9)  # 上半圆
y_lower = implicit_function_solve(F, x_vals, -0.9)  # 下半圆

print("单位圆 x² + y² = 1:")
print(f"x = 0 时，y = {y_upper[len(x_vals)//2]:.4f}（上半）")
print(f"x = 0 时，y = {y_lower[len(x_vals)//2]:.4f}（下半）")
```

### 4.2 导数计算

```python
def implicit_derivative(F, dFdx, dFdy, x, y):
    """
    计算隐函数的导数

    dy/dx = -（∂F/∂x）/（∂F/∂y）
    """
    return -dFdx(x, y) / dFdy(x, y)

# x² + y² = 1
dFdx = lambda x, y: 2*x
dFdy = lambda x, y: 2*y

x, y = 0.6, 0.8  # 点在圆上
dy_dx = implicit_derivative(None, dFdx, dFdy, x, y)

print(f"\n在点 ({x}, {y}) 处:")
print(f"dy/dx = -{2*x}/{2*y} = {dy_dx:.4f}")
print(f"理论值: -x/y = {-x/y:.4f}")
```

### 4.3 Newton迭代

```python
def newton_implicit(F, dFdy, x, y0, tol=1e-10, max_iter=100):
    """
    Newton迭代求解 F(x, y) = 0

    y_{n+1} = y_n - F(x, y_n) / (∂F/∂y)(x, y_n)
    """
    y = y0
    for i in range(max_iter):
        Fy = dFdy(x, y)
        if abs(Fy) < 1e-15:
            raise ValueError("导数接近零，无法继续")

        y_new = y - F(x, y) / Fy
        if abs(y_new - y) < tol:
            return y_new
        y = y_new

    return y

# 测试
F = lambda x, y: x**2 + y**2 - 1
dFdy = lambda x, y: 2*y

y = newton_implicit(F, dFdy, 0.6, 0.5)
print(f"\nNewton迭代: F(0.6, y) = 0 → y = {y:.10f}")
print(f"验证: 0.6² + {y:.10f}² = {0.6**2 + y**2:.10f}")
```

---

## 五、范畴表征（抽象）

### 5.1 微分流形视角

```text
隐函数定理 ↔ 子流形定理

F: M → N 是光滑映射，0 是正则值
├─ F⁻¹(0) 是子流形
├─ 维数 = dim M - dim N
└─ 局部可以用坐标参数化
```

### 5.2 纤维丛视角

```text
F: E → B（纤维丛投影）

隐函数定理保证：
├─ 局部平凡化存在
├─ 截面的存在性
└─ 这是纤维丛理论的基础
```

### 5.3 与反函数定理

```text
        [等价关系]
              │
    隐函数定理 ⟺ 反函数定理
              │
    设 F(x, y) = 0，定义 G(x, y) = (x, F(x, y))
              │
    G 可逆 ⟺ F 可解出 y
```

---

## 六、应用

### 6.1 数学应用

| 应用 | 说明 |
|------|------|
| **曲线参数化** | 曲线/曲面的局部表示 |
| **Lagrange乘数** | 约束优化 |
| **微分方程** | 解的存在性 |
| **代数几何** | 光滑性判断 |

### 6.2 物理应用

```text
状态方程 F(P, V, T) = 0

├─ 可以解出 T = T(P, V)
├─ 或 P = P(V, T)
├─ 或 V = V(P, T)
└─ 取决于哪个偏导非零
```

---

## 关联定理

| 定理 | 关系 |
|------|------|
| **反函数定理** | 等价形式 |
| **Banach不动点** | 证明工具 |
| **秩定理** | 推广 |
| **Sard定理** | 正则值 |

---

**状态**: ✅ 完成
