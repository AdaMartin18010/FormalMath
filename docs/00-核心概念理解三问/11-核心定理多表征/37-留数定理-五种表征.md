---
msc_primary: "30E20"
msc_secondary: ["30B99"]
---

# 留数定理 - 五种表征

**创建日期**: 2025年12月1日
**领域**: 复分析
**难度**: L2

---

## 元信息

| 属性 | 内容 |
|------|------|
| **定理** | 留数定理 (Residue Theorem) |
| **领域** | 复分析 |
| **发现者** | Augustin-Louis Cauchy |
| **前置知识** | Cauchy积分、Laurent级数 |

---

## 一、符号表征（形式化）

### 1.1 严格陈述

**留数定理**：设f在区域U内除有限个孤立奇点z₁,...,zₙ外全纯，γ是U中正向简单闭曲线包围所有zₖ，则：

$$\oint_\gamma f(z) \, dz = 2\pi i \sum_{k=1}^n \operatorname{Res}(f, z_k)$$

### 1.2 留数定义

Res(f, z₀) = Laurent展开中(z-z₀)⁻¹的系数a₋₁

### 1.3 Lean 4 形式化

```lean
import Mathlib.Analysis.Complex.CauchyIntegral

-- 留数定理
theorem residue_theorem {f : ℂ → ℂ} {γ : Path} {S : Finset ℂ}
    (hf : ∀ z ∉ S, DifferentiableAt ℂ f z)
    (hγ : γ.IsClosedPath) (hS : S ⊆ γ.interior) :
    ∮ z in γ, f z = 2 * π * Complex.I * ∑ a in S, residue f a := by
  sorry  -- 需要详细的复分析形式化
```

---

## 二、几何表征（可视化）

### 2.1 围道与奇点

```text
        ┌──────────γ──────────┐
        │                     │
        │   •z₁    •z₂       │
        │          •z₃        │
        │                     │
        └─────────────────────┘

    ∮_γ f dz = 2πi(Res₁ + Res₂ + Res₃)
```

### 2.2 留数的几何意义

```text
Laurent展开：f(z) = ... + a₋₂/(z-z₀)² + a₋₁/(z-z₀) + a₀ + ...
                                        ↑
                                    留数 = a₋₁

围绕z₀的积分只"看到"1/(z-z₀)项
```

---

## 三、直觉表征（类比）

### 3.1 一句话解释

> **留数定理**：围道积分只取决于被包围的"奇点贡献"，每个奇点贡献2πi×留数

### 3.2 漩涡类比

- 奇点 = 漩涡中心
- 留数 = 漩涡强度
- 围道积分 = 总环流 = 各漩涡强度之和

### 3.3 为什么是2πi？

围绕原点一圈：∮ dz/z = 2πi（基本情况）

---

## 四、计算表征（算法）

### 4.1 Python实现

```python
import numpy as np

def residue_at_pole(f, z0, order=1, eps=1e-8):
    """计算f在z0处的留数（假设为极点）"""
    if order == 1:
        # 单极点: Res = lim_{z→z₀} (z-z₀)f(z)
        z = z0 + eps
        return ((z - z0) * f(z)).real
    else:
        # 高阶极点: 使用数值微分
        from scipy.misc import derivative
        g = lambda z: (z - z0)**order * f(z)
        return derivative(g, z0, n=order-1, dx=eps) / np.math.factorial(order-1)

def contour_integral_residue(f, poles, residues):
    """使用留数定理计算围道积分"""
    return 2 * np.pi * 1j * sum(residues)

# 示例：∮ 1/(z²+1) dz 围绕 z=i
f = lambda z: 1 / (z**2 + 1)
# z² + 1 = (z-i)(z+i)，在z=i处留数 = 1/(2i) = -i/2
res_i = 1 / (2j)
result = contour_integral_residue(f, [1j], [res_i])
print(f"∮ 1/(z²+1) dz = {result}")  # = π
```

### 4.2 实积分计算

```python
def real_integral_via_residue():
    """
    使用留数定理计算实积分
    例：∫_{-∞}^{∞} 1/(1+x²) dx
    """
    # 被积函数 f(z) = 1/(1+z²)
    # 上半平面极点：z = i，留数 = 1/(2i)

    residue = 1 / (2j)
    integral = 2 * np.pi * 1j * residue
    print(f"∫ 1/(1+x²) dx = {integral.real:.6f}")  # = π
    print(f"理论值 π = {np.pi:.6f}")

real_integral_via_residue()
```

---

## 五、范畴表征（抽象）

### 5.1 范畴视角

```text
留数定理 = Cauchy积分公式的推广
├─ Cauchy：全纯函数 → 围道积分为0
├─ 留数：有奇点 → 积分 = 奇点贡献之和
└─ 统一视角：de Rham上同调
```

### 5.2 推广

- **多变量**：多维留数
- **代数几何**：Grothendieck留数
- **物理**：量子场论中的路径积分

### 5.3 同调解释

留数 = 全纯形式在奇点处的"局部上同调类"

---

## 关联定理

| 定理 | 关系 |
|------|------|
| **Cauchy积分公式** | 特例 |
| **辐角原理** | 推论 |
| **Rouché定理** | 应用 |

---

**状态**: ✅ 完成
