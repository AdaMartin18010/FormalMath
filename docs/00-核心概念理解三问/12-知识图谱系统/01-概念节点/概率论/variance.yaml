# variance.yaml - 方差概念知识图谱节点
# FormalMath Knowledge Graph - Concept Node
# Created: 2025-12-07

concept:
  id: "variance"
  name:
    zh: "方差"
    en: "Variance"
  msc_codes: ["60A10", "60E05"]

  # ===== 定义层 =====
  definition:
    formal: |
      设 X 是随机变量，期望 E[X] = μ。
      方差定义为：

      Var(X) = E[(X - μ)²] = E[X²] - (E[X])²

      标准差：
      σ_X = √Var(X)

    informal: |
      方差衡量"随机变量偏离期望的程度"。

      掷骰子例子：
      - E[X] = 3.5
      - Var(X) = E[(X-3.5)²] = (1-3.5)²/6 + ... + (6-3.5)²/6
      - = 35/12 ≈ 2.92
      - σ_X = √(35/12) ≈ 1.71

      方差大 = 结果分散
      方差小 = 结果集中

    lean: |
      -- Mathlib定义
      def Variance {Ω : Type*} [MeasurableSpace Ω]
        (X : Ω → ℝ) (P : Measure Ω) : ℝ :=
        Expectation (fun ω => (X ω - Expectation X P)^2) P

      -- 等价形式
      theorem variance_formula (X : Ω → ℝ) :
        Variance X P = Expectation (X^2) P - (Expectation X P)^2 :=
        by simp [Variance, Expectation]

  # ===== 直觉层 =====
  intuition:
    geometric: |
      【几何直觉】分散度
      - 方差 = "平均平方距离"
      - 衡量分布"宽度"
      - 标准差 = "典型偏离距离"
      - 方差大 = 分布"胖"
      - 方差小 = 分布"瘦"

    algebraic: |
      【代数直觉】二阶中心矩
      - 方差是二阶中心矩
      - Var(X) = E[X²] - E[X]²
      - 是二次型的期望
      - 满足二次齐次性：Var(aX) = a²Var(X)

    physical: |
      【物理直觉】涨落
      - 方差 = "涨落的大小"
      - 在统计力学中，方差对应"热涨落"
      - 标准差 = "典型涨落幅度"

    categorical: |
      【范畴直觉】二阶矩
      - 方差是"二阶中心矩"
      - 是期望算子的二次形式
      - 衡量分布的"二阶特征"

  # ===== 表征层 =====
  representations:
    - type: "定义形式"
      content: |
        Var(X) = E[(X - E[X])²]

    - type: "计算形式"
      content: |
        Var(X) = E[X²] - (E[X])²

    - type: "积分形式"
      content: |
        Var(X) = ∫ (x - μ)² f_X(x) dx

    - type: "求和形式"
      content: |
        Var(X) = Σ (x - μ)² p_X(x)

  # ===== 例子层 =====
  examples:
    discrete:
      - name: "伯努利分布"
        distribution: "Bernoulli(p)"
        variance: "Var(X) = p(1-p)"
        explanation: "当p=0.5时方差最大"

      - name: "二项分布"
        distribution: "Binomial(n,p)"
        variance: "Var(X) = np(1-p)"
        explanation: "n个独立伯努利的和"

      - name: "泊松分布"
        distribution: "Poisson(λ)"
        variance: "Var(X) = λ"
        explanation: "泊松分布的期望=方差"

    continuous:
      - name: "均匀分布"
        distribution: "Uniform(a,b)"
        variance: "Var(X) = (b-a)²/12"
        explanation: "区间长度的平方除以12"

      - name: "正态分布"
        distribution: "N(μ, σ²)"
        variance: "Var(X) = σ²"
        explanation: "参数σ²就是方差"

      - name: "指数分布"
        distribution: "Exp(λ)"
        variance: "Var(X) = 1/λ²"
        explanation: "等待时间的方差"

  # ===== 关系层 =====
  relations:
    requires:
      - id: "expectation"
        description: "方差依赖于期望"
      - id: "random-variable"
        description: "定义在随机变量上"

    generalizes:
      - id: "mean-squared-error"
        description: "方差是MSE的特例"

    specialized_by:
      - id: "covariance"
        description: "协方差 Cov(X,Y) = E[(X-E[X])(Y-E[Y])]"
      - id: "standard-deviation"
        description: "标准差 σ = √Var(X)"

    related_to:
      - id: "expectation"
        description: "Var(X) = E[X²] - (E[X])²"
      - id: "chebyshev-inequality"
        description: "Chebyshev不等式用方差界概率"
      - id: "central-limit-theorem"
        description: "CLT涉及方差标准化"

  # ===== 定理层 =====
  key_theorems:
    - id: "variance-formula"
      statement: "Var(X) = E[X²] - (E[X])²"
      importance: 5

    - id: "variance-scaling"
      statement: "Var(aX+b) = a²Var(X)"
      importance: 4

    - id: "variance-sum"
      statement: "Var(X+Y) = Var(X) + Var(Y) + 2Cov(X,Y)"
      importance: 5

    - id: "chebyshev-inequality"
      statement: "P(|X-μ| ≥ kσ) ≤ 1/k²"
      importance: 5

  # ===== 元数据层 =====
  metadata:
    difficulty: 2
    importance: 5

    prerequisites:
      - "expectation"
      - "random-variable"

    leads_to:
      - "covariance"
      - "standard-deviation"
      - "chebyshev-inequality"
      - "central-limit-theorem"

    history:
      first_appearance: "19世纪"
      context: "统计理论发展"
      key_figures: ["Gauss", "Pearson"]

  # ===== Mathlib对齐 =====
  mathlib:
    path: "Mathlib.Probability.Variance"
    name: "Variance"
    coverage: "complete"
