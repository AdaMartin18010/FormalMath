# expectation.yaml - 期望概念知识图谱节点
# FormalMath Knowledge Graph - Concept Node
# Created: 2025-12-07

concept:
  id: "expectation"
  name:
    zh: "期望"
    en: "Expectation"
  msc_codes: ["60A10", "60E05"]

  # ===== 定义层 =====
  definition:
    formal: |
      设 X 是概率空间 (Ω, ℱ, P) 上的随机变量。
      期望（均值）定义为：

      离散情况：
      E[X] = Σ_{x} x · P(X = x)

      连续情况：
      E[X] = ∫_{-∞}^{∞} x f_X(x) dx

      测度论定义：
      E[X] = ∫_Ω X(ω) dP(ω) = ∫_{-∞}^{∞} x dF_X(x)

    informal: |
      期望是"随机变量的加权平均"，权重是概率。

      掷骰子例子：
      - X = 点数（1,2,3,4,5,6）
      - E[X] = (1+2+3+4+5+6)/6 = 3.5
      - 这是"长期平均"的值

      期望是随机变量的"中心"或"典型值"。

    lean: |
      -- Mathlib定义
      def Expectation {Ω : Type*} [MeasurableSpace Ω]
        (X : Ω → ℝ) (P : Measure Ω) : ℝ :=
        ∫ ω, X ω ∂P

      -- 性质
      theorem expectation_linear (a b : ℝ) (X Y : Ω → ℝ) :
        Expectation (a • X + b • Y) P =
        a • Expectation X P + b • Expectation Y P :=
        by simp [Expectation, integral_add, integral_smul]

  # ===== 直觉层 =====
  intuition:
    geometric: |
      【几何直觉】重心
      - 期望是概率分布的"重心"
      - 离散：加权平均点
      - 连续：密度函数的"平衡点"
      - 对称分布：期望 = 中位数

    algebraic: |
      【代数直觉】线性泛函
      - 期望是线性算子：E[aX+bY] = aE[X] + bE[Y]
      - 是概率测度的积分
      - 是分布的一阶矩

    physical: |
      【物理直觉】质心
      - 期望 = 概率分布的"质心"
      - 是"平均位置"
      - 在统计力学中，期望对应"宏观量"

    categorical: |
      【范畴直觉】积分
      - 期望是"积分"的实例
      - 是概率测度上的积分算子
      - 保持线性结构

  # ===== 表征层 =====
  representations:
    - type: "积分形式"
      content: |
        E[X] = ∫_Ω X(ω) dP(ω)

    - type: "分布函数形式"
      content: |
        E[X] = ∫_{-∞}^{∞} x dF_X(x)

    - type: "密度函数形式"
      content: |
        E[X] = ∫_{-∞}^{∞} x f_X(x) dx

    - type: "质量函数形式"
      content: |
        E[X] = Σ_{x} x · p_X(x)

  # ===== 例子层 =====
  examples:
    discrete:
      - name: "伯努利分布"
        distribution: "Bernoulli(p)"
        expectation: "E[X] = p"
        explanation: "成功概率就是期望"

      - name: "二项分布"
        distribution: "Binomial(n,p)"
        expectation: "E[X] = np"
        explanation: "n次试验，每次成功概率p"

      - name: "泊松分布"
        distribution: "Poisson(λ)"
        expectation: "E[X] = λ"
        explanation: "参数λ就是期望"

    continuous:
      - name: "均匀分布"
        distribution: "Uniform(a,b)"
        expectation: "E[X] = (a+b)/2"
        explanation: "区间的中点"

      - name: "正态分布"
        distribution: "N(μ, σ²)"
        expectation: "E[X] = μ"
        explanation: "参数μ就是期望"

      - name: "指数分布"
        distribution: "Exp(λ)"
        expectation: "E[X] = 1/λ"
        explanation: "等待时间的平均"

  # ===== 关系层 =====
  relations:
    requires:
      - id: "random-variable"
        description: "期望是随机变量的函数"
      - id: "probability-space"
        description: "定义在概率空间上"
      - id: "integral"
        description: "期望是Lebesgue积分"

    generalizes:
      - id: "arithmetic-mean"
        description: "期望是概率意义下的平均"

    specialized_by:
      - id: "conditional-expectation"
        description: "条件期望"
      - id: "moment"
        description: "k阶矩 E[X^k]"

    related_to:
      - id: "variance"
        description: "方差 Var(X) = E[X²] - (E[X])²"
      - id: "law-of-large-numbers"
        description: "大数定律：样本均值→期望"
      - id: "jensen-inequality"
        description: "Jensen不等式：E[φ(X)] ≥ φ(E[X])"

  # ===== 定理层 =====
  key_theorems:
    - id: "linearity-of-expectation"
      statement: "E[aX+bY] = aE[X] + bE[Y]"
      importance: 5

    - id: "monotonicity-of-expectation"
      statement: "若X ≤ Y，则E[X] ≤ E[Y]"
      importance: 4

    - id: "jensen-inequality"
      statement: "若φ凸，则E[φ(X)] ≥ φ(E[X])"
      importance: 5

    - id: "law-of-large-numbers"
      statement: "样本均值收敛到期望"
      importance: 5

  # ===== 元数据层 =====
  metadata:
    difficulty: 2
    importance: 5

    prerequisites:
      - "random-variable"
      - "integral"
      - "probability-space"

    leads_to:
      - "variance"
      - "moment"
      - "conditional-expectation"
      - "law-of-large-numbers"

    history:
      first_appearance: "17-18世纪"
      context: "概率论的早期发展"
      key_figures: ["Pascal", "Fermat", "Laplace"]

  # ===== Mathlib对齐 =====
  mathlib:
    path: "Mathlib.MeasureTheory.Integral.Basic"
    name: "integral"
    coverage: "complete"
    note: "期望就是积分"
