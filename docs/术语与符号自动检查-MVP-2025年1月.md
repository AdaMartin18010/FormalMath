# 术语与符号自动检查 - MVP - 2025年1月

## 🎯 目标

- 快速落地术语/符号一致性与LaTeX格式的自动抽检
- 产出可读报告与修复建议，支撑每周例行质量复审

---

## 📌 检查范围（MVP）

- 术语：中英一致性、禁用别称、定义模板要素
- 符号：LaTeX定界与环境、跨文档一致性、常见规则
- 文档集合：`docs/` 下 md/yaml（可通过包含/排除清单配置）

---

## 🧰 使用方式

### 命令接口（伪实现）

```bash
# 全量抽检（默认）
python tools/check_quality.py --scope docs --rules terminology,symbols --report out/report-$(date +%Y%m%d).json

# 仅检查术语
python tools/check_quality.py --scope docs --rules terminology --report out/terms.json

# 指定文件清单
python tools/check_quality.py --files docs/项目索引.md docs/FormalMath术语标准化推进报告-2025年1月.md --rules symbols
```

### 规则配置（示例）

```json
{
  "terminology": {
    "forbid_aliases": ["单位元的别称", "函子/态射混用的别称"],
    "bilingual_pair_required": true,
    "definition_template": ["定义/命题/定理标题", "必要/充分条件", "符号约定"]
  },
  "symbols": {
    "latex_math_inline": "balanced-$",
    "preferred_notations": {
      "complement": "A^c",
      "identity": "e",
      "subset_strict": "\\subset"
    }
  }
}
```

---

## 📄 输出样例（节选）

```json
{
  "summary": {"files": 128, "issues": 7, "score": 0.97},
  "issues": [
    {"type": "latex_unbalanced_inline", "file": "docs/X.md", "line": 42, "hint": "补齐$"},
    {"type": "terminology_alias", "file": "docs/Y.md", "token": "单位元的别称", "suggest": "单位元（identity element）"},
    {"type": "symbol_inconsistency", "file": "docs/Z.md", "token": "A'", "prefer": "A^c"}
  ]
}
```

---

## 🗓️ 例行运行

- 每周一 10:00 自动运行（含死链扫描），生成 `out/report-YYYYMMDD.json` 与 `out/report-YYYYMMDD.md`
- 失败报警：阈值（score < 0.95 或 issues ≥ 10）触发提醒

---

## 🔗 死链清单与修复建议（新增）

- 检测范围：相对链接（md/yaml）、图片与资源引用（相对/绝对路径）
- 输出字段：`file`、`line`、`target`、`reason`（不存在/大小写不一致/跨目录错误）、`suggest`
- 修复策略：
  1. 若同目录存在同名文件，优先改为 `./文件名`
  2. 若在上级同分支目录，改为 `../分支/文件名`
  3. 若索引中有权威路径，统一改为索引路径

### 报告示例（节选）

```json
{
  "deadlinks": [
    {"file": "docs/11-高级数学/12-几何朗兰兹纲领.md", "line": 1178, "target": "../11-高级数学/10-朗兰兹纲领.md", "reason": "cross-dir", "suggest": "./10-朗兰兹纲领.md"}
  ],
  "actions": [
    {"type": "edit", "file": "docs/11-高级数学/12-几何朗兰兹纲领.md", "line": 1178, "apply": "use ./ path"}
  ]
}
```

---

## 📌 后续扩展

- 引入AST级LaTeX校验、跨章术语依赖检查
- 与`质量检查清单-2025年1月.md`对齐字段映射，自动勾选建议
- 集成Git CI，PR自动评论修复建议
