# 计算几何 / Computational Geometry

## 概述

计算几何是研究几何问题的算法设计和分析的数学分支，结合了几何学、算法理论和计算机科学的理论。它主要关注如何用计算机高效地解决几何问题，包括点、线、面、体等几何对象的计算和分析。

## 历史背景

计算几何的发展可以追溯到20世纪70年代，随着计算机图形学、计算机辅助设计（CAD）和地理信息系统（GIS）的发展而兴起。早期的重要贡献包括：

- **1978年**: Shamos和Hoey提出了平面扫描算法
- **1980年代**: 分治算法在几何问题中的应用
- **1990年代**: 随机化算法和近似算法的引入
- **2000年代**: 高维几何算法和流形计算的发展

## 公理化定义

### 基本几何对象

**定义1.1 (点)**
在欧几里得空间 $\mathbb{R}^d$ 中，点 $p$ 是一个 $d$ 元组 $(x_1, x_2, \ldots, x_d)$，其中 $x_i \in \mathbb{R}$。

**定义1.2 (线段)**
给定两点 $p_1, p_2 \in \mathbb{R}^d$，线段 $[p_1, p_2]$ 定义为：
$$[p_1, p_2] = \{p_1 + t(p_2 - p_1) : t \in [0, 1]\}$$

**定义1.3 (多边形)**
多边形 $P$ 是平面上由有限个点 $p_1, p_2, \ldots, p_n$ 按顺序连接形成的封闭路径，满足：
$$P = \bigcup_{i=1}^{n} [p_i, p_{i+1}]$$
其中 $p_{n+1} = p_1$。

### 几何关系

**定义1.4 (点的位置关系)**
给定点 $p$ 和多边形 $P$，定义：

- $p$ 在 $P$ 内部：$p \in \text{int}(P)$
- $p$ 在 $P$ 边界上：$p \in \partial P$
- $p$ 在 $P$ 外部：$p \in \text{ext}(P)$

## 基本性质

### 凸包性质

**定理2.1 (凸包存在性)**
对于任意有限点集 $S \subset \mathbb{R}^d$，存在唯一的凸包 $\text{conv}(S)$，它是包含 $S$ 的最小凸集。

**证明**：

1. 凸包的存在性：所有包含 $S$ 的凸集的交集是凸的且包含 $S$
2. 唯一性：如果存在两个不同的最小凸集，它们的交集也是凸集且包含 $S$，矛盾

### 三角剖分性质

**定理2.2 (平面三角剖分)**
任意简单多边形都可以被三角剖分，即分解为不相交的三角形集合。

**证明**：
使用归纳法：

- 基础情况：三角形本身
- 归纳步骤：对于 $n$ 边形，总能找到一个对角线将其分解为两个更小的多边形

## 形式化证明

### Graham扫描算法正确性

**定理3.1 (Graham扫描算法)**
Graham扫描算法能够正确计算平面点集的凸包。

**证明**：

**算法描述**：

1. 找到最下方的点 $p_0$（如果有多个，选择最左的）
2. 按相对于 $p_0$ 的极角排序其他点
3. 使用栈维护凸包，对于每个点 $p_i$：
   - 如果栈中至少有两个点，且 $p_i$ 在栈顶两点形成的向量的左侧，则弹出栈顶
   - 将 $p_i$ 压入栈

**正确性证明**：

- **单调性**：算法维护的路径始终是凸的
- **完整性**：所有凸包顶点都会被包含
- **最优性**：不会包含非凸包顶点

### 时间复杂度分析

**定理3.2 (Graham扫描复杂度)**
Graham扫描算法的时间复杂度为 $O(n \log n)$，其中 $n$ 是点的数量。

**证明**：

- 排序：$O(n \log n)$
- 扫描：每个点最多被压入和弹出栈一次，$O(n)$
- 总复杂度：$O(n \log n)$

## 应用实例

### 实例1：最近点对问题

**问题描述**：给定平面上 $n$ 个点，找到距离最近的两个点。

**分治算法**：

```python
def closest_pair(points):
    if len(points) <= 3:
        return brute_force_closest(points)
    
    mid = len(points) // 2
    left_points = points[:mid]
    right_points = points[mid:]
    
    left_min = closest_pair(left_points)
    right_min = closest_pair(right_points)
    
    min_dist = min(left_min, right_min)
    
    # 检查跨越中线的点对
    strip_points = get_strip_points(points, mid, min_dist)
    strip_min = closest_in_strip(strip_points, min_dist)
    
    return min(min_dist, strip_min)
```

**时间复杂度**：$O(n \log n)$

### 实例2：线段相交检测

**问题描述**：给定 $n$ 条线段，检测是否有相交的线段对。

**平面扫描算法**：

```python
def segment_intersection(segments):
    events = []
    for seg in segments:
        events.append((seg.start.x, 'start', seg))
        events.append((seg.end.x, 'end', seg))
    
    events.sort()
    active_segments = set()
    
    for x, event_type, segment in events:
        if event_type == 'start':
            # 检查与活动线段的相交
            for active_seg in active_segments:
                if segments_intersect(segment, active_seg):
                    return True
            active_segments.add(segment)
        else:
            active_segments.remove(segment)
    
    return False
```

**时间复杂度**：$O(n \log n + k)$，其中 $k$ 是相交的线段对数

### 实例3：Voronoi图构造

**问题描述**：给定平面上 $n$ 个点，构造Voronoi图。

**Fortune算法**：

```python
def construct_voronoi(points):
    # 初始化事件队列
    events = [(p.y, 'site', p) for p in points]
    events.sort()
    
    beach_line = BeachLine()
    voronoi_edges = []
    
    for y, event_type, data in events:
        if event_type == 'site':
            handle_site_event(data, beach_line, voronoi_edges)
        else:  # circle event
            handle_circle_event(data, beach_line, voronoi_edges)
    
    return voronoi_edges
```

**时间复杂度**：$O(n \log n)$

## 与其他主题的关联

### 前置知识

- **线性代数**：向量运算、矩阵变换
- **解析几何**：直线、平面方程
- **算法分析**：时间复杂度、空间复杂度
- **数据结构**：栈、队列、平衡树

### 后续发展

- **计算拓扑**：同伦论、同调论的计算方法
- **微分几何**：流形上的几何算法
- **代数几何**：代数曲线的计算
- **机器学习**：几何深度学习、流形学习

### 交叉联系

- **计算机图形学**：3D建模、渲染算法
- **机器人学**：路径规划、碰撞检测
- **地理信息系统**：空间数据分析
- **生物信息学**：蛋白质结构分析

## 术语对照表 / Terminology Table

| 中文 | English | Français | Deutsch |
|------|---------|----------|---------|
| 计算几何 | Computational Geometry | Géométrie Algorithmique | Algorithmische Geometrie |
| 凸包 | Convex Hull | Enveloppe Convexe | Konvexe Hülle |
| 三角剖分 | Triangulation | Triangulation | Triangulation |
| 最近点对 | Closest Pair | Paire la Plus Proche | Nächste Punkte |
| 线段相交 | Line Segment Intersection | Intersection de Segments | Streckenschnitt |
| Voronoi图 | Voronoi Diagram | Diagramme de Voronoi | Voronoi-Diagramm |
| 平面扫描 | Plane Sweep | Balayage Plan | Ebenensweep |
| 分治算法 | Divide and Conquer | Diviser pour Régner | Teile und Herrsche |
| 随机化算法 | Randomized Algorithm | Algorithme Randomisé | Randomisierter Algorithmus |
| 几何数据结构 | Geometric Data Structure | Structure de Données Géométrique | Geometrische Datenstruktur |

## 参考文献

### 经典文献

  1. **Preparata, F.P., Shamos, M.I.** (1985). *Computational Geometry: An Introduction*. Springer-Verlag.
  2. **de Berg, M., Cheong, O., van Kreveld, M., Overmars, M.** (2008). *Computational Geometry: Algorithms and Applications*. Springer.
  3. **Edelsbrunner, H.** (1987). *Algorithms in Combinatorial Geometry*. Springer-Verlag.

### 现代发展

   1. **Agarwal, P.K., Sharir, M.** (2000). "Arrangements and Their Applications". *Handbook of Computational Geometry*.
   2. **Halperin, D., Overmars, M.H.** (1998). "Spheres, Molecules, and Hidden Surface Removal". *Computational Geometry*.

### 在线资源

   1. **CGAL**: Computational Geometry Algorithms Library
      - 网址：<https://www.cgal.org/>
      - 提供：C++几何算法库

   2. **Wikipedia**: Computational Geometry
      - 网址：<https://en.wikipedia.org/wiki/Computational_geometry>
      - 提供：基础概念和算法介绍

   3. **MathWorld**: Computational Geometry
      - 网址：<http://mathworld.wolfram.com/ComputationalGeometry.html>
      - 提供：数学定义和公式

---

**文档状态**: 计算几何基础理论  
**创建日期**: 2025年1月  
**内容质量**: 国际标准对齐  
**多语言支持**: 中英法德四语言术语对照
