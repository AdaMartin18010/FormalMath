# 优化算法

## 概述

优化算法是求解数学优化问题的计算方法，包括线性规划、非线性优化、全局优化等。优化算法在科学计算、工程设计和人工智能等领域有广泛应用。优化算法的核心目标是在给定约束条件下找到目标函数的最优解。

## 历史背景

### 线性规划的诞生

George Dantzig在1947年提出了单纯形法，标志着线性规划作为一门学科的诞生。线性规划在第二次世界大战期间被用于军事规划，战后广泛应用于经济和管理领域。

### 非线性优化的发展

20世纪50年代，非线性优化理论开始发展。牛顿法、梯度下降法等经典算法被提出，为非线性优化奠定了基础。

### 全局优化算法的兴起

20世纪70年代，随着计算能力的提升，全局优化算法开始发展。遗传算法、模拟退火等启发式算法被提出，用于解决复杂的全局优化问题。

### 现代优化理论的形成

20世纪80年代以来，凸优化理论快速发展，内点法、半定规划等现代优化方法被提出，形成了完整的现代优化理论体系。

## 公理化定义

### 优化问题形式化定义

标准优化问题：

**目标**: min f(x)
**约束**: g(x) ≤ 0, h(x) = 0
**变量**: x ∈ ℝⁿ

其中：

- f: ℝⁿ → ℝ 是目标函数
- g: ℝⁿ → ℝᵐ 是不等式约束
- h: ℝⁿ → ℝᵖ 是等式约束

**可行域**: Ω = {x ∈ ℝⁿ | g(x) ≤ 0, h(x) = 0}

**全局最优解**: x*∈ Ω 是全局最优解，如果对于所有 x ∈ Ω，都有 f(x*) ≤ f(x)

**局部最优解**: x*∈ Ω 是局部最优解，如果存在 ε > 0，使得对于所有 x ∈ Ω ∩ B(x*, ε)，都有 f(x*) ≤ f(x)

### 最优性条件

#### 一阶必要条件 (KKT条件)

对于可微函数，KKT条件是局部最优解的必要条件：

**KKT条件**:

1. ∇f(x*) + Σλᵢ∇gᵢ(x*) + Σμⱼ∇hⱼ(x*) = 0
2. gᵢ(x*) ≤ 0, hⱼ(x*) = 0
3. λᵢ ≥ 0, λᵢgᵢ(x*) = 0

其中：

- λᵢ 是不等式约束的拉格朗日乘子
- μⱼ 是等式约束的拉格朗日乘子

#### 二阶充分条件

对于局部最优解，还需要满足二阶条件：

**二阶充分条件**:
对于所有满足 ∇gᵢ(x*)ᵀd = 0（对于活跃约束）和 ∇hⱼ(x*)ᵀd = 0 的方向d，都有：
dᵀ∇²L(x*)d > 0

其中 L(x) = f(x) + Σλᵢgᵢ(x) + Σμⱼhⱼ(x) 是拉格朗日函数。

## 基本算法

### 线性规划算法

#### 单纯形法

单纯形法是求解线性规划问题的经典算法：

**算法步骤**:

1. 构造单纯形表
2. 选择入基变量（选择负系数最大的变量）
3. 选择出基变量（选择比值最小的约束）
4. 更新单纯形表
5. 重复直到最优

**算法实现**:

```python
def simplex_method(A, b, c):
    # 构造单纯形表
    tableau = construct_tableau(A, b, c)
    
    while not is_optimal(tableau):
        # 选择入基变量
        entering_var = select_entering_variable(tableau)
        
        # 选择出基变量
        leaving_var = select_leaving_variable(tableau, entering_var)
        
        # 更新单纯形表
        tableau = update_tableau(tableau, entering_var, leaving_var)
    
    return extract_solution(tableau)
```

#### 内点法

内点法是求解线性规划问题的多项式时间算法：

**算法步骤**:

1. 构造障碍函数
2. 求解牛顿方向
3. 更新步长
4. 收敛判断

**障碍函数**:
对于线性规划问题 min cᵀx s.t. Ax = b, x ≥ 0，障碍函数为：
φ(x) = cᵀx - μ Σ ln(xᵢ)

其中 μ > 0 是障碍参数。

### 非线性优化方法

#### 梯度下降法

梯度下降法是最基本的非线性优化算法：

**算法步骤**:

1. 初始化 x⁰
2. 计算梯度 ∇f(xᵏ)
3. 更新 xᵏ⁺¹ = xᵏ - α∇f(xᵏ)
4. 重复直到收敛

**步长选择**:

- 固定步长: α = 常数
- 线搜索: α = argmin f(xᵏ - α∇f(xᵏ))
- 自适应步长: 使用Armijo条件等

**收敛性**:
如果f是Lipschitz连续的，且步长满足适当条件，梯度下降法收敛到局部最优解。

#### 牛顿法

牛顿法利用二阶信息进行优化：

**算法步骤**:

1. 初始化 x⁰
2. 计算梯度 ∇f(xᵏ) 和Hessian矩阵 ∇²f(xᵏ)
3. 求解线性系统 ∇²f(xᵏ)d = -∇f(xᵏ)
4. 更新 xᵏ⁺¹ = xᵏ + d
5. 重复直到收敛

**优点**: 二次收敛速度
**缺点**: 需要计算和存储Hessian矩阵

#### 拟牛顿法

拟牛顿法通过近似Hessian矩阵避免直接计算：

**BFGS算法**:

```python
def bfgs_update(H, s, y):
    # BFGS更新公式
    ρ = 1 / (y.T @ s)
    I = np.eye(len(s))
    H_new = (I - ρ * np.outer(s, y)) @ H @ (I - ρ * np.outer(y, s)) + ρ * np.outer(s, s)
    return H_new
```

**DFP算法**: 直接更新Hessian逆矩阵
**SR1算法**: 对称秩1更新

### 全局优化技术

#### 遗传算法

遗传算法是模拟生物进化的全局优化算法：

**算法步骤**:

1. 初始化种群
2. 适应度评估
3. 选择操作（轮盘赌、锦标赛等）
4. 交叉操作（单点交叉、多点交叉等）
5. 变异操作
6. 更新种群
7. 重复直到收敛

**编码方式**:

- 二进制编码
- 实数编码
- 排列编码

#### 模拟退火算法

模拟退火算法模拟物理退火过程：

**算法步骤**:

1. 初始化温度和状态
2. 生成新状态
3. 计算能量差 ΔE
4. 接受准则: 如果 ΔE < 0 或 random() < exp(-ΔE/T)
5. 降温策略: T = αT
6. 重复直到收敛

**关键参数**:

- 初始温度 T₀
- 降温系数 α
- 终止温度 T_f

#### 粒子群优化

粒子群优化模拟群体行为：

**算法步骤**:

1. 初始化粒子群
2. 更新速度和位置:
   - vᵢᵏ⁺¹ = w·vᵢᵏ + c₁·r₁·(pᵢ - xᵢᵏ) + c₂·r₂·(g - xᵢᵏ)
   - xᵢᵏ⁺¹ = xᵢᵏ + vᵢᵏ⁺¹
3. 更新个体最优和全局最优
4. 重复直到收敛

**参数设置**:

- 惯性权重 w
- 学习因子 c₁, c₂
- 随机数 r₁, r₂

### 随机优化算法

#### 随机梯度下降

随机梯度下降是处理大规模数据的优化算法：

**算法步骤**:

1. 随机选择小批量数据
2. 计算随机梯度
3. 更新参数
4. 重复直到收敛

**变体**:

- 小批量梯度下降
- 随机梯度下降
- 自适应学习率（Adam、RMSprop等）

#### 随机搜索

随机搜索通过随机采样进行优化：

**算法步骤**:

1. 在当前点附近随机采样
2. 评估目标函数
3. 选择最优点
4. 重复直到收敛

**采样策略**:

- 随机游走
- 随机采样
- 随机重启

## 形式化证明

### 收敛性分析

**定理**: 在适当条件下，梯度下降法收敛到局部最优解。

**证明**:

1. **Lipschitz连续性**: 假设 ∇f 是Lipschitz连续的，即 ||∇f(x) - ∇f(y)|| ≤ L||x - y||

2. **步长选择**: 选择步长 α < 2/L

3. **收敛序列**: 构造序列 {xᵏ}，证明其收敛性

4. **极限点的最优性**: 证明极限点满足一阶必要条件

**详细证明**:
对于Lipschitz连续函数，有：
f(xᵏ⁺¹) ≤ f(xᵏ) - α(1 - αL/2)||∇f(xᵏ)||²

如果 α < 2/L，则 f(xᵏ⁺¹) < f(xᵏ)，序列单调递减且有下界，因此收敛。

### 复杂度分析

**定理**: 单纯形法在最坏情况下是指数复杂度。

**证明**:

1. **Klee-Minty多面体**: 构造一个特殊的线性规划问题，单纯形法需要遍历所有顶点

2. **最坏情况路径**: 证明存在问题实例，单纯形法需要指数步数

3. **复杂度下界**: 建立指数复杂度的下界

**Klee-Minty多面体**:
对于n维问题，存在多面体有2ⁿ个顶点，单纯形法需要访问所有顶点。

### 1最优性条件

**定理**: 对于凸优化问题，KKT条件是充分必要的。

**证明**:

1. **凸函数的性质**: 利用凸函数的一阶和二阶性质

2. **分离超平面定理**: 使用凸分析中的分离定理

3. **对偶理论的应用**: 通过拉格朗日对偶理论证明

**充分性证明**:
如果x*满足KKT条件，且f和g是凸函数，h是仿射函数，则x*是全局最优解。

## 应用实例

### 机器学习优化

#### 支持向量机优化

**问题形式**:
min (1/2)||w||² + CΣξᵢ
s.t. yᵢ(wᵀxᵢ + b) ≥ 1 - ξᵢ, ξᵢ ≥ 0

**求解方法**:

- 序列最小优化（SMO）
- 内点法
- 梯度下降法

#### 神经网络训练

**反向传播算法**:

1. 前向传播计算输出
2. 反向传播计算梯度
3. 使用优化算法更新参数

**常用优化器**:

- 随机梯度下降（SGD）
- Adam优化器
- RMSprop优化器

### 金融投资组合

#### 马科维茨投资组合优化

**问题形式**:
min wᵀΣw
s.t. wᵀμ = r, wᵀ1 = 1

其中：

- w 是投资权重向量
- Σ 是协方差矩阵
- μ 是期望收益率向量
- r 是目标收益率

**求解方法**:

- 二次规划算法
- 内点法
- 拉格朗日乘子法

#### 风险平价模型

**目标**: 使各资产的风险贡献相等

**优化问题**:
min Σᵢⱼ(wᵢσᵢⱼwⱼ - wⱼσⱼᵢwᵢ)²
s.t. wᵀ1 = 1, w ≥ 0

### 工程设计优化

#### 结构优化

**拓扑优化**:

- 目标: 最小化材料使用
- 约束: 结构强度、刚度要求
- 方法: 密度法、水平集方法

**形状优化**:

- 目标: 优化结构形状
- 约束: 几何约束、物理约束
- 方法: 参数化方法、自由形状方法

#### 参数优化

**控制系统参数**:

- 目标: 优化控制性能
- 约束: 稳定性约束
- 方法: 遗传算法、粒子群优化

**机械设计参数**:

- 目标: 优化机械性能
- 约束: 制造约束、安全约束
- 方法: 多目标优化、鲁棒优化

## 与其他主题的关联

### 前置知识

- [数值分析](./01-数值分析.md) - 数值计算的基础方法
- [线性代数](../02-代数结构/线性代数.md) - 矩阵运算和线性系统求解
- [微积分](../03-分析学/微积分.md) - 导数和积分的概念

### 后续发展

- [并行计算](./04-并行计算.md) - 并行优化算法
- [符号计算](./05-符号计算.md) - 符号优化方法
- [机器学习数学](../11-高级数学/机器学习数学.md) - 机器学习中的优化

### 交叉联系

- **与数值分析的关系**: 优化算法大量使用数值计算方法
- **与线性代数的联系**: 矩阵运算在优化算法中起核心作用
- **与概率论的应用**: 随机优化算法基于概率理论

## 参考文献

### 经典文献

1. Dantzig, G.B. (1947). "Linear Programming and Extensions". Princeton University Press.
2. Fletcher, R. (1987). "Practical Methods of Optimization". John Wiley & Sons.
3. Nocedal, J., Wright, S.J. (2006). "Numerical Optimization". Springer.

### 现代发展

1. Boyd, S., Vandenberghe, L. (2004). "Convex Optimization". Cambridge University Press.
2. Bertsekas, D.P. (2016). "Nonlinear Programming". Athena Scientific.
3. Bazaraa, M.S., Sherali, H.D., Shetty, C.M. (2006). "Nonlinear Programming". John Wiley & Sons.

### 在线资源

- [Wikipedia: Optimization algorithm](https://en.wikipedia.org/wiki/Optimization_algorithm)
- [MathWorld: Optimization](https://mathworld.wolfram.com/Optimization.html)
- [Stanford CS229: Machine Learning](http://cs229.stanford.edu/)

---

**文档状态**: 优化算法国际标准对齐完成  
**更新日期**: 2025年1月  
**内容质量**: 符合国际数学标准  
**教育价值**: 高

## 术语对照表 / Terminology Table / Tableau des termes / Terminologietabelle

| 中文 | English | Français | Deutsch |
|---|---|---|---|
| 优化算法 | Optimization algorithm | Algorithme d'optimisation | Optimierungsalgorithmus |
| 线性规划 | Linear programming | Programmation linéaire | Lineare Programmierung |
| 非线性优化 | Nonlinear optimization | Optimisation non linéaire | Nichtlineare Optimierung |
| 全局优化 | Global optimization | Optimisation globale | Globale Optimierung |
| 单纯形法 | Simplex method | Méthode du simplexe | Simplex-Verfahren |
| 内点法 | Interior point method | Méthode des points intérieurs | Innere-Punkte-Verfahren |
| 梯度下降 | Gradient descent | Descente de gradient | Gradientenabstieg |
| 牛顿法 | Newton's method | Méthode de Newton | Newton-Verfahren |
| 遗传算法 | Genetic algorithm | Algorithme génétique | Genetischer Algorithmus |
| 模拟退火 | Simulated annealing | Recuit simulé | Simulierte Abkühlung |
| 粒子群优化 | Particle swarm optimization | Optimisation par essaim de particules | Partikelschwarm-Optimierung |
| KKT条件 | KKT conditions | Conditions KKT | KKT-Bedingungen |
