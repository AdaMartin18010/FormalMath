# 6.1 åˆç­‰æ•°è®º / Elementary Number Theory

## ç›®å½• / Table of Contents

- [6.1 åˆç­‰æ•°è®º / Elementary Number Theory](#61-åˆç­‰æ•°è®º--elementary-number-theory)
  - [ç›®å½• / Table of Contents](#ç›®å½•--table-of-contents)
  - [6.1.1 åŸºæœ¬æ¦‚å¿µ / Basic Concepts](#611-åŸºæœ¬æ¦‚å¿µ--basic-concepts)
    - [6.1.1.1 è‡ªç„¶æ•°ä¸æ•´æ•° / Natural Numbers and Integers](#6111-è‡ªç„¶æ•°ä¸æ•´æ•°--natural-numbers-and-integers)
    - [6.1.1.2 æœ€å¤§å…¬çº¦æ•°ä¸æœ€å°å…¬å€æ•° / Greatest Common Divisor and Least Common Multiple](#6112-æœ€å¤§å…¬çº¦æ•°ä¸æœ€å°å…¬å€æ•°--greatest-common-divisor-and-least-common-multiple)
    - [6.1.1.3 ç´ æ•° / Prime Numbers](#6113-ç´ æ•°--prime-numbers)
    - [å®ä¾‹è¡¨å¾ / Instance Representation](#å®ä¾‹è¡¨å¾--instance-representation)
      - [å®ä¾‹1: æ•´é™¤æ€§åŸºæœ¬å®ä¾‹ / Basic Divisibility Examples](#å®ä¾‹1-æ•´é™¤æ€§åŸºæœ¬å®ä¾‹--basic-divisibility-examples)
      - [å®ä¾‹2: ç´ æ•°è¯†åˆ«ä¸åˆ†è§£ / Prime Number Identification and Factorization](#å®ä¾‹2-ç´ æ•°è¯†åˆ«ä¸åˆ†è§£--prime-number-identification-and-factorization)
      - [å®ä¾‹3: æœ€å¤§å…¬çº¦æ•°ä¸æœ€å°å…¬å€æ•° / Greatest Common Divisor and Least Common Multiple](#å®ä¾‹3-æœ€å¤§å…¬çº¦æ•°ä¸æœ€å°å…¬å€æ•°--greatest-common-divisor-and-least-common-multiple)
  - [6.1.2 æ•´é™¤ç†è®º / Divisibility Theory](#612-æ•´é™¤ç†è®º--divisibility-theory)
    - [6.1.2.1 æ•´é™¤çš„åŸºæœ¬æ€§è´¨ / Basic Properties of Divisibility](#6121-æ•´é™¤çš„åŸºæœ¬æ€§è´¨--basic-properties-of-divisibility)
    - [6.1.2.2 æ¬§å‡ é‡Œå¾—ç®—æ³• / Euclidean Algorithm](#6122-æ¬§å‡ é‡Œå¾—ç®—æ³•--euclidean-algorithm)
    - [6.1.2.3 çº¿æ€§ä¸¢ç•ªå›¾æ–¹ç¨‹ / Linear Diophantine Equations](#6123-çº¿æ€§ä¸¢ç•ªå›¾æ–¹ç¨‹--linear-diophantine-equations)
  - [6.1.3 åŒä½™ç†è®º / Congruence Theory](#613-åŒä½™ç†è®º--congruence-theory)
    - [6.1.3.1 åŒä½™çš„åŸºæœ¬æ¦‚å¿µ / Basic Concepts of Congruence](#6131-åŒä½™çš„åŸºæœ¬æ¦‚å¿µ--basic-concepts-of-congruence)
    - [6.1.3.2 å‰©ä½™ç±» / Residue Classes](#6132-å‰©ä½™ç±»--residue-classes)
    - [6.1.3.3 ç®€åŒ–å‰©ä½™ç³» / Reduced Residue System](#6133-ç®€åŒ–å‰©ä½™ç³»--reduced-residue-system)
    - [6.1.3.4 è´¹é©¬å°å®šç†ä¸æ¬§æ‹‰å®šç† / Fermat's Little Theorem and Euler's Theorem](#6134-è´¹é©¬å°å®šç†ä¸æ¬§æ‹‰å®šç†--fermats-little-theorem-and-eulers-theorem)
    - [1å®ä¾‹è¡¨å¾ / Instance Representation](#1å®ä¾‹è¡¨å¾--instance-representation)
      - [å®ä¾‹1: åŒä½™åŸºæœ¬è¿ç®— / Basic Congruence Operations](#å®ä¾‹1-åŒä½™åŸºæœ¬è¿ç®—--basic-congruence-operations)
      - [å®ä¾‹2: æ¨¡è¿ç®—å®é™…åº”ç”¨ / Practical Applications of Modular Arithmetic](#å®ä¾‹2-æ¨¡è¿ç®—å®é™…åº”ç”¨--practical-applications-of-modular-arithmetic)
      - [å®ä¾‹3: è´¹é©¬å°å®šç†ä¸æ¬§æ‹‰å®šç†åº”ç”¨ / Applications of Fermat's Little Theorem and Euler's Theorem](#å®ä¾‹3-è´¹é©¬å°å®šç†ä¸æ¬§æ‹‰å®šç†åº”ç”¨--applications-of-fermats-little-theorem-and-eulers-theorem)
      - [å®ä¾‹4: å‰©ä½™ç±»ä¸ç®€åŒ–å‰©ä½™ç³» / Residue Classes and Reduced Residue Systems](#å®ä¾‹4-å‰©ä½™ç±»ä¸ç®€åŒ–å‰©ä½™ç³»--residue-classes-and-reduced-residue-systems)
  - [6.1.4 äºŒæ¬¡å‰©ä½™ / Quadratic Residues](#614-äºŒæ¬¡å‰©ä½™--quadratic-residues)
    - [6.1.4.1 äºŒæ¬¡å‰©ä½™çš„å®šä¹‰ / Definition of Quadratic Residues](#6141-äºŒæ¬¡å‰©ä½™çš„å®šä¹‰--definition-of-quadratic-residues)
    - [6.1.4.2 å‹’è®©å¾·ç¬¦å· / Legendre Symbol](#6142-å‹’è®©å¾·ç¬¦å·--legendre-symbol)
    - [6.1.4.3 äºŒæ¬¡äº’åå¾‹ / Quadratic Reciprocity](#6143-äºŒæ¬¡äº’åå¾‹--quadratic-reciprocity)
  - [6.1.5 åŸæ ¹ä¸æŒ‡æ ‡ / Primitive Roots and Indices](#615-åŸæ ¹ä¸æŒ‡æ ‡--primitive-roots-and-indices)
    - [6.1.5.1 åŸæ ¹ / Primitive Roots](#6151-åŸæ ¹--primitive-roots)
    - [6.1.5.2 æŒ‡æ ‡ / Indices](#6152-æŒ‡æ ‡--indices)
    - [2å®ä¾‹è¡¨å¾ / Instance Representation](#2å®ä¾‹è¡¨å¾--instance-representation)
      - [å®ä¾‹1: äºŒæ¬¡å‰©ä½™è®¡ç®— / Quadratic Residue Calculation](#å®ä¾‹1-äºŒæ¬¡å‰©ä½™è®¡ç®—--quadratic-residue-calculation)
      - [å®ä¾‹2: å‹’è®©å¾·ç¬¦å·è®¡ç®— / Legendre Symbol Calculation](#å®ä¾‹2-å‹’è®©å¾·ç¬¦å·è®¡ç®—--legendre-symbol-calculation)
      - [å®ä¾‹3: äºŒæ¬¡äº’åå¾‹åº”ç”¨ / Application of Quadratic Reciprocity](#å®ä¾‹3-äºŒæ¬¡äº’åå¾‹åº”ç”¨--application-of-quadratic-reciprocity)
      - [å®ä¾‹4: åŸæ ¹ä¸æŒ‡æ ‡ / Primitive Roots and Indices](#å®ä¾‹4-åŸæ ¹ä¸æŒ‡æ ‡--primitive-roots-and-indices)
    - [6.1.5.3 ç¦»æ•£å¯¹æ•° / Discrete Logarithm](#6153-ç¦»æ•£å¯¹æ•°--discrete-logarithm)
  - [6.1.6 è¿åˆ†æ•° / Continued Fractions](#616-è¿åˆ†æ•°--continued-fractions)
    - [6.1.6.1 ç®€å•è¿åˆ†æ•° / Simple Continued Fractions](#6161-ç®€å•è¿åˆ†æ•°--simple-continued-fractions)
    - [6.1.6.2 è¿åˆ†æ•°çš„æ€§è´¨ / Properties of Continued Fractions](#6162-è¿åˆ†æ•°çš„æ€§è´¨--properties-of-continued-fractions)
    - [6.1.6.3 ä½©å°”æ–¹ç¨‹ / Pell's Equation](#6163-ä½©å°”æ–¹ç¨‹--pells-equation)
  - [6.1.7 ä¸¢ç•ªå›¾æ–¹ç¨‹ / Diophantine Equations](#617-ä¸¢ç•ªå›¾æ–¹ç¨‹--diophantine-equations)
    - [6.1.7.1 çº¿æ€§ä¸¢ç•ªå›¾æ–¹ç¨‹ / Linear Diophantine Equations](#6171-çº¿æ€§ä¸¢ç•ªå›¾æ–¹ç¨‹--linear-diophantine-equations)
    - [6.1.7.2 æ¯•è¾¾å“¥æ‹‰æ–¯ä¸‰å…ƒç»„ / Pythagorean Triples](#6172-æ¯•è¾¾å“¥æ‹‰æ–¯ä¸‰å…ƒç»„--pythagorean-triples)
    - [6.1.7.3 è´¹é©¬å¤§å®šç† / Fermat's Last Theorem](#6173-è´¹é©¬å¤§å®šç†--fermats-last-theorem)
  - [6.1.8 å½¢å¼åŒ–å®ç° / Formal Implementation](#618-å½¢å¼åŒ–å®ç°--formal-implementation)
    - [6.1.8.1 Lean 4 å®ç° / Lean 4 Implementation](#6181-lean-4-å®ç°--lean-4-implementation)
    - [6.1.8.2 Haskell å®ç° / Haskell Implementation](#6182-haskell-å®ç°--haskell-implementation)
    - [6.1.8.3 é‡è¦å®šç†æ€»ç»“ / Summary of Important Theorems](#6183-é‡è¦å®šç†æ€»ç»“--summary-of-important-theorems)
  - [å‚è€ƒæ–‡çŒ® / References](#å‚è€ƒæ–‡çŒ®--references)
    - [ç»å…¸æ•™æ / Classic Textbooks](#ç»å…¸æ•™æ--classic-textbooks)
    - [ç°ä»£æ•™æ / Modern Textbooks](#ç°ä»£æ•™æ--modern-textbooks)
    - [å†å²æ–‡çŒ® / Historical Literature](#å†å²æ–‡çŒ®--historical-literature)
    - [åœ¨çº¿èµ„æº / Online Resources](#åœ¨çº¿èµ„æº--online-resources)

---

## ğŸ—ºï¸ åˆç­‰æ•°è®ºæ ¸å¿ƒæ¦‚å¿µæ€ç»´å¯¼å›¾

```mermaid
mindmap
  root((åˆç­‰æ•°è®º))
    åŸºç¡€æ¦‚å¿µ
      è‡ªç„¶æ•°
        çš®äºšè¯ºå…¬ç†
        å½’çº³æ³•
      æ•´æ•°
        æ•´æ•°æ„é€ 
        ç®—æœ¯è¿ç®—
    æ•´é™¤ç†è®º
      æ•´é™¤
        æ•´é™¤å®šä¹‰
        æ•´é™¤æ€§è´¨
      æœ€å¤§å…¬çº¦æ•°
        gcdå®šä¹‰
        æ¬§å‡ é‡Œå¾—ç®—æ³•
        è´ç¥–ç­‰å¼
      æœ€å°å…¬å€æ•°
        lcmå®šä¹‰
        ä¸gcdå…³ç³»
    ç´ æ•°ç†è®º
      ç´ æ•°
        ç´ æ•°å®šä¹‰
        ç´ æ•°åˆ†å¸ƒ
      ç´ æ•°å®šç†
        æ¸è¿‘åˆ†å¸ƒ
        åº”ç”¨
    åŒä½™ç†è®º
      åŒä½™
        åŒä½™å®šä¹‰
        åŒä½™æ€§è´¨
      å‰©ä½™ç±»
        å‰©ä½™ç±»å®šä¹‰
        ç¾¤ç»“æ„
      è´¹é©¬å°å®šç†
        è´¹é©¬å°å®šç†
        åº”ç”¨
      æ¬§æ‹‰å®šç†
        æ¬§æ‹‰å®šç†
        åº”ç”¨
    äºŒæ¬¡å‰©ä½™
      äºŒæ¬¡å‰©ä½™
        äºŒæ¬¡å‰©ä½™å®šä¹‰
        å‹’è®©å¾·ç¬¦å·
      äºŒæ¬¡äº’åå¾‹
        äºŒæ¬¡äº’åå¾‹
        åº”ç”¨
    åŸæ ¹ç†è®º
      åŸæ ¹
        åŸæ ¹å®šä¹‰
        å­˜åœ¨æ€§
      æŒ‡æ ‡
        æŒ‡æ ‡å®šä¹‰
        ç¦»æ•£å¯¹æ•°
    ä¸¢ç•ªå›¾æ–¹ç¨‹
      çº¿æ€§æ–¹ç¨‹
        çº¿æ€§ä¸¢ç•ªå›¾æ–¹ç¨‹
        è§£çš„å­˜åœ¨æ€§
      ä½©å°”æ–¹ç¨‹
        ä½©å°”æ–¹ç¨‹
        è§£çš„ç»“æ„
```

## ğŸ“Š åˆç­‰æ•°è®ºæ ¸å¿ƒæ¦‚å¿µå¤šç»´çŸ¥è¯†çŸ©é˜µ

| æ¦‚å¿µç±»åˆ« | æ ¸å¿ƒæ¦‚å¿µ | å®šä¹‰è¦ç‚¹ | å…³é”®æ€§è´¨ | å…¸å‹ä¾‹å­ | åº”ç”¨åœºæ™¯ |
|---------|---------|---------|---------|---------|---------|
| åŸºç¡€æ¦‚å¿µ | è‡ªç„¶æ•° | çš®äºšè¯ºå…¬ç† | å½’çº³æ³• | â„• | æ•°å­¦åŸºç¡€ |
| åŸºç¡€æ¦‚å¿µ | æ•´æ•° | è‡ªç„¶æ•°æ‰©å¼  | ç¾¤ç»“æ„ | â„¤ | æ•°å­¦åŸºç¡€ |
| æ•´é™¤ç†è®º | æ•´é™¤ | æ•´æ•°é™¤æ³• | ä¼ é€’æ€§ | a\|b | å› å­åˆ†è§£ |
| æ•´é™¤ç†è®º | æœ€å¤§å…¬çº¦æ•° | å…¬å…±å› å­æœ€å¤§ | è´ç¥–ç­‰å¼ | gcd(a,b) | ç®—æ³•è®¾è®¡ |
| æ•´é™¤ç†è®º | æ¬§å‡ é‡Œå¾—ç®—æ³• | è¾—è½¬ç›¸é™¤ | é«˜æ•ˆç®—æ³• | gcdè®¡ç®— | ç®—æ³•è®¾è®¡ |
| ç´ æ•°ç†è®º | ç´ æ•° | åªæœ‰1å’Œè‡ªèº«å› å­ | æ— ç©·æ€§ | 2,3,5,7 | å¯†ç å­¦ |
| ç´ æ•°ç†è®º | ç´ æ•°å®šç† | æ¸è¿‘åˆ†å¸ƒ | å¯¹æ•°ç§¯åˆ† | Ï€(x) ~ x/log x | æ•°è®ºç ”ç©¶ |
| åŒä½™ç†è®º | åŒä½™ | æ¨¡è¿ç®—ç›¸ç­‰ | ç­‰ä»·å…³ç³» | a â‰¡ b (mod n) | å¯†ç å­¦ |
| åŒä½™ç†è®º | å‰©ä½™ç±» | åŒä½™ç±» | ç¾¤ç»“æ„ | â„¤/nâ„¤ | å¯†ç å­¦ |
| åŒä½™ç†è®º | è´¹é©¬å°å®šç† | ç´ æ•°æ¨¡å¹‚ | a^p â‰¡ a (mod p) | è´¹é©¬å°å®šç† | å¯†ç å­¦ |
| åŒä½™ç†è®º | æ¬§æ‹‰å®šç† | äº’ç´ æ¨¡å¹‚ | a^Ï†(n) â‰¡ 1 (mod n) | æ¬§æ‹‰å®šç† | å¯†ç å­¦ |
| äºŒæ¬¡å‰©ä½™ | äºŒæ¬¡å‰©ä½™ | å¹³æ–¹å‰©ä½™ | æ¬§æ‹‰å‡†åˆ™ | å‹’è®©å¾·ç¬¦å· | å¯†ç å­¦ |
| äºŒæ¬¡å‰©ä½™ | äºŒæ¬¡äº’åå¾‹ | äº’åå…³ç³» | å¯¹ç§°æ€§ | äºŒæ¬¡äº’åå¾‹ | æ•°è®º |
| åŸæ ¹ç†è®º | åŸæ ¹ | ç”Ÿæˆå‰©ä½™ç±»ç¾¤ | å­˜åœ¨æ€§ | åŸæ ¹ | å¯†ç å­¦ |
| åŸæ ¹ç†è®º | æŒ‡æ ‡ | ç¦»æ•£å¯¹æ•° | å¯¹æ•°æ€§è´¨ | ind_g(a) | å¯†ç å­¦ |
| ä¸¢ç•ªå›¾æ–¹ç¨‹ | çº¿æ€§æ–¹ç¨‹ | ax+by=c | è§£çš„å­˜åœ¨æ€§ | çº¿æ€§æ–¹ç¨‹ | æ•°è®º |
| ä¸¢ç•ªå›¾æ–¹ç¨‹ | ä½©å°”æ–¹ç¨‹ | xÂ²-dyÂ²=1 | æ— ç©·è§£ | ä½©å°”æ–¹ç¨‹ | æ•°è®º |

## 6.1.1 åŸºæœ¬æ¦‚å¿µ / Basic Concepts

### 6.1.1.1 è‡ªç„¶æ•°ä¸æ•´æ•° / Natural Numbers and Integers

**å®šä¹‰ 6.1.1.1** (è‡ªç„¶æ•° / Natural Numbers)
è‡ªç„¶æ•°é›† $\mathbb{N} = \{1, 2, 3, \ldots\}$ æ»¡è¶³çš®äºšè¯ºå…¬ç†ï¼š

1. **å½’çº³å…¬ç†** / Induction Axiom: å¦‚æœ $S \subseteq \mathbb{N}$ åŒ…å« $1$ ä¸”å¯¹ä»»æ„ $n \in S$ éƒ½æœ‰ $n+1 \in S$ï¼Œåˆ™ $S = \mathbb{N}$
2. **è‰¯åºå…¬ç†** / Well-Ordering Axiom: $\mathbb{N}$ çš„ä»»æ„éç©ºå­é›†éƒ½æœ‰æœ€å°å…ƒç´ 

**å®šä¹‰ 6.1.1.2** (æ•´æ•° / Integers)
æ•´æ•°é›† $\mathbb{Z} = \{\ldots, -2, -1, 0, 1, 2, \ldots\}$ æ˜¯è‡ªç„¶æ•°é›†çš„æ‰©å¼ ã€‚

**å®šç† 6.1.1.1** (æ•°å­¦å½’çº³æ³• / Mathematical Induction)
è®¾ $P(n)$ æ˜¯å…³äºè‡ªç„¶æ•° $n$ çš„å‘½é¢˜ã€‚å¦‚æœï¼š

1. $P(1)$ ä¸ºçœŸ
2. å¯¹ä»»æ„ $k \in \mathbb{N}$ï¼Œ$P(k) \Rightarrow P(k+1)$

åˆ™ $P(n)$ å¯¹æ‰€æœ‰ $n \in \mathbb{N}$ ä¸ºçœŸã€‚

### 6.1.1.2 æœ€å¤§å…¬çº¦æ•°ä¸æœ€å°å…¬å€æ•° / Greatest Common Divisor and Least Common Multiple

**å®šä¹‰ 6.1.1.3** (æœ€å¤§å…¬çº¦æ•° / Greatest Common Divisor)
æ•´æ•° $a$ å’Œ $b$ çš„æœ€å¤§å…¬çº¦æ•° $\gcd(a,b)$ æ˜¯æ»¡è¶³ $d \mid a$ å’Œ $d \mid b$ çš„æœ€å¤§æ­£æ•´æ•° $d$ã€‚

**å®šä¹‰ 6.1.1.4** (æœ€å°å…¬å€æ•° / Least Common Multiple)
æ•´æ•° $a$ å’Œ $b$ çš„æœ€å°å…¬å€æ•° $\text{lcm}(a,b)$ æ˜¯æ»¡è¶³ $a \mid m$ å’Œ $b \mid m$ çš„æœ€å°æ­£æ•´æ•° $m$ã€‚

**å®šç† 6.1.1.5** (æœ€å¤§å…¬çº¦æ•°çš„æ€§è´¨ / Properties of GCD)
å¯¹äºä»»æ„æ•´æ•° $a, b, c$ï¼š

1. $\gcd(a,b) = \gcd(b,a)$
2. $\gcd(a,b) = \gcd(a, b \bmod a)$
3. $\gcd(ac, bc) = |c| \cdot \gcd(a,b)$
4. $\gcd(a, \gcd(b,c)) = \gcd(\gcd(a,b), c)$

**å®šç† 6.1.1.6** (æœ€å°å…¬å€æ•°çš„æ€§è´¨ / Properties of LCM)
$$\text{lcm}(a,b) = \frac{|ab|}{\gcd(a,b)}$$

### 6.1.1.3 ç´ æ•° / Prime Numbers

**å®šä¹‰ 6.1.1.7** (ç´ æ•° / Prime Number)
å¤§äº $1$ çš„æ­£æ•´æ•° $p$ ç§°ä¸ºç´ æ•°ï¼Œå¦‚æœ $p$ çš„æ­£å› å­åªæœ‰ $1$ å’Œ $p$ã€‚

**å®šä¹‰ 6.1.1.8** (åˆæ•° / Composite Number)
å¤§äº $1$ çš„æ­£æ•´æ•° $n$ ç§°ä¸ºåˆæ•°ï¼Œå¦‚æœ $n$ ä¸æ˜¯ç´ æ•°ã€‚

**å®šç† 6.1.1.9** (ç®—æœ¯åŸºæœ¬å®šç† / Fundamental Theorem of Arithmetic)
ä»»æ„å¤§äº $1$ çš„æ­£æ•´æ•°éƒ½å¯ä»¥å”¯ä¸€åœ°è¡¨ç¤ºä¸ºç´ æ•°çš„ä¹˜ç§¯ï¼š
$$n = p_1^{e_1} p_2^{e_2} \cdots p_k^{e_k}$$
å…¶ä¸­ $p_1 < p_2 < \cdots < p_k$ æ˜¯ç´ æ•°ï¼Œ$e_i > 0$ã€‚

**è¯æ˜æ€è·¯**:

1. å­˜åœ¨æ€§ï¼šä½¿ç”¨æ•°å­¦å½’çº³æ³•
2. å”¯ä¸€æ€§ï¼šä½¿ç”¨æ¬§å‡ é‡Œå¾—å¼•ç†

**è¯¦ç»†è¯æ˜**:

- **å­˜åœ¨æ€§è¯æ˜**:
  - **åŸºç¡€æƒ…å†µ**: $n = 2$ æ˜¯ç´ æ•°ï¼Œç»“è®ºæˆç«‹
  - **å½’çº³æ­¥éª¤**: å‡è®¾æ‰€æœ‰å°äº $n$ çš„æ­£æ•´æ•°éƒ½å¯ä»¥è¡¨ç¤ºä¸ºç´ æ•°çš„ä¹˜ç§¯
  - å¦‚æœ $n$ æ˜¯ç´ æ•°ï¼Œç»“è®ºæˆç«‹
  - å¦‚æœ $n$ æ˜¯åˆæ•°ï¼Œåˆ™ $n = ab$ï¼Œå…¶ä¸­ $1 < a, b < n$
  - ç”±å½’çº³å‡è®¾ï¼Œ$a$ å’Œ $b$ éƒ½å¯ä»¥è¡¨ç¤ºä¸ºç´ æ•°çš„ä¹˜ç§¯
  - å› æ­¤ $n = ab$ ä¹Ÿå¯ä»¥è¡¨ç¤ºä¸ºç´ æ•°çš„ä¹˜ç§¯
- **å”¯ä¸€æ€§è¯æ˜**:
  - å‡è®¾ $n = p_1^{e_1} p_2^{e_2} \cdots p_k^{e_k} = q_1^{f_1} q_2^{f_2} \cdots q_l^{f_l}$ æ˜¯ä¸¤ä¸ªä¸åŒçš„ç´ å› æ•°åˆ†è§£
  - ç”±æ¬§å‡ é‡Œå¾—å¼•ç†ï¼Œ$p_1$ å¿…é¡»æ•´é™¤æŸä¸ª $q_j$
  - ç”±äº $p_1$ å’Œ $q_j$ éƒ½æ˜¯ç´ æ•°ï¼Œ$p_1 = q_j$
  - é€šè¿‡é‡æ–°æ’åºï¼Œå¯ä»¥å‡è®¾ $p_1 = q_1$
  - å¦‚æœ $e_1 > f_1$ï¼Œåˆ™ $p_1^{e_1 - f_1} p_2^{e_2} \cdots p_k^{e_k} = q_2^{f_2} \cdots q_l^{f_l}$
  - å·¦è¾¹è¢« $p_1$ æ•´é™¤ï¼Œå³è¾¹ä¸è¢« $p_1$ æ•´é™¤ï¼ˆå› ä¸º $q_2, \ldots, q_l$ éƒ½ä¸ç­‰äº $p_1$ï¼‰ï¼ŒçŸ›ç›¾
  - ç±»ä¼¼åœ°ï¼Œ$e_1 < f_1$ ä¹Ÿå¯¼è‡´çŸ›ç›¾
  - å› æ­¤ $e_1 = f_1$ï¼Œå¯ä»¥çº¦å» $p_1^{e_1}$ï¼Œç»§ç»­è¿™ä¸ªè¿‡ç¨‹
  - æœ€ç»ˆå¾—åˆ° $k = l$ ä¸” $p_i = q_i$ï¼Œ$e_i = f_i$ å¯¹æ‰€æœ‰ $i$ æˆç«‹

**å®šç† 6.1.1.10** (æ¬§å‡ é‡Œå¾—å¼•ç† / Euclid's Lemma)
å¦‚æœç´ æ•° $p$ æ•´é™¤ $ab$ï¼Œåˆ™ $p$ æ•´é™¤ $a$ æˆ– $p$ æ•´é™¤ $b$ã€‚

**è¯æ˜æ€è·¯**:

1. åˆ©ç”¨æœ€å¤§å…¬å› æ•°çš„æ€§è´¨
2. ä½¿ç”¨è´ç¥–å®šç†

**è¯¦ç»†è¯æ˜**:

- **æ­¥éª¤ 1**: å‡è®¾ $p \mid ab$ ä½† $p \nmid a$ ä¸” $p \nmid b$
- **æ­¥éª¤ 2**: ç”±äº $p$ æ˜¯ç´ æ•°ä¸” $p \nmid a$ï¼Œ$\gcd(p, a) = 1$
- **æ­¥éª¤ 3**: ç”±è´ç¥–å®šç†ï¼Œå­˜åœ¨æ•´æ•° $x, y$ ä½¿å¾— $px + ay = 1$
- **æ­¥éª¤ 4**: ä¸¤è¾¹ä¹˜ä»¥ $b$ï¼Œå¾—åˆ° $pbx + aby = b$
- **æ­¥éª¤ 5**: ç”±äº $p \mid ab$ï¼Œå­˜åœ¨æ•´æ•° $k$ ä½¿å¾— $ab = pk$
- **æ­¥éª¤ 6**: å› æ­¤ $b = pbx + pky = p(bx + ky)$
- **æ­¥éª¤ 7**: æ‰€ä»¥ $p \mid b$ï¼Œè¿™ä¸å‡è®¾çŸ›ç›¾
- å› æ­¤ï¼Œå¦‚æœ $p \mid ab$ï¼Œåˆ™ $p \mid a$ æˆ– $p \mid b$

### å®ä¾‹è¡¨å¾ / Instance Representation

#### å®ä¾‹1: æ•´é™¤æ€§åŸºæœ¬å®ä¾‹ / Basic Divisibility Examples

**æ¦‚å¿µ**: æ•´é™¤çš„å®šä¹‰å’ŒåŸºæœ¬æ€§è´¨
**å®ä¾‹**:

- **åŸºæœ¬æ•´é™¤å…³ç³»**:
  - $6 \mid 12$ï¼Œå› ä¸º $12 = 2 \times 6$
  - $3 \mid 15$ï¼Œå› ä¸º $15 = 5 \times 3$
  - $7 \mid 21$ï¼Œå› ä¸º $21 = 3 \times 7$
- **æ•´é™¤æ€§è´¨éªŒè¯**:
  - ä¼ é€’æ€§: å¦‚æœ $2 \mid 6$ ä¸” $6 \mid 18$ï¼Œåˆ™ $2 \mid 18$ âœ“
  - çº¿æ€§ç»„åˆ: å¦‚æœ $3 \mid 9$ ä¸” $3 \mid 12$ï¼Œåˆ™ $3 \mid (9+12) = 21$ âœ“
- **éæ•´é™¤ä¾‹å­**:
  - $5 \nmid 12$ï¼Œå› ä¸º $12 \div 5 = 2.4$ ä¸æ˜¯æ•´æ•°
  - $7 \nmid 20$ï¼Œå› ä¸º $20 \div 7 \approx 2.857$ ä¸æ˜¯æ•´æ•°

#### å®ä¾‹2: ç´ æ•°è¯†åˆ«ä¸åˆ†è§£ / Prime Number Identification and Factorization

**æ¦‚å¿µ**: ç´ æ•°çš„å®šä¹‰å’Œç®—æœ¯åŸºæœ¬å®šç†
**å®ä¾‹**:

- **å°ç´ æ•°è¯†åˆ«** (å°äº20):
  - ç´ æ•°: $2, 3, 5, 7, 11, 13, 17, 19$
  - åˆæ•°: $4, 6, 8, 9, 10, 12, 14, 15, 16, 18$
- **åˆæ•°åˆ†è§£**:
  - $12 = 2 \times 2 \times 3 = 2^2 \times 3$
  - $18 = 2 \times 3 \times 3 = 2 \times 3^2$
  - $24 = 2 \times 2 \times 2 \times 3 = 2^3 \times 3$
  - $30 = 2 \times 3 \times 5$
- **ç´ æ•°åˆ†å¸ƒè§‚å¯Ÿ**:
  - 1-10: 4ä¸ªç´ æ•° $(2,3,5,7)$
  - 11-20: 4ä¸ªç´ æ•° $(11,13,17,19)$
  - 21-30: 2ä¸ªç´ æ•° $(23,29)$

#### å®ä¾‹3: æœ€å¤§å…¬çº¦æ•°ä¸æœ€å°å…¬å€æ•° / Greatest Common Divisor and Least Common Multiple

**æ¦‚å¿µ**: GCDå’ŒLCMçš„è®¡ç®—å’Œæ€§è´¨
**å®ä¾‹**:

- **æ¬§å‡ é‡Œå¾—ç®—æ³•è®¡ç®—GCD**:
  - $\gcd(48, 18)$:
    - $48 = 2 \times 18 + 12$
    - $18 = 1 \times 12 + 6$
    - $12 = 2 \times 6 + 0$
    - æ‰€ä»¥ $\gcd(48, 18) = 6$
- **LCMè®¡ç®—**:
  - $\text{lcm}(12, 18) = \frac{12 \times 18}{\gcd(12, 18)} = \frac{216}{6} = 36$
- **æ€§è´¨éªŒè¯**:
  - $\gcd(12, 18) = 6$, $\text{lcm}(12, 18) = 36$
  - $12 \times 18 = 216 = 6 \times 36$ âœ“

---

## 6.1.2 æ•´é™¤ç†è®º / Divisibility Theory

### 6.1.2.1 æ•´é™¤çš„åŸºæœ¬æ€§è´¨ / Basic Properties of Divisibility

**å®šä¹‰ 6.1.2.1** (æ•´é™¤ / Divisibility)
æ•´æ•° $a$ æ•´é™¤æ•´æ•° $b$ï¼Œè®°ä½œ $a \mid b$ï¼Œå¦‚æœå­˜åœ¨æ•´æ•° $k$ ä½¿å¾— $b = ak$ã€‚

**å®šç† 6.1.2.2** (æ•´é™¤çš„æ€§è´¨ / Properties of Divisibility)
å¯¹äºä»»æ„æ•´æ•° $a, b, c$ï¼š

1. **è‡ªåæ€§** / Reflexivity: $a \mid a$
2. **ä¼ é€’æ€§** / Transitivity: $a \mid b, b \mid c \Rightarrow a \mid c$
3. **çº¿æ€§ç»„åˆ** / Linear Combination: $a \mid b, a \mid c \Rightarrow a \mid (mb + nc)$
4. **ä¹˜æ³•ä¿æŒ** / Multiplication Preserves: $a \mid b \Rightarrow ac \mid bc$

### 6.1.2.2 æ¬§å‡ é‡Œå¾—ç®—æ³• / Euclidean Algorithm

**å®šç† 6.1.2.3** (æ¬§å‡ é‡Œå¾—ç®—æ³• / Euclidean Algorithm)
å¯¹äºä»»æ„æ•´æ•° $a, b$ï¼Œå­˜åœ¨æ•´æ•° $x, y$ ä½¿å¾—ï¼š
$$\gcd(a,b) = ax + by$$

**ç®—æ³•** / Algorithm:

```python
def extended_gcd(a, b):
    if b == 0:
        return a, 1, 0
    else:
        gcd, x, y = extended_gcd(b, a % b)
        return gcd, y, x - (a // b) * y
```

**å®šç† 6.1.2.4** (è´ç¥–å®šç† / BÃ©zout's Theorem)
å¯¹äºä»»æ„æ•´æ•° $a, b$ï¼Œæ–¹ç¨‹ $ax + by = \gcd(a,b)$ æœ‰æ•´æ•°è§£ã€‚

### 6.1.2.3 çº¿æ€§ä¸¢ç•ªå›¾æ–¹ç¨‹ / Linear Diophantine Equations

**å®šç† 6.1.2.5** (çº¿æ€§ä¸¢ç•ªå›¾æ–¹ç¨‹çš„è§£ / Solution of Linear Diophantine Equation)
æ–¹ç¨‹ $ax + by = c$ æœ‰æ•´æ•°è§£å½“ä¸”ä»…å½“ $\gcd(a,b) \mid c$ã€‚

**å®šç† 6.1.2.6** (çº¿æ€§ä¸¢ç•ªå›¾æ–¹ç¨‹çš„é€šè§£ / General Solution)
å¦‚æœ $(x_0, y_0)$ æ˜¯æ–¹ç¨‹ $ax + by = c$ çš„ä¸€ä¸ªç‰¹è§£ï¼Œåˆ™é€šè§£ä¸ºï¼š
$$x = x_0 + \frac{b}{\gcd(a,b)}t, \quad y = y_0 - \frac{a}{\gcd(a,b)}t$$
å…¶ä¸­ $t$ æ˜¯ä»»æ„æ•´æ•°ã€‚

**å®šç† 6.1.2.7** (ä¸­å›½å‰©ä½™å®šç† / Chinese Remainder Theorem)
è®¾ $m_1, m_2, \ldots, m_k$ æ˜¯ä¸¤ä¸¤äº’ç´ çš„æ­£æ•´æ•°ï¼Œ$M = m_1 m_2 \cdots m_k$ã€‚å¯¹äºä»»æ„æ•´æ•° $a_1, a_2, \ldots, a_k$ï¼ŒåŒä½™æ–¹ç¨‹ç»„ï¼š
$$x \equiv a_1 \pmod{m_1}$$
$$x \equiv a_2 \pmod{m_2}$$
$$\vdots$$
$$x \equiv a_k \pmod{m_k}$$
æœ‰å”¯ä¸€è§£æ¨¡ $M$ã€‚

**è¯æ˜æ€è·¯**:

1. æ„é€ è§£çš„å­˜åœ¨æ€§
2. è¯æ˜è§£çš„å”¯ä¸€æ€§

**è¯¦ç»†è¯æ˜**:

- **å­˜åœ¨æ€§è¯æ˜**:
  - å¯¹äºæ¯ä¸ª $i = 1, 2, \ldots, k$ï¼Œè®¾ $M_i = \frac{M}{m_i}$
  - ç”±äº $m_1, m_2, \ldots, m_k$ ä¸¤ä¸¤äº’ç´ ï¼Œ$\gcd(M_i, m_i) = 1$
  - ç”±è´ç¥–å®šç†ï¼Œå­˜åœ¨æ•´æ•° $y_i$ ä½¿å¾— $M_i y_i \equiv 1 \pmod{m_i}$
  - å®šä¹‰ $x = \sum_{i=1}^k a_i M_i y_i$
  - å¯¹äºæ¯ä¸ª $j$ï¼Œç”±äº $M_i \equiv 0 \pmod{m_j}$ï¼ˆå½“ $i \neq j$ æ—¶ï¼‰ï¼Œæœ‰ï¼š
    $$x \equiv a_j M_j y_j \equiv a_j \cdot 1 \equiv a_j \pmod{m_j}$$
  - å› æ­¤ $x$ æ˜¯æ–¹ç¨‹ç»„çš„ä¸€ä¸ªè§£
- **å”¯ä¸€æ€§è¯æ˜**:
  - å‡è®¾ $x$ å’Œ $x'$ éƒ½æ˜¯æ–¹ç¨‹ç»„çš„è§£
  - åˆ™ $x \equiv x' \pmod{m_i}$ å¯¹æ‰€æœ‰ $i$ æˆç«‹
  - ç”±äº $m_1, m_2, \ldots, m_k$ ä¸¤ä¸¤äº’ç´ ï¼Œ$x \equiv x' \pmod{M}$
  - å› æ­¤è§£åœ¨æ¨¡ $M$ æ„ä¹‰ä¸‹å”¯ä¸€

---

## 6.1.3 åŒä½™ç†è®º / Congruence Theory

### 6.1.3.1 åŒä½™çš„åŸºæœ¬æ¦‚å¿µ / Basic Concepts of Congruence

**å®šä¹‰ 6.1.3.1** (åŒä½™ / Congruence)
æ•´æ•° $a$ å’Œ $b$ æ¨¡ $m$ åŒä½™ï¼Œè®°ä½œ $a \equiv b \pmod{m}$ï¼Œå¦‚æœ $m \mid (a-b)$ã€‚

**å®šç† 6.1.3.2** (åŒä½™çš„æ€§è´¨ / Properties of Congruence)
å¯¹äºä»»æ„æ•´æ•° $a, b, c, d$ å’Œæ­£æ•´æ•° $m$ï¼š

1. **è‡ªåæ€§** / Reflexivity: $a \equiv a \pmod{m}$
2. **å¯¹ç§°æ€§** / Symmetry: $a \equiv b \pmod{m} \Rightarrow b \equiv a \pmod{m}$
3. **ä¼ é€’æ€§** / Transitivity: $a \equiv b \pmod{m}, b \equiv c \pmod{m} \Rightarrow a \equiv c \pmod{m}$
4. **åŠ æ³•ä¿æŒ** / Addition Preserves: $a \equiv b \pmod{m}, c \equiv d \pmod{m} \Rightarrow a+c \equiv b+d \pmod{m}$
5. **ä¹˜æ³•ä¿æŒ** / Multiplication Preserves: $a \equiv b \pmod{m}, c \equiv d \pmod{m} \Rightarrow ac \equiv bd \pmod{m}$

### 6.1.3.2 å‰©ä½™ç±» / Residue Classes

**å®šä¹‰ 6.1.3.3** (å‰©ä½™ç±» / Residue Class)
æ¨¡ $m$ çš„å‰©ä½™ç±» $[a]_m$ å®šä¹‰ä¸ºï¼š
$$[a]_m = \{b \in \mathbb{Z} : b \equiv a \pmod{m}\}$$

**å®šä¹‰ 6.1.3.4** (å®Œå…¨å‰©ä½™ç³» / Complete Residue System)
æ¨¡ $m$ çš„å®Œå…¨å‰©ä½™ç³»æ˜¯ $m$ ä¸ªä¸¤ä¸¤ä¸åŒä½™çš„æ•´æ•°ã€‚

**å®šç† 6.1.3.5** (å®Œå…¨å‰©ä½™ç³»çš„æ€§è´¨ / Properties of Complete Residue System)
$\{0, 1, 2, \ldots, m-1\}$ æ˜¯æ¨¡ $m$ çš„å®Œå…¨å‰©ä½™ç³»ã€‚

### 6.1.3.3 ç®€åŒ–å‰©ä½™ç³» / Reduced Residue System

**å®šä¹‰ 6.1.3.7** (æ¬§æ‹‰å‡½æ•° / Euler's Totient Function)
æ¬§æ‹‰å‡½æ•° $\phi(n)$ å®šä¹‰ä¸ºä¸ $n$ äº’ç´ çš„æ­£æ•´æ•°ä¸ªæ•°ã€‚

**å®šä¹‰ 6.1.3.8** (ç®€åŒ–å‰©ä½™ç³» / Reduced Residue System)
æ¨¡ $m$ çš„ç®€åŒ–å‰©ä½™ç³»æ˜¯ä¸ $m$ äº’ç´ çš„ $\phi(m)$ ä¸ªä¸¤ä¸¤ä¸åŒä½™çš„æ•´æ•°ã€‚

**å®šç† 6.1.3.9** (æ¬§æ‹‰å‡½æ•°çš„æ€§è´¨ / Properties of Euler's Function)
å¯¹äºç´ æ•° $p$ å’Œæ­£æ•´æ•° $k$ï¼š
$$\phi(p^k) = p^k - p^{k-1} = p^k(1 - \frac{1}{p})$$

**å®šç† 6.1.3.10** (æ¬§æ‹‰å‡½æ•°çš„ç§¯æ€§ / Multiplicativity of Euler's Function)
å¦‚æœ $\gcd(m,n) = 1$ï¼Œåˆ™ $\phi(mn) = \phi(m)\phi(n)$ã€‚

### 6.1.3.4 è´¹é©¬å°å®šç†ä¸æ¬§æ‹‰å®šç† / Fermat's Little Theorem and Euler's Theorem

**å®šç† 6.1.3.11** (è´¹é©¬å°å®šç† / Fermat's Little Theorem)
å¦‚æœ $p$ æ˜¯ç´ æ•°ä¸” $p \nmid a$ï¼Œåˆ™ï¼š
$$a^{p-1} \equiv 1 \pmod{p}$$

**è¯æ˜æ€è·¯**:

1. åˆ©ç”¨ç®€åŒ–å‰©ä½™ç³»çš„æ€§è´¨
2. è¯æ˜ä¹˜ç§¯çš„ç›¸ç­‰æ€§

**è¯¦ç»†è¯æ˜**:

- **æ­¥éª¤ 1**: æ„é€ ç®€åŒ–å‰©ä½™ç³»
  - è®¾ $S = \{1, 2, \ldots, p-1\}$ æ˜¯æ¨¡ $p$ çš„ç®€åŒ–å‰©ä½™ç³»ï¼ˆå› ä¸º $p$ æ˜¯ç´ æ•°ï¼‰
- **æ­¥éª¤ 2**: è¯æ˜ $\{a, 2a, \ldots, (p-1)a\}$ ä¹Ÿæ˜¯ç®€åŒ–å‰©ä½™ç³»
  - å¦‚æœ $ia \equiv ja \pmod{p}$ï¼Œåˆ™ $p \mid (i-j)a$
  - ç”±äº $p \nmid a$ï¼Œ$p \mid (i-j)$
  - ä½† $1 \leq i, j \leq p-1$ï¼Œæ‰€ä»¥ $i = j$
  - å› æ­¤ $\{a, 2a, \ldots, (p-1)a\}$ æ˜¯ $p-1$ ä¸ªä¸¤ä¸¤ä¸åŒä½™çš„æ•°
  - ç”±äºå®ƒä»¬éƒ½ä¸ $p$ äº’ç´ ï¼ˆå› ä¸º $p \nmid a$ï¼‰ï¼Œå®ƒä»¬æ„æˆç®€åŒ–å‰©ä½™ç³»
- **æ­¥éª¤ 3**: åˆ©ç”¨ä¹˜ç§¯çš„ç›¸ç­‰æ€§
  - $a \cdot 2a \cdots (p-1)a \equiv 1 \cdot 2 \cdots (p-1) \pmod{p}$
  - å³ $a^{p-1}(p-1)! \equiv (p-1)! \pmod{p}$
- **æ­¥éª¤ 4**: æ¶ˆå» $(p-1)!$
  - ç”±äº $\gcd((p-1)!, p) = 1$ï¼Œå¯ä»¥æ¶ˆå» $(p-1)!$
  - å› æ­¤ $a^{p-1} \equiv 1 \pmod{p}$

**å®šç† 6.1.3.12** (æ¬§æ‹‰å®šç† / Euler's Theorem)
å¦‚æœ $\gcd(a,m) = 1$ï¼Œåˆ™ï¼š
$$a^{\phi(m)} \equiv 1 \pmod{m}$$

**è¯æ˜æ€è·¯**:

1. åˆ©ç”¨ç®€åŒ–å‰©ä½™ç³»çš„æ€§è´¨
2. è¯æ˜ä¹˜ç§¯çš„ç›¸ç­‰æ€§

**è¯¦ç»†è¯æ˜**:

- **æ­¥éª¤ 1**: æ„é€ ç®€åŒ–å‰©ä½™ç³»
  - è®¾ $\{r_1, r_2, \ldots, r_{\phi(m)}\}$ æ˜¯æ¨¡ $m$ çš„ç®€åŒ–å‰©ä½™ç³»
- **æ­¥éª¤ 2**: è¯æ˜ $\{ar_1, ar_2, \ldots, ar_{\phi(m)}\}$ ä¹Ÿæ˜¯ç®€åŒ–å‰©ä½™ç³»
  - å¦‚æœ $ar_i \equiv ar_j \pmod{m}$ï¼Œåˆ™ $m \mid a(r_i - r_j)$
  - ç”±äº $\gcd(a, m) = 1$ï¼Œ$m \mid (r_i - r_j)$
  - ä½† $r_i$ å’Œ $r_j$ åœ¨ç®€åŒ–å‰©ä½™ç³»ä¸­ï¼Œæ‰€ä»¥ $r_i = r_j$
  - å› æ­¤ $\{ar_1, ar_2, \ldots, ar_{\phi(m)}\}$ æ˜¯ $\phi(m)$ ä¸ªä¸¤ä¸¤ä¸åŒä½™çš„æ•°
  - ç”±äºå®ƒä»¬éƒ½ä¸ $m$ äº’ç´ ï¼ˆå› ä¸º $\gcd(a, m) = 1$ï¼‰ï¼Œå®ƒä»¬æ„æˆç®€åŒ–å‰©ä½™ç³»
- **æ­¥éª¤ 3**: åˆ©ç”¨ä¹˜ç§¯çš„ç›¸ç­‰æ€§
  - $ar_1 \cdot ar_2 \cdots ar_{\phi(m)} \equiv r_1 \cdot r_2 \cdots r_{\phi(m)} \pmod{m}$
  - å³ $a^{\phi(m)} \prod_{i=1}^{\phi(m)} r_i \equiv \prod_{i=1}^{\phi(m)} r_i \pmod{m}$
- **æ­¥éª¤ 4**: æ¶ˆå»ä¹˜ç§¯
  - ç”±äº $\gcd(\prod_{i=1}^{\phi(m)} r_i, m) = 1$ï¼Œå¯ä»¥æ¶ˆå» $\prod_{i=1}^{\phi(m)} r_i$
  - å› æ­¤ $a^{\phi(m)} \equiv 1 \pmod{m}$

### 1å®ä¾‹è¡¨å¾ / Instance Representation

#### å®ä¾‹1: åŒä½™åŸºæœ¬è¿ç®— / Basic Congruence Operations

**æ¦‚å¿µ**: åŒä½™çš„å®šä¹‰å’Œè¿ç®—æ€§è´¨
**å®ä¾‹**:

- **åŸºæœ¬åŒä½™å…³ç³»**:
  - $17 \equiv 2 \pmod{5}$ï¼Œå› ä¸º $17-2=15$ï¼Œ$5 \mid 15$
  - $23 \equiv 3 \pmod{10}$ï¼Œå› ä¸º $23-3=20$ï¼Œ$10 \mid 20$
  - $31 \equiv 1 \pmod{6}$ï¼Œå› ä¸º $31-1=30$ï¼Œ$6 \mid 30$
- **åŒä½™è¿ç®—éªŒè¯**:
  - åŠ æ³•: å¦‚æœ $7 \equiv 2 \pmod{5}$ ä¸” $8 \equiv 3 \pmod{5}$ï¼Œåˆ™ $7+8=15 \equiv 2+3=5 \equiv 0 \pmod{5}$ âœ“
  - ä¹˜æ³•: å¦‚æœ $4 \equiv 9 \pmod{5}$ ä¸” $6 \equiv 1 \pmod{5}$ï¼Œåˆ™ $4 \times 6=24 \equiv 9 \times 1=9 \equiv 4 \pmod{5}$ âœ“

#### å®ä¾‹2: æ¨¡è¿ç®—å®é™…åº”ç”¨ / Practical Applications of Modular Arithmetic

**æ¦‚å¿µ**: æ¨¡è¿ç®—åœ¨ç°å®ç”Ÿæ´»ä¸­çš„åº”ç”¨
**å®ä¾‹**:

- **æ—¶é’Ÿç®—æœ¯** (12å°æ—¶åˆ¶):
  - $15$ ç‚¹ $\equiv 3$ ç‚¹ $\pmod{12}$
  - $25$ ç‚¹ $\equiv 1$ ç‚¹ $\pmod{12}$
- **æ˜ŸæœŸè®¡ç®—** (7å¤©å‘¨æœŸ):
  - ä»Šå¤©æ˜¯å‘¨ä¸€ï¼Œ100å¤©åæ˜¯å‘¨å‡ ï¼Ÿ
  - $100 \equiv 2 \pmod{7}$ï¼Œæ‰€ä»¥æ˜¯å‘¨ä¸‰
- **ISBNæ ¡éªŒ**:
  - ISBN-10: $0-7475-3269-9$
  - æ ¡éªŒå’Œ: $0+7+4+7+5+3+2+6+9 = 43 \equiv 9 \pmod{11}$ âœ“

#### å®ä¾‹3: è´¹é©¬å°å®šç†ä¸æ¬§æ‹‰å®šç†åº”ç”¨ / Applications of Fermat's Little Theorem and Euler's Theorem

**æ¦‚å¿µ**: è´¹é©¬å°å®šç†å’Œæ¬§æ‹‰å®šç†çš„è®¡ç®—åº”ç”¨
**å®ä¾‹**:

- **è´¹é©¬å°å®šç†éªŒè¯** (æ¨¡7):
  - $2^6 \equiv 64 \equiv 1 \pmod{7}$ âœ“
  - $3^6 \equiv 729 \equiv 1 \pmod{7}$ âœ“
  - $4^6 \equiv 4096 \equiv 1 \pmod{7}$ âœ“
- **æ¬§æ‹‰å®šç†åº”ç”¨** (æ¨¡10):
  - $\phi(10) = \phi(2) \times \phi(5) = 1 \times 4 = 4$
  - $7^4 \equiv 2401 \equiv 1 \pmod{10}$ âœ“
- **å¿«é€Ÿå¹‚è®¡ç®—**:
  - è®¡ç®— $3^{100} \pmod{7}$:
    - $3^6 \equiv 1 \pmod{7}$
    - $3^{100} = 3^{6 \times 16 + 4} \equiv 3^4 \equiv 81 \equiv 4 \pmod{7}$

#### å®ä¾‹4: å‰©ä½™ç±»ä¸ç®€åŒ–å‰©ä½™ç³» / Residue Classes and Reduced Residue Systems

**æ¦‚å¿µ**: å‰©ä½™ç±»çš„æ„é€ å’Œæ€§è´¨
**å®ä¾‹**:

- **æ¨¡5çš„å®Œå…¨å‰©ä½™ç³»**:
  - $\{0, 1, 2, 3, 4\}$ æˆ– $\{5, 6, 7, 8, 9\}$
- **æ¨¡5çš„ç®€åŒ–å‰©ä½™ç³»**:
  - $\{1, 2, 3, 4\}$ (ä¸5äº’ç´ çš„æ•°)
- **æ¬§æ‹‰å‡½æ•°è®¡ç®—**:
  - $\phi(1) = 1$
  - $\phi(2) = 1$ (åªæœ‰1ä¸2äº’ç´ )
  - $\phi(3) = 2$ (1,2ä¸3äº’ç´ )
  - $\phi(4) = 2$ (1,3ä¸4äº’ç´ )
  - $\phi(5) = 4$ (1,2,3,4ä¸5äº’ç´ )
  - $\phi(6) = 2$ (1,5ä¸6äº’ç´ )

---

**è¯æ˜** / Proof:

- è®¾ $\{r_1, r_2, \ldots, r_{\phi(m)}\}$ æ˜¯æ¨¡ $m$ çš„ç®€åŒ–å‰©ä½™ç³»
- åˆ™ $\{ar_1, ar_2, \ldots, ar_{\phi(m)}\}$ ä¹Ÿæ˜¯ç®€åŒ–å‰©ä½™ç³»
- å› æ­¤ $\prod_{i=1}^{\phi(m)} ar_i \equiv \prod_{i=1}^{\phi(m)} r_i \pmod{m}$
- å³ $a^{\phi(m)} \equiv 1 \pmod{m}$

---

## 6.1.4 äºŒæ¬¡å‰©ä½™ / Quadratic Residues

### 6.1.4.1 äºŒæ¬¡å‰©ä½™çš„å®šä¹‰ / Definition of Quadratic Residues

**å®šä¹‰ 6.1.4.1** (äºŒæ¬¡å‰©ä½™ / Quadratic Residue)
æ•´æ•° $a$ ç§°ä¸ºæ¨¡ $p$ çš„äºŒæ¬¡å‰©ä½™ï¼Œå¦‚æœå­˜åœ¨æ•´æ•° $x$ ä½¿å¾— $x^2 \equiv a \pmod{p}$ã€‚

**å®šä¹‰ 6.1.4.2** (äºŒæ¬¡éå‰©ä½™ / Quadratic Nonresidue)
æ•´æ•° $a$ ç§°ä¸ºæ¨¡ $p$ çš„äºŒæ¬¡éå‰©ä½™ï¼Œå¦‚æœ $a$ ä¸æ˜¯æ¨¡ $p$ çš„äºŒæ¬¡å‰©ä½™ã€‚

**å®šç† 6.1.4.3** (äºŒæ¬¡å‰©ä½™çš„æ€§è´¨ / Properties of Quadratic Residues)
å¯¹äºå¥‡ç´ æ•° $p$ï¼š

1. æ¨¡ $p$ çš„äºŒæ¬¡å‰©ä½™æœ‰ $\frac{p-1}{2}$ ä¸ª
2. æ¨¡ $p$ çš„äºŒæ¬¡éå‰©ä½™æœ‰ $\frac{p-1}{2}$ ä¸ª
3. å¦‚æœ $a$ æ˜¯äºŒæ¬¡å‰©ä½™ï¼Œåˆ™ $-a$ æ˜¯äºŒæ¬¡å‰©ä½™å½“ä¸”ä»…å½“ $p \equiv 1 \pmod{4}$

### 6.1.4.2 å‹’è®©å¾·ç¬¦å· / Legendre Symbol

**å®šä¹‰ 6.1.4.5** (å‹’è®©å¾·ç¬¦å· / Legendre Symbol)
å¯¹äºå¥‡ç´ æ•° $p$ å’Œæ•´æ•° $a$ï¼Œå‹’è®©å¾·ç¬¦å·å®šä¹‰ä¸ºï¼š
$$
\left(\frac{a}{p}\right) = \begin{cases}
1 & \text{if } a \text{ is a quadratic residue modulo } p \\
-1 & \text{if } a \text{ is a quadratic nonresidue modulo } p \\
0 & \text{if } p \mid a
\end{cases}
$$

**å®šç† 6.1.4.6** (å‹’è®©å¾·ç¬¦å·çš„æ€§è´¨ / Properties of Legendre Symbol)
å¯¹äºå¥‡ç´ æ•° $p$ å’Œæ•´æ•° $a, b$ï¼š

1. $\left(\frac{ab}{p}\right) = \left(\frac{a}{p}\right)\left(\frac{b}{p}\right)$
2. $\left(\frac{a^2}{p}\right) = 1$ å¦‚æœ $p \nmid a$
3. $\left(\frac{-1}{p}\right) = (-1)^{\frac{p-1}{2}}$

### 6.1.4.3 äºŒæ¬¡äº’åå¾‹ / Quadratic Reciprocity

**å®šç† 6.1.4.7** (äºŒæ¬¡äº’åå¾‹ / Quadratic Reciprocity Law)
å¯¹äºä¸åŒçš„å¥‡ç´ æ•° $p$ å’Œ $q$ï¼š
$$\left(\frac{p}{q}\right)\left(\frac{q}{p}\right) = (-1)^{\frac{p-1}{2} \cdot \frac{q-1}{2}}$$

**è¯æ˜æ€è·¯**:

1. åˆ©ç”¨é«˜æ–¯å¼•ç†
2. è®¡ç®—æ ¼ç‚¹ä¸ªæ•°
3. åº”ç”¨å¯¹ç§°æ€§

**è¯¦ç»†è¯æ˜**:

- **æ­¥éª¤ 1**: åº”ç”¨é«˜æ–¯å¼•ç†
  - ç”±é«˜æ–¯å¼•ç†ï¼Œ$\left(\frac{p}{q}\right) = (-1)^n$ï¼Œå…¶ä¸­ $n$ æ˜¯ $\{p, 2p, \ldots, \frac{q-1}{2}p\}$ ä¸­æ¨¡ $q$ å¤§äº $\frac{q}{2}$ çš„å…ƒç´ ä¸ªæ•°
  - ç±»ä¼¼åœ°ï¼Œ$\left(\frac{q}{p}\right) = (-1)^m$ï¼Œå…¶ä¸­ $m$ æ˜¯ $\{q, 2q, \ldots, \frac{p-1}{2}q\}$ ä¸­æ¨¡ $p$ å¤§äº $\frac{p}{2}$ çš„å…ƒç´ ä¸ªæ•°
- **æ­¥éª¤ 2**: è®¡ç®—æ ¼ç‚¹ä¸ªæ•°
  - è€ƒè™‘çŸ©å½¢ $R = \{(x, y) : 1 \leq x \leq \frac{p-1}{2}, 1 \leq y \leq \frac{q-1}{2}\}$
  - $n$ ç­‰äºæ»¡è¶³ $qp > 2kq$ çš„æ•´æ•°å¯¹ $(k, q)$ çš„ä¸ªæ•°ï¼Œå³æ»¡è¶³ $k < \frac{p}{2}$ çš„ä¸ªæ•°
  - ç±»ä¼¼åœ°ï¼Œ$m$ ç­‰äºæ»¡è¶³ $lp > 2lp$ çš„æ•´æ•°å¯¹ $(p, l)$ çš„ä¸ªæ•°
  - å®é™…ä¸Šï¼Œ$n$ æ˜¯æ»¡è¶³ $1 \leq k \leq \frac{q-1}{2}$ ä¸” $kp \bmod q > \frac{q}{2}$ çš„ $k$ çš„ä¸ªæ•°
  - $m$ æ˜¯æ»¡è¶³ $1 \leq l \leq \frac{p-1}{2}$ ä¸” $lq \bmod p > \frac{p}{2}$ çš„ $l$ çš„ä¸ªæ•°
- **æ­¥éª¤ 3**: åˆ©ç”¨å¯¹ç§°æ€§
  - é€šè¿‡å‡ ä½•è®ºè¯ï¼Œå¯ä»¥è¯æ˜ $n + m \equiv \frac{p-1}{2} \cdot \frac{q-1}{2} \pmod{2}$
  - å› æ­¤ $\left(\frac{p}{q}\right)\left(\frac{q}{p}\right) = (-1)^n(-1)^m = (-1)^{n+m} = (-1)^{\frac{p-1}{2} \cdot \frac{q-1}{2}}$

**å®šç† 6.1.4.8** (äºŒæ¬¡äº’åå¾‹çš„è¡¥å…… / Supplementary Laws)
$$\left(\frac{2}{p}\right) = (-1)^{\frac{p^2-1}{8}}$$

**å®šç† 6.1.4.9** (é«˜æ–¯å¼•ç† / Gauss's Lemma)
è®¾ $p$ æ˜¯å¥‡ç´ æ•°ï¼Œ$a$ æ˜¯ä¸ $p$ äº’ç´ çš„æ•´æ•°ã€‚è®¾ $S = \{1, 2, \ldots, \frac{p-1}{2}\}$ï¼Œ$T = \{a, 2a, \ldots, \frac{p-1}{2}a\}$ã€‚è®¾ $n$ æ˜¯ $T$ ä¸­æ¨¡ $p$ å¤§äº $\frac{p}{2}$ çš„å…ƒç´ ä¸ªæ•°ï¼Œåˆ™ï¼š
$$\left(\frac{a}{p}\right) = (-1)^n$$

---

## 6.1.5 åŸæ ¹ä¸æŒ‡æ ‡ / Primitive Roots and Indices

### 6.1.5.1 åŸæ ¹ / Primitive Roots

**å®šä¹‰ 6.1.5.1** (åŸæ ¹ / Primitive Root)
æ•´æ•° $g$ ç§°ä¸ºæ¨¡ $m$ çš„åŸæ ¹ï¼Œå¦‚æœ $g$ çš„é˜¶ç­‰äº $\phi(m)$ã€‚

**å®šä¹‰ 6.1.5.2** (é˜¶ / Order)
æ•´æ•° $a$ æ¨¡ $m$ çš„é˜¶æ˜¯æœ€å°çš„æ­£æ•´æ•° $k$ ä½¿å¾— $a^k \equiv 1 \pmod{m}$ã€‚

**å®šç† 6.1.5.3** (åŸæ ¹çš„å­˜åœ¨æ€§ / Existence of Primitive Roots)
æ¨¡ $m$ å­˜åœ¨åŸæ ¹å½“ä¸”ä»…å½“ $m = 2, 4, p^k, 2p^k$ï¼Œå…¶ä¸­ $p$ æ˜¯å¥‡ç´ æ•°ã€‚

**å®šç† 6.1.5.4** (åŸæ ¹çš„æ€§è´¨ / Properties of Primitive Roots)
å¦‚æœ $g$ æ˜¯æ¨¡ $p$ çš„åŸæ ¹ï¼Œåˆ™ï¼š

1. $g, g^2, \ldots, g^{p-1}$ æ˜¯æ¨¡ $p$ çš„å®Œå…¨å‰©ä½™ç³»
2. $g^{\frac{p-1}{2}} \equiv -1 \pmod{p}$

### 6.1.5.2 æŒ‡æ ‡ / Indices

**å®šä¹‰ 6.1.5.5** (æŒ‡æ ‡ / Index)
è®¾ $g$ æ˜¯æ¨¡ $m$ çš„åŸæ ¹ï¼Œæ•´æ•° $a$ çš„æŒ‡æ ‡ $\text{ind}_g(a)$ å®šä¹‰ä¸ºï¼š
$$g^{\text{ind}_g(a)} \equiv a \pmod{m}$$

**å®šç† 6.1.5.6** (æŒ‡æ ‡çš„æ€§è´¨ / Properties of Indices)
å¯¹äºåŸæ ¹ $g$ å’Œæ•´æ•° $a, b$ï¼š

### 2å®ä¾‹è¡¨å¾ / Instance Representation

#### å®ä¾‹1: äºŒæ¬¡å‰©ä½™è®¡ç®— / Quadratic Residue Calculation

**æ¦‚å¿µ**: äºŒæ¬¡å‰©ä½™çš„å®šä¹‰å’Œè®¡ç®—
**å®ä¾‹**:

- **æ¨¡5çš„äºŒæ¬¡å‰©ä½™**:
  - $0^2 \equiv 0 \pmod{5}$
  - $1^2 \equiv 1 \pmod{5}$
  - $2^2 \equiv 4 \pmod{5}$
  - $3^2 \equiv 9 \equiv 4 \pmod{5}$
  - $4^2 \equiv 16 \equiv 1 \pmod{5}$
  - äºŒæ¬¡å‰©ä½™: $0, 1, 4$
  - äºŒæ¬¡éå‰©ä½™: $2, 3$
- **æ¨¡7çš„äºŒæ¬¡å‰©ä½™**:
  - $0^2 \equiv 0 \pmod{7}$
  - $1^2 \equiv 1 \pmod{7}$
  - $2^2 \equiv 4 \pmod{7}$
  - $3^2 \equiv 9 \equiv 2 \pmod{7}$
  - $4^2 \equiv 16 \equiv 2 \pmod{7}$
  - $5^2 \equiv 25 \equiv 4 \pmod{7}$
  - $6^2 \equiv 36 \equiv 1 \pmod{7}$
  - äºŒæ¬¡å‰©ä½™: $0, 1, 2, 4$
  - äºŒæ¬¡éå‰©ä½™: $3, 5, 6$

#### å®ä¾‹2: å‹’è®©å¾·ç¬¦å·è®¡ç®— / Legendre Symbol Calculation

**æ¦‚å¿µ**: å‹’è®©å¾·ç¬¦å·çš„å®šä¹‰å’Œè®¡ç®—
**å®ä¾‹**:

- **æ¨¡5çš„å‹’è®©å¾·ç¬¦å·**:
  - $\left(\frac{1}{5}\right) = 1$ (1æ˜¯äºŒæ¬¡å‰©ä½™)
  - $\left(\frac{2}{5}\right) = -1$ (2æ˜¯äºŒæ¬¡éå‰©ä½™)
  - $\left(\frac{3}{5}\right) = -1$ (3æ˜¯äºŒæ¬¡éå‰©ä½™)
  - $\left(\frac{4}{5}\right) = 1$ (4æ˜¯äºŒæ¬¡å‰©ä½™)
- **å‹’è®©å¾·ç¬¦å·æ€§è´¨éªŒè¯**:
  - $\left(\frac{2 \times 3}{5}\right) = \left(\frac{6}{5}\right) = \left(\frac{1}{5}\right) = 1$
  - $\left(\frac{2}{5}\right) \times \left(\frac{3}{5}\right) = (-1) \times (-1) = 1$ âœ“

#### å®ä¾‹3: äºŒæ¬¡äº’åå¾‹åº”ç”¨ / Application of Quadratic Reciprocity

**æ¦‚å¿µ**: äºŒæ¬¡äº’åå¾‹çš„è®¡ç®—åº”ç”¨
**å®ä¾‹**:

- **è®¡ç®— $\left(\frac{3}{7}\right)$**:
  - äºŒæ¬¡äº’åå¾‹: $\left(\frac{3}{7}\right)\left(\frac{7}{3}\right) = (-1)^{\frac{3-1}{2} \times \frac{7-1}{2}} = (-1)^{1 \times 3} = -1$
  - $\left(\frac{7}{3}\right) = \left(\frac{1}{3}\right) = 1$
  - æ‰€ä»¥ $\left(\frac{3}{7}\right) = -1$
  - éªŒè¯: 3æ˜¯æ¨¡7çš„äºŒæ¬¡éå‰©ä½™ âœ“
- **è®¡ç®— $\left(\frac{2}{7}\right)$**:
  - è¡¥å……å¾‹: $\left(\frac{2}{7}\right) = (-1)^{\frac{7^2-1}{8}} = (-1)^{\frac{48}{8}} = (-1)^6 = 1$
  - éªŒè¯: 2æ˜¯æ¨¡7çš„äºŒæ¬¡å‰©ä½™ âœ“

#### å®ä¾‹4: åŸæ ¹ä¸æŒ‡æ ‡ / Primitive Roots and Indices

**æ¦‚å¿µ**: åŸæ ¹çš„å®šä¹‰å’ŒæŒ‡æ ‡çš„è®¡ç®—
**å®ä¾‹**:

- **æ¨¡5çš„åŸæ ¹**:
  - $\phi(5) = 4$
  - $2^1 \equiv 2 \pmod{5}$
  - $2^2 \equiv 4 \pmod{5}$
  - $2^3 \equiv 8 \equiv 3 \pmod{5}$
  - $2^4 \equiv 16 \equiv 1 \pmod{5}$
  - æ‰€ä»¥2æ˜¯æ¨¡5çš„åŸæ ¹
- **æ¨¡5çš„æŒ‡æ ‡**:
  - åŸæ ¹: $g = 2$
  - $\text{ind}_2(1) = 0$ (å› ä¸º $2^0 \equiv 1 \pmod{5}$)
  - $\text{ind}_2(2) = 1$ (å› ä¸º $2^1 \equiv 2 \pmod{5}$)
  - $\text{ind}_2(4) = 2$ (å› ä¸º $2^2 \equiv 4 \pmod{5}$)
  - $\text{ind}_2(3) = 3$ (å› ä¸º $2^3 \equiv 3 \pmod{5}$)
- **æŒ‡æ ‡æ€§è´¨éªŒè¯**:
  - $\text{ind}_2(2 \times 3) = \text{ind}_2(6) = \text{ind}_2(1) = 0$
  - $\text{ind}_2(2) + \text{ind}_2(3) = 1 + 3 = 4 \equiv 0 \pmod{4}$ âœ“

---

1. $\text{ind}_g(ab) \equiv \text{ind}_g(a) + \text{ind}_g(b) \pmod{\phi(m)}$
2. $\text{ind}_g(a^k) \equiv k \cdot \text{ind}_g(a) \pmod{\phi(m)}$

### 6.1.5.3 ç¦»æ•£å¯¹æ•° / Discrete Logarithm

**å®šä¹‰ 6.1.5.7** (ç¦»æ•£å¯¹æ•° / Discrete Logarithm)
åœ¨æ¨¡ $p$ ä¸‹ï¼Œ$a$ çš„ç¦»æ•£å¯¹æ•° $\log_g(a)$ æ˜¯æ»¡è¶³ $g^x \equiv a \pmod{p}$ çš„æ•´æ•° $x$ã€‚

**å®šç† 6.1.5.8** (ç¦»æ•£å¯¹æ•°çš„æ€§è´¨ / Properties of Discrete Logarithm)
å¯¹äºåŸæ ¹ $g$ å’Œæ•´æ•° $a, b$ï¼š

1. $\log_g(ab) \equiv \log_g(a) + \log_g(b) \pmod{p-1}$
2. $\log_g(a^k) \equiv k \cdot \log_g(a) \pmod{p-1}$

---

## 6.1.6 è¿åˆ†æ•° / Continued Fractions

### 6.1.6.1 ç®€å•è¿åˆ†æ•° / Simple Continued Fractions

**å®šä¹‰ 6.1.6.1** (ç®€å•è¿åˆ†æ•° / Simple Continued Fraction)
ç®€å•è¿åˆ†æ•°æ˜¯å½¢å¦‚ï¼š
$$[a_0; a_1, a_2, \ldots] = a_0 + \frac{1}{a_1 + \frac{1}{a_2 + \frac{1}{\ddots}}}$$
çš„è¡¨è¾¾å¼ã€‚

**å®šä¹‰ 6.1.6.2** (æ”¶æ•›å­ / Convergents)
è¿åˆ†æ•° $[a_0; a_1, a_2, \ldots]$ çš„ç¬¬ $n$ ä¸ªæ”¶æ•›å­æ˜¯ï¼š
$$\frac{p_n}{q_n} = [a_0; a_1, \ldots, a_n]$$

**å®šç† 6.1.6.3** (æ”¶æ•›å­çš„é€’æ¨å…¬å¼ / Recurrence for Convergents)
$$
\begin{cases}
p_n = a_n p_{n-1} + p_{n-2} \\
q_n = a_n q_{n-1} + q_{n-2}
\end{cases}
$$

å…¶ä¸­ $p_{-1} = 1, p_0 = a_0, q_{-1} = 0, q_0 = 1$ã€‚

### 6.1.6.2 è¿åˆ†æ•°çš„æ€§è´¨ / Properties of Continued Fractions

**å®šç† 6.1.6.4** (è¿åˆ†æ•°çš„åŸºæœ¬æ€§è´¨ / Basic Properties)
å¯¹äºè¿åˆ†æ•°çš„æ”¶æ•›å­ï¼š

1. $\gcd(p_n, q_n) = 1$
2. $p_n q_{n-1} - p_{n-1} q_n = (-1)^{n-1}$
3. $\left|\frac{p_n}{q_n} - \frac{p_{n-1}}{q_{n-1}}\right| = \frac{1}{q_n q_{n-1}}$

**å®šç† 6.1.6.5** (æœ€ä½³é€¼è¿‘ / Best Approximation)
å¦‚æœ $\frac{a}{b}$ æ˜¯å®æ•° $\alpha$ çš„æœ‰ç†é€¼è¿‘ï¼Œä¸” $b \leq q_n$ï¼Œåˆ™ï¼š
$$\left|\alpha - \frac{a}{b}\right| \geq \left|\alpha - \frac{p_n}{q_n}\right|$$

### 6.1.6.3 ä½©å°”æ–¹ç¨‹ / Pell's Equation

**å®šä¹‰ 6.1.6.7** (ä½©å°”æ–¹ç¨‹ / Pell's Equation)
ä½©å°”æ–¹ç¨‹æ˜¯å½¢å¦‚ $x^2 - dy^2 = 1$ çš„æ–¹ç¨‹ï¼Œå…¶ä¸­ $d$ æ˜¯éå¹³æ–¹æ­£æ•´æ•°ã€‚

**å®šç† 6.1.6.8** (ä½©å°”æ–¹ç¨‹çš„è§£ / Solution of Pell's Equation)
ä½©å°”æ–¹ç¨‹ $x^2 - dy^2 = 1$ æœ‰æ— ç©·å¤šç»„æ­£æ•´æ•°è§£ã€‚

**å®šç† 6.1.6.9** (ä½©å°”æ–¹ç¨‹çš„åŸºæœ¬è§£ / Fundamental Solution)
ä½©å°”æ–¹ç¨‹çš„åŸºæœ¬è§£ $(x_1, y_1)$ æ˜¯æ‰€æœ‰è§£ä¸­ $x + y\sqrt{d}$ æœ€å°çš„è§£ã€‚

---

## 6.1.7 ä¸¢ç•ªå›¾æ–¹ç¨‹ / Diophantine Equations

### 6.1.7.1 çº¿æ€§ä¸¢ç•ªå›¾æ–¹ç¨‹ / Linear Diophantine Equations

**å®šç† 6.1.7.1** (çº¿æ€§ä¸¢ç•ªå›¾æ–¹ç¨‹çš„è§£ / Solution of Linear Diophantine Equation)
æ–¹ç¨‹ $ax + by = c$ æœ‰æ•´æ•°è§£å½“ä¸”ä»…å½“ $\gcd(a,b) \mid c$ã€‚

**å®šç† 6.1.7.2** (çº¿æ€§ä¸¢ç•ªå›¾æ–¹ç¨‹çš„é€šè§£ / General Solution)
å¦‚æœ $(x_0, y_0)$ æ˜¯æ–¹ç¨‹ $ax + by = c$ çš„ä¸€ä¸ªç‰¹è§£ï¼Œåˆ™é€šè§£ä¸ºï¼š
$$x = x_0 + \frac{b}{\gcd(a,b)}t, \quad y = y_0 - \frac{a}{\gcd(a,b)}t$$

### 6.1.7.2 æ¯•è¾¾å“¥æ‹‰æ–¯ä¸‰å…ƒç»„ / Pythagorean Triples

**å®šä¹‰ 6.1.7.9** (æ¯•è¾¾å“¥æ‹‰æ–¯ä¸‰å…ƒç»„ / Pythagorean Triple)
æ¯•è¾¾å“¥æ‹‰æ–¯ä¸‰å…ƒç»„æ˜¯æ»¡è¶³ $x^2 + y^2 = z^2$ çš„æ­£æ•´æ•°ä¸‰å…ƒç»„ $(x, y, z)$ã€‚

**å®šç† 6.1.7.10** (æ¯•è¾¾å“¥æ‹‰æ–¯ä¸‰å…ƒç»„çš„å‚æ•°åŒ– / Parametrization)
æ‰€æœ‰æœ¬åŸæ¯•è¾¾å“¥æ‹‰æ–¯ä¸‰å…ƒç»„éƒ½å¯ä»¥è¡¨ç¤ºä¸ºï¼š
$$x = m^2 - n^2, \quad y = 2mn, \quad z = m^2 + n^2$$
å…¶ä¸­ $m > n > 0$ï¼Œ$\gcd(m,n) = 1$ï¼Œ$m$ å’Œ $n$ å¥‡å¶æ€§ä¸åŒã€‚

### 6.1.7.3 è´¹é©¬å¤§å®šç† / Fermat's Last Theorem

**å®šç† 6.1.7.11** (è´¹é©¬å¤§å®šç† / Fermat's Last Theorem)
å¯¹äº $n > 2$ï¼Œæ–¹ç¨‹ $x^n + y^n = z^n$ æ²¡æœ‰æ­£æ•´æ•°è§£ã€‚

**å†å²** / History:

- è´¹é©¬åœ¨1637å¹´æå‡º
- æ€€å°”æ–¯åœ¨1995å¹´è¯æ˜
- ä½¿ç”¨äº†æ¤­åœ†æ›²çº¿å’Œæ¨¡å½¢å¼ç†è®º

---

## 6.1.8 å½¢å¼åŒ–å®ç° / Formal Implementation

### 6.1.8.1 Lean 4 å®ç° / Lean 4 Implementation

```lean
-- æ•´é™¤
def Divides (a b : â„¤) : Prop := âˆƒ k : â„¤, b = a * k

-- æœ€å¤§å…¬çº¦æ•°
def gcd (a b : â„•) : â„• :=
  if b = 0 then a else gcd b (a % b)

-- æ¬§å‡ é‡Œå¾—ç®—æ³•
theorem bezout_identity (a b : â„¤) : âˆƒ x y : â„¤, a * x + b * y = gcd a b :=
  by
  -- ä½¿ç”¨æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•
  let âŸ¨d, x, yâŸ© := extended_gcd a b
  exact âŸ¨x, y, dâŸ©

-- åŒä½™
def Congruent (a b m : â„¤) : Prop := m âˆ£ (a - b)

-- æ¬§æ‹‰å‡½æ•°
def euler_phi (n : â„•) : â„• :=
  (finset.range n).filter (Î» x, gcd x n = 1).card

-- è´¹é©¬å°å®šç†
theorem fermat_little_theorem (p : â„•) (hp : Prime p) (a : â„¤) (ha : Â¬p âˆ£ a) :
  a^(p-1) â‰¡ 1 [MOD p] :=
  by
  -- ä½¿ç”¨ç¾¤è®ºæ–¹æ³•
  let G := units (zmod p)
  have hG : card G = p - 1 := card_units_zmod p
  have ha' : a â‰  0 := Î» h, ha (dvd_zero p)
  let a' := units.mk a ha'
  have : a'^(p-1) = 1 := pow_card_eq_one a'
  exact this

-- äºŒæ¬¡å‰©ä½™
def quadratic_residue (a p : â„•) : Prop :=
  âˆƒ x : â„•, x^2 â‰¡ a [MOD p]

-- å‹’è®©å¾·ç¬¦å·
def legendre_symbol (a p : â„¤) : â„¤ :=
  if p âˆ£ a then 0
  else if quadratic_residue a p then 1
  else -1

-- äºŒæ¬¡äº’åå¾‹
theorem quadratic_reciprocity (p q : â„•) (hp : Prime p) (hq : Prime q) (hpq : p â‰  q) :
  legendre_symbol p q * legendre_symbol q p = (-1)^((p-1)/2 * (q-1)/2) :=
  by
  -- ä½¿ç”¨é«˜æ–¯å’Œ
  sorry

-- åŸæ ¹
def primitive_root (g m : â„•) : Prop :=
  order g m = euler_phi m

-- åŸæ ¹å­˜åœ¨æ€§
theorem primitive_root_exists (m : â„•) :
  (âˆƒ g : â„•, primitive_root g m) â†”
  m = 2 âˆ¨ m = 4 âˆ¨ (âˆƒ p k : â„•, Prime p âˆ§ Odd p âˆ§ m = p^k) âˆ¨
  (âˆƒ p k : â„•, Prime p âˆ§ Odd p âˆ§ m = 2 * p^k) :=
  by
  -- åˆ†ç±»è®¨è®º
  sorry

-- è¿åˆ†æ•°
def continued_fraction (Î± : â„) : List â„¤ :=
  let aâ‚€ := floor Î±
  let Î±â‚ := 1 / (Î± - aâ‚€)
  aâ‚€ :: continued_fraction Î±â‚

-- ä½©å°”æ–¹ç¨‹
def pell_equation (d : â„•) (x y : â„•) : Prop :=
  x^2 - d * y^2 = 1

-- ä½©å°”æ–¹ç¨‹çš„åŸºæœ¬è§£
theorem pell_equation_fundamental_solution (d : â„•) (hd : Â¬is_square d) :
  âˆƒ x y : â„•, pell_equation d x y âˆ§
  âˆ€ x' y' : â„•, pell_equation d x' y' â†’ x + y * sqrt d â‰¤ x' + y' * sqrt d :=
  by
  -- ä½¿ç”¨è¿åˆ†æ•°
  sorry
```

### 6.1.8.2 Haskell å®ç° / Haskell Implementation

```haskell
-- æ•´é™¤
divides :: Integer -> Integer -> Bool
divides a b = b `mod` a == 0

-- æœ€å¤§å…¬çº¦æ•°
gcd :: Integer -> Integer -> Integer
gcd a 0 = abs a
gcd a b = gcd b (a `mod` b)

-- æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•
extendedGcd :: Integer -> Integer -> (Integer, Integer, Integer)
extendedGcd a 0 = (a, 1, 0)
extendedGcd a b = (d, y, x - (a `div` b) * y)
  where
    (d, x, y) = extendedGcd b (a `mod` b)

-- åŒä½™
congruent :: Integer -> Integer -> Integer -> Bool
congruent a b m = (a - b) `mod` m == 0

-- æ¬§æ‹‰å‡½æ•°
eulerPhi :: Integer -> Integer
eulerPhi n = length [x | x <- [1..n], gcd x n == 1]

-- è´¹é©¬å°å®šç†
fermatLittleTheorem :: Integer -> Integer -> Bool
fermatLittleTheorem p a =
  isPrime p && not (p `divides` a) ==>
  powerMod a (p-1) p == 1

-- äºŒæ¬¡å‰©ä½™
quadraticResidue :: Integer -> Integer -> Bool
quadraticResidue a p =
  any (\x -> (x^2 `mod` p) == (a `mod` p)) [1..p-1]

-- å‹’è®©å¾·ç¬¦å·
legendreSymbol :: Integer -> Integer -> Integer
legendreSymbol a p
  | p `divides` a = 0
  | quadraticResidue a p = 1
  | otherwise = -1

-- äºŒæ¬¡äº’åå¾‹
quadraticReciprocity :: Integer -> Integer -> Integer
quadraticReciprocity p q =
  legendreSymbol p q * legendreSymbol q p *
  (-1)^(((p-1) `div` 2) * ((q-1) `div` 2))

-- åŸæ ¹
primitiveRoot :: Integer -> Integer -> Bool
primitiveRoot g m = order g m == eulerPhi m

-- åŸæ ¹å­˜åœ¨æ€§
primitiveRootExists :: Integer -> Bool
primitiveRootExists m =
  m == 2 || m == 4 ||
  any (\p -> isPrime p && odd p && m == p^k) primes ||
  any (\p -> isPrime p && odd p && m == 2 * p^k) primes

-- è¿åˆ†æ•°
continuedFraction :: Double -> [Integer]
continuedFraction alpha =
  let a0 = floor alpha
      alpha1 = 1 / (alpha - fromIntegral a0)
  in a0 : continuedFraction alpha1

-- ä½©å°”æ–¹ç¨‹
pellEquation :: Integer -> Integer -> Integer -> Bool
pellEquation d x y = x^2 - d * y^2 == 1

-- ä½©å°”æ–¹ç¨‹çš„åŸºæœ¬è§£
pellFundamentalSolution :: Integer -> (Integer, Integer)
pellFundamentalSolution d =
  let convergents = continuedFractionConvergents (sqrt (fromIntegral d))
      solutions = [(x, y) | (x, y) <- convergents, pellEquation d x y]
  in minimumBy (\a b -> compare (fst a + snd a * sqrt d) (fst b + snd b * sqrt d)) solutions

-- å®šç†éªŒè¯
theorem_bezout_identity :: Integer -> Integer -> Bool
theorem_bezout_identity a b =
  let (d, x, y) = extendedGcd a b
  in a * x + b * y == d

theorem_fermat_little :: Integer -> Integer -> Bool
theorem_fermat_little p a =
  isPrime p && not (p `divides` a) ==>
  powerMod a (p-1) p == 1

theorem_quadratic_reciprocity :: Integer -> Integer -> Bool
theorem_quadratic_reciprocity p q =
  isPrime p && isPrime q && p /= q ==>
  legendreSymbol p q * legendreSymbol q p ==
  (-1)^(((p-1) `div` 2) * ((q-1) `div` 2))

-- å®ä¾‹ï¼šç´ æ•°
instance Prime Integer where
  isPrime n = n > 1 && all (\d -> n `mod` d /= 0) [2..floor (sqrt (fromIntegral n))]

-- å®ä¾‹ï¼šæ¬§æ‹‰å‡½æ•°
instance EulerPhi Integer where
  eulerPhi = eulerPhi

-- å®ä¾‹ï¼šå‹’è®©å¾·ç¬¦å·
instance LegendreSymbol Integer Integer where
  legendreSymbol = legendreSymbol
```

### 6.1.8.3 é‡è¦å®šç†æ€»ç»“ / Summary of Important Theorems

**å®šç† 6.1.8.1** (ç®—æœ¯åŸºæœ¬å®šç† / Fundamental Theorem of Arithmetic)
ä»»æ„å¤§äº $1$ çš„æ­£æ•´æ•°éƒ½å¯ä»¥å”¯ä¸€åœ°è¡¨ç¤ºä¸ºç´ æ•°çš„ä¹˜ç§¯ã€‚

**å®šç† 6.1.8.2** (è´¹é©¬å°å®šç† / Fermat's Little Theorem)
å¦‚æœ $p$ æ˜¯ç´ æ•°ä¸” $p \nmid a$ï¼Œåˆ™ $a^{p-1} \equiv 1 \pmod{p}$ã€‚

**å®šç† 6.1.8.3** (äºŒæ¬¡äº’åå¾‹ / Quadratic Reciprocity Law)
å¯¹äºä¸åŒçš„å¥‡ç´ æ•° $p$ å’Œ $q$ï¼š
$$\left(\frac{p}{q}\right)\left(\frac{q}{p}\right) = (-1)^{\frac{p-1}{2} \cdot \frac{q-1}{2}}$$

**å®šç† 6.1.8.4** (ä½©å°”æ–¹ç¨‹çš„è§£ / Solution of Pell's Equation)
ä½©å°”æ–¹ç¨‹ $x^2 - dy^2 = 1$ æœ‰æ— ç©·å¤šç»„æ­£æ•´æ•°è§£ã€‚

---

## å‚è€ƒæ–‡çŒ® / References

### ç»å…¸æ•™æ / Classic Textbooks

- Hardy, G. H., Wright, E. M. An Introduction to the Theory of Numbers[M]. 6th Edition. Oxford: Oxford University Press, 2008.
- Niven, I., Zuckerman, H. S., Montgomery, H. L. An Introduction to the Theory of Numbers[M]. 5th Edition. New York: Wiley, 1991.
- Ireland, K., Rosen, M. A Classical Introduction to Modern Number Theory[M]. 2nd Edition. New York: Springer-Verlag, 1990.
- Davenport, H. The Higher Arithmetic: An Introduction to the Theory of Numbers[M]. 8th Edition. Cambridge: Cambridge University Press, 2008.

### ç°ä»£æ•™æ / Modern Textbooks

- Rosen, K. H. Elementary Number Theory and Its Applications[M]. 6th Edition. Boston: Pearson, 2011.
- Silverman, J. H. A Friendly Introduction to Number Theory[M]. 4th Edition. Boston: Pearson, 2013.

### å†å²æ–‡çŒ® / Historical Literature

- Gauss, C. F. Disquisitiones Arithmeticae[M]. Leipzig: Fleischer, 1801. (English translation: Yale University Press, 1966)
- Fermat, P. Observations on Diophantus[M]. 1670. (Various modern editions available)

### åœ¨çº¿èµ„æº / Online Resources

- Wikipedia: [Number theory](https://en.wikipedia.org/wiki/Number_theory)
- Wikipedia: [Elementary number theory](https://en.wikipedia.org/wiki/Elementary_number_theory)
- MIT OpenCourseWare: [18.781 Theory of Numbers](https://ocw.mit.edu/courses/18-781-theory-of-numbers-spring-2012/)

---

**ç›¸å…³é“¾æ¥** / Related Links:

- [ä»£æ•°æ•°è®º](./02-ä»£æ•°æ•°è®º.md)
- [è§£ææ•°è®º](./03-è§£ææ•°è®º.md)
- [ç»„åˆæ•°è®º](./04-ç»„åˆæ•°è®º.md)
- [è®¡ç®—æ•°è®º](./05-è®¡ç®—æ•°è®º.md)

---

**äº¤äº’ä¸è¡¥å……èµ„æº / Interactive & Supplementary Resources**:

- [äº¤äº’å¼å›¾è¡¨å¢å¼ºï¼ˆç´ æ•°åˆ†å¸ƒ/æ¨¡è¿ç®—/äºŒæ¬¡å‰©ä½™å¯è§†åŒ–ï¼‰](../äº¤äº’å¼å›¾è¡¨å¢å¼º-2025å¹´1æœˆ.md)
- [å®šç†è¯æ˜è¡¥å……ï¼ˆç®—æœ¯åŸºæœ¬å®šç†/è´¹é©¬å°å®šç†/äºŒæ¬¡äº’åå¾‹ï¼‰](../å®šç†è¯æ˜è¡¥å……-2025å¹´1æœˆ.md)
- [åä¾‹ä¸ç‰¹æ®Šæƒ…å†µè¡¥å……ï¼ˆä¼ªç´ æ•°/éäºŒæ¬¡å‰©ä½™åä¾‹ï¼‰](../åä¾‹ä¸ç‰¹æ®Šæƒ…å†µè¡¥å……-2025å¹´1æœˆ.md)
- [å†å²èƒŒæ™¯è¡¥å……ï¼ˆæ•°è®ºå‘å±•å²ï¼‰](../å†å²èƒŒæ™¯è¡¥å……-2025å¹´1æœˆ.md)
