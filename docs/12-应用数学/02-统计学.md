# 统计学 / Statistics

## 目录 / Table of Contents

- [统计学 / Statistics](#统计学--statistics)
  - [目录 / Table of Contents](#目录--table-of-contents)
  - [1. 描述性统计 / Descriptive Statistics](#1-描述性统计--descriptive-statistics)
    - [1.1 集中趋势度量 / Measures of Central Tendency](#11-集中趋势度量--measures-of-central-tendency)
    - [实例表征 / Instance Representation](#实例表征--instance-representation)
      - [实例1: 描述性统计实例 / Descriptive Statistics Examples](#实例1-描述性统计实例--descriptive-statistics-examples)
      - [实例2: 假设检验实例 / Hypothesis Testing Examples](#实例2-假设检验实例--hypothesis-testing-examples)
      - [实例3: 回归分析实例 / Regression Analysis Examples](#实例3-回归分析实例--regression-analysis-examples)
      - [实例4: 方差分析实例 / Analysis of Variance Examples](#实例4-方差分析实例--analysis-of-variance-examples)
    - [1.2 离散程度度量 / Measures of Dispersion](#12-离散程度度量--measures-of-dispersion)
    - [1.3 分位数 / Quantiles](#13-分位数--quantiles)
    - [1.4 偏度与峰度 / Skewness and Kurtosis](#14-偏度与峰度--skewness-and-kurtosis)
  - [2. 推断统计 / Inferential Statistics](#2-推断统计--inferential-statistics)
    - [2.1 抽样分布 / Sampling Distributions](#21-抽样分布--sampling-distributions)
    - [2.2 点估计 / Point Estimation](#22-点估计--point-estimation)
    - [2.3 最大似然估计 / Maximum Likelihood Estimation](#23-最大似然估计--maximum-likelihood-estimation)
  - [3. 假设检验 / Hypothesis Testing](#3-假设检验--hypothesis-testing)
    - [3.1 基本概念 / Basic Concepts](#31-基本概念--basic-concepts)
    - [3.2 单样本检验 / One-Sample Tests](#32-单样本检验--one-sample-tests)
      - [3.2.1 单样本t检验 / One-Sample t-Test](#321-单样本t检验--one-sample-t-test)
      - [3.2.2 单样本比例检验 / One-Sample Proportion Test](#322-单样本比例检验--one-sample-proportion-test)
    - [3.3 双样本检验 / Two-Sample Tests](#33-双样本检验--two-sample-tests)
      - [3.3.1 独立样本t检验 / Independent Samples t-Test](#331-独立样本t检验--independent-samples-t-test)
      - [3.3.2 配对样本t检验 / Paired Samples t-Test](#332-配对样本t检验--paired-samples-t-test)
  - [4. 置信区间 / Confidence Intervals](#4-置信区间--confidence-intervals)
    - [4.1 总体均值置信区间 / Confidence Interval for Population Mean](#41-总体均值置信区间--confidence-interval-for-population-mean)
      - [4.1.1 正态分布，已知方差 / Normal Distribution, Known Variance](#411-正态分布已知方差--normal-distribution-known-variance)
      - [4.1.2 正态分布，未知方差 / Normal Distribution, Unknown Variance](#412-正态分布未知方差--normal-distribution-unknown-variance)
    - [4.2 总体比例置信区间 / Confidence Interval for Population Proportion](#42-总体比例置信区间--confidence-interval-for-population-proportion)
    - [4.3 总体方差置信区间 / Confidence Interval for Population Variance](#43-总体方差置信区间--confidence-interval-for-population-variance)
  - [5. 回归分析 / Regression Analysis](#5-回归分析--regression-analysis)
    - [5.1 简单线性回归 / Simple Linear Regression](#51-简单线性回归--simple-linear-regression)
    - [5.2 多元线性回归 / Multiple Linear Regression](#52-多元线性回归--multiple-linear-regression)
    - [5.3 回归诊断 / Regression Diagnostics](#53-回归诊断--regression-diagnostics)
  - [6. 方差分析 / Analysis of Variance](#6-方差分析--analysis-of-variance)
    - [6.1 单因素方差分析 / One-Way ANOVA](#61-单因素方差分析--one-way-anova)
    - [6.2 双因素方差分析 / Two-Way ANOVA](#62-双因素方差分析--two-way-anova)
  - [7. 非参数统计 / Nonparametric Statistics](#7-非参数统计--nonparametric-statistics)
    - [7.1 符号检验 / Sign Test](#71-符号检验--sign-test)
    - [7.2 Wilcoxon符号秩检验 / Wilcoxon Signed-Rank Test](#72-wilcoxon符号秩检验--wilcoxon-signed-rank-test)
    - [7.3 Mann-Whitney U检验 / Mann-Whitney U Test](#73-mann-whitney-u检验--mann-whitney-u-test)
    - [7.4 Kruskal-Wallis检验 / Kruskal-Wallis Test](#74-kruskal-wallis检验--kruskal-wallis-test)
  - [8. 贝叶斯统计 / Bayesian Statistics](#8-贝叶斯统计--bayesian-statistics)
    - [8.1 贝叶斯定理 / Bayes' Theorem](#81-贝叶斯定理--bayes-theorem)
    - [8.2 共轭先验 / Conjugate Priors](#82-共轭先验--conjugate-priors)
    - [8.3 贝叶斯估计 / Bayesian Estimation](#83-贝叶斯估计--bayesian-estimation)
  - [9. 形式化实现 / Formal Implementation](#9-形式化实现--formal-implementation)
    - [9.1 Lean 4 实现](#91-lean-4-实现)
    - [9.2 Haskell 实现](#92-haskell-实现)
    - [9.3 Rust 实现](#93-rust-实现)
  - [总结 / Summary](#总结--summary)
    - [关键要点 / Key Points](#关键要点--key-points)
    - [知识关联 / Knowledge Connections](#知识关联--knowledge-connections)
    - [进一步学习 / Further Learning](#进一步学习--further-learning)
  - [交互与补充资源 / Interactive \& Supplementary Resources](#交互与补充资源--interactive--supplementary-resources)
    - [交互式图表增强](#交互式图表增强)
    - [定理证明补充](#定理证明补充)
    - [反例与特殊情况补充](#反例与特殊情况补充)
    - [历史背景补充](#历史背景补充)
  - [12.8 应用案例 / Application Cases](#128-应用案例--application-cases)
    - [12.8.1 商业数据分析 / Business Data Analysis](#1281-商业数据分析--business-data-analysis)
      - [市场调研 / Market Research](#市场调研--market-research)
      - [客户满意度分析 / Customer Satisfaction Analysis](#客户满意度分析--customer-satisfaction-analysis)
    - [12.8.2 医学研究与临床试验 / Medical Research and Clinical Trials](#1282-医学研究与临床试验--medical-research-and-clinical-trials)
      - [药物疗效评估 / Drug Efficacy Evaluation](#药物疗效评估--drug-efficacy-evaluation)
      - [流行病学研究 / Epidemiological Studies](#流行病学研究--epidemiological-studies)
    - [12.8.3 工业质量控制 / Industrial Quality Control](#1283-工业质量控制--industrial-quality-control)
      - [制造过程监控 / Manufacturing Process Monitoring](#制造过程监控--manufacturing-process-monitoring)
      - [六西格玛改进 / Six Sigma Improvement](#六西格玛改进--six-sigma-improvement)
    - [12.8.4 环境监测与评估 / Environmental Monitoring and Assessment](#1284-环境监测与评估--environmental-monitoring-and-assessment)
      - [空气质量监测 / Air Quality Monitoring](#空气质量监测--air-quality-monitoring)
      - [生态系统评估 / Ecosystem Assessment](#生态系统评估--ecosystem-assessment)
    - [12.8.5 金融风险管理 / Financial Risk Management](#1285-金融风险管理--financial-risk-management)
      - [投资组合分析 / Portfolio Analysis](#投资组合分析--portfolio-analysis)
      - [信用风险评估 / Credit Risk Assessment](#信用风险评估--credit-risk-assessment)

---

## 1. 描述性统计 / Descriptive Statistics

### 1.1 集中趋势度量 / Measures of Central Tendency

**定义 1.1.1** (算术平均数 / Arithmetic Mean)
对于数据集 $x_1, x_2, \ldots, x_n$，算术平均数定义为：
$$\bar{x} = \frac{1}{n}\sum_{i=1}^{n} x_i$$

**定义 1.1.2** (中位数 / Median)
中位数是将数据集按大小排序后位于中间位置的数值：
$$
\text{Median} = \begin{cases}
x_{(n+1)/2}, & \text{if } n \text{ is odd} \\
\frac{x_{n/2} + x_{n/2+1}}{2}, & \text{if } n \text{ is even}
\end{cases}
$$

**定义 1.1.3** (众数 / Mode)
众数是数据集中出现频率最高的数值。

### 实例表征 / Instance Representation

#### 实例1: 描述性统计实例 / Descriptive Statistics Examples

**概念**: 集中趋势度量和离散程度度量的计算和应用
**实例**:

- **算术平均数计算**:
  - 数据集：[85, 92, 78, 96, 88, 90, 82, 95]
  - 计算：$\bar{x} = \frac{85+92+78+96+88+90+82+95}{8} = 88.25$
  - 应用：学生成绩的平均分分析
- **中位数计算**:
  - 数据集：[85, 92, 78, 96, 88, 90, 82, 95]
  - 排序后：[78, 82, 85, 88, 90, 92, 95, 96]
  - 中位数：$\frac{88+90}{2} = 89$
  - 应用：不受极端值影响的中心趋势度量
- **方差和标准差**:
  - 数据集：[85, 92, 78, 96, 88, 90, 82, 95]
  - 方差：$s^2 = \frac{\sum(x_i - 88.25)^2}{7} = 35.93$
  - 标准差：$s = \sqrt{35.93} = 5.99$
  - 应用：数据离散程度的量化分析

#### 实例2: 假设检验实例 / Hypothesis Testing Examples

**概念**: 假设检验的基本流程和常见检验方法
**实例**:

- **单样本t检验**:
  - 问题：某班级平均成绩是否显著高于80分？
  - 数据：样本均值85分，样本标准差8分，样本量25
  - 检验统计量：$t = \frac{85-80}{8/\sqrt{25}} = 3.125$
  - 临界值：$t_{0.05,24} = 1.711$
  - 结论：拒绝原假设，平均成绩显著高于80分
- **双样本t检验**:
  - 问题：两个班级的平均成绩是否有显著差异？
  - 数据：班级A（均值82，标准差6，样本量20），班级B（均值88，标准差7，样本量22）
  - 检验统计量：$t = \frac{82-88}{\sqrt{\frac{6^2}{20}+\frac{7^2}{22}}} = -2.89$
  - 结论：两个班级成绩有显著差异
- **比例检验**:
  - 问题：某产品合格率是否达到95%？
  - 数据：100个产品中92个合格
  - 检验统计量：$z = \frac{0.92-0.95}{\sqrt{\frac{0.95(1-0.95)}{100}}} = -1.38$
  - 结论：不能拒绝原假设，合格率可能达到95%

#### 实例3: 回归分析实例 / Regression Analysis Examples

**概念**: 线性回归模型的建立、估计和诊断
**实例**:

- **简单线性回归**:
  - 问题：研究学习时间与考试成绩的关系
  - 数据：学习时间（小时）[2, 4, 6, 8, 10]，成绩（分）[65, 75, 85, 90, 95]
  - 回归方程：$\hat{y} = 60 + 3.5x$
  - 决定系数：$R^2 = 0.98$
  - 解释：学习时间每增加1小时，成绩平均提高3.5分
- **多元线性回归**:
  - 问题：预测房价（考虑面积、年龄、位置）
  - 模型：$Price = \beta_0 + \beta_1 Area + \beta_2 Age + \beta_3 Location + \epsilon$
  - 估计结果：$Price = 50 + 0.8 Area - 2 Age + 15 Location$
  - 应用：房价预测和影响因素分析
- **回归诊断**:
  - 残差分析：检查残差的正态性、独立性、同方差性
  - 影响分析：识别异常值和强影响点
  - 多重共线性：检查自变量间的相关性

#### 实例4: 方差分析实例 / Analysis of Variance Examples

**概念**: 方差分析的基本原理和应用
**实例**:

- **单因素方差分析**:
  - 问题：三种教学方法的效果是否有显著差异？
  - 数据：方法A（均值75，样本量15），方法B（均值82，样本量15），方法C（均值78，样本量15）
  - F统计量：$F = \frac{MSB}{MSW} = 4.25$
  - 临界值：$F_{0.05,2,42} = 3.22$
  - 结论：三种教学方法效果有显著差异
- **双因素方差分析**:
  - 问题：性别和年龄对收入的影响
  - 因素A：性别（男、女）
  - 因素B：年龄组（青年、中年、老年）
  - 主效应：性别和年龄对收入都有显著影响
  - 交互效应：性别和年龄存在交互作用
- **事后检验**:
  - Tukey HSD检验：比较各组间的差异
  - 置信区间：提供差异的置信区间估计

---

### 1.2 离散程度度量 / Measures of Dispersion

**定义 1.2.1** (方差 / Variance)
样本方差定义为：
$$s^2 = \frac{1}{n-1}\sum_{i=1}^{n} (x_i - \bar{x})^2$$

**定义 1.2.2** (标准差 / Standard Deviation)
样本标准差定义为：
$$s = \sqrt{s^2} = \sqrt{\frac{1}{n-1}\sum_{i=1}^{n} (x_i - \bar{x})^2}$$

**定义 1.2.3** (变异系数 / Coefficient of Variation)
变异系数定义为：
$$\text{CV} = \frac{s}{\bar{x}} \times 100\%$$

### 1.3 分位数 / Quantiles

**定义 1.3.1** (分位数 / Quantile)
对于 $0 < p < 1$，$p$ 分位数 $Q_p$ 满足：
$$P(X \leq Q_p) = p$$

**特殊分位数**:

- 四分位数：$Q_1$ (25%)，$Q_2$ (50%)，$Q_3$ (75%)
- 十分位数：$D_1, D_2, \ldots, D_9$
- 百分位数：$P_1, P_2, \ldots, P_{99}$

### 1.4 偏度与峰度 / Skewness and Kurtosis

**定义 1.4.1** (偏度 / Skewness)
偏度定义为：
$$\text{Skewness} = \frac{1}{n}\sum_{i=1}^{n} \left(\frac{x_i - \bar{x}}{s}\right)^3$$

**定义 1.4.2** (峰度 / Kurtosis)
峰度定义为：
$$\text{Kurtosis} = \frac{1}{n}\sum_{i=1}^{n} \left(\frac{x_i - \bar{x}}{s}\right)^4 - 3$$

## 2. 推断统计 / Inferential Statistics

### 2.1 抽样分布 / Sampling Distributions

**定义 2.1.1** (样本均值分布 / Distribution of Sample Mean)
设 $X_1, X_2, \ldots, X_n$ 是来自总体 $X$ 的随机样本，则样本均值 $\bar{X}$ 的分布为：
$$\bar{X} \sim \text{Normal}\left(\mu, \frac{\sigma^2}{n}\right)$$

**定义 2.1.2** (t分布 / t-Distribution)
如果 $Z \sim \text{Normal}(0,1)$ 和 $V \sim \chi^2(\nu)$ 独立，则：
$$T = \frac{Z}{\sqrt{V/\nu}} \sim t(\nu)$$

**定义 2.1.3** (卡方分布 / Chi-Square Distribution)
如果 $Z_1, Z_2, \ldots, Z_\nu$ 是独立的标准正态随机变量，则：
$$\sum_{i=1}^{\nu} Z_i^2 \sim \chi^2(\nu)$$

### 2.2 点估计 / Point Estimation

**定义 2.2.1** (无偏估计 / Unbiased Estimator)
估计量 $\hat{\theta}$ 称为参数 $\theta$ 的无偏估计，如果：
$$E[\hat{\theta}] = \theta$$

**定义 2.2.2** (有效估计 / Efficient Estimator)
在所有无偏估计中，方差最小的估计称为有效估计。

**定义 2.2.3** (一致估计 / Consistent Estimator)
估计量 $\hat{\theta}_n$ 称为一致估计，如果：
$$\hat{\theta}_n \xrightarrow{P} \theta$$

### 2.3 最大似然估计 / Maximum Likelihood Estimation

**定义 2.3.1** (似然函数 / Likelihood Function)
对于参数 $\theta$ 和观测值 $x_1, x_2, \ldots, x_n$，似然函数定义为：
$$L(\theta) = \prod_{i=1}^{n} f(x_i; \theta)$$

**定义 2.3.2** (最大似然估计 / Maximum Likelihood Estimator)
最大似然估计 $\hat{\theta}$ 是使似然函数最大的参数值：
$$\hat{\theta} = \arg\max_{\theta} L(\theta)$$

## 3. 假设检验 / Hypothesis Testing

### 3.1 基本概念 / Basic Concepts

**定义 3.1.1** (原假设与备择假设 / Null and Alternative Hypotheses)

- 原假设 $H_0$：要检验的假设
- 备择假设 $H_1$：与原假设对立的假设

**定义 3.1.2** (显著性水平 / Significance Level)
显著性水平 $\alpha$ 是第一类错误的概率：
$$\alpha = P(\text{拒绝 } H_0 | H_0 \text{ 为真})$$

**定义 3.1.3** (p值 / p-Value)
p值是观测到比当前样本更极端结果的概率。

### 3.2 单样本检验 / One-Sample Tests

#### 3.2.1 单样本t检验 / One-Sample t-Test

**检验统计量**:
$$t = \frac{\bar{x} - \mu_0}{s/\sqrt{n}}$$

**决策规则**:

- 如果 $|t| > t_{\alpha/2, n-1}$，拒绝 $H_0$
- 如果 $|t| \leq t_{\alpha/2, n-1}$，接受 $H_0$

#### 3.2.2 单样本比例检验 / One-Sample Proportion Test

**检验统计量**:
$$z = \frac{\hat{p} - p_0}{\sqrt{p_0(1-p_0)/n}}$$

**决策规则**:

- 如果 $|z| > z_{\alpha/2}$，拒绝 $H_0$
- 如果 $|z| \leq z_{\alpha/2}$，接受 $H_0$

### 3.3 双样本检验 / Two-Sample Tests

#### 3.3.1 独立样本t检验 / Independent Samples t-Test

**检验统计量**:
$$t = \frac{\bar{x}_1 - \bar{x}_2}{\sqrt{s_p^2\left(\frac{1}{n_1} + \frac{1}{n_2}\right)}}$$

其中 $s_p^2$ 是合并方差：
$$s_p^2 = \frac{(n_1-1)s_1^2 + (n_2-1)s_2^2}{n_1 + n_2 - 2}$$

#### 3.3.2 配对样本t检验 / Paired Samples t-Test

**检验统计量**:
$$t = \frac{\bar{d}}{s_d/\sqrt{n}}$$

其中 $d_i = x_{1i} - x_{2i}$，$\bar{d}$ 是差值的均值，$s_d$ 是差值的标准差。

## 4. 置信区间 / Confidence Intervals

### 4.1 总体均值置信区间 / Confidence Interval for Population Mean

#### 4.1.1 正态分布，已知方差 / Normal Distribution, Known Variance

**置信区间**:
$$\bar{x} \pm z_{\alpha/2}\frac{\sigma}{\sqrt{n}}$$

#### 4.1.2 正态分布，未知方差 / Normal Distribution, Unknown Variance

**置信区间**:
$$\bar{x} \pm t_{\alpha/2, n-1}\frac{s}{\sqrt{n}}$$

### 4.2 总体比例置信区间 / Confidence Interval for Population Proportion

**置信区间**:
$$\hat{p} \pm z_{\alpha/2}\sqrt{\frac{\hat{p}(1-\hat{p})}{n}}$$

### 4.3 总体方差置信区间 / Confidence Interval for Population Variance

**置信区间**:
$$\left[\frac{(n-1)s^2}{\chi^2_{\alpha/2, n-1}}, \frac{(n-1)s^2}{\chi^2_{1-\alpha/2, n-1}}\right]$$

## 5. 回归分析 / Regression Analysis

### 5.1 简单线性回归 / Simple Linear Regression

**模型**:
$$Y = \beta_0 + \beta_1 X + \epsilon$$

其中 $\epsilon \sim \text{Normal}(0, \sigma^2)$。

**最小二乘估计**:
$$\hat{\beta}_1 = \frac{\sum_{i=1}^{n} (x_i - \bar{x})(y_i - \bar{y})}{\sum_{i=1}^{n} (x_i - \bar{x})^2}$$
$$\hat{\beta}_0 = \bar{y} - \hat{\beta}_1\bar{x}$$

**决定系数**:
$$R^2 = \frac{\text{SSR}}{\text{SST}} = 1 - \frac{\text{SSE}}{\text{SST}}$$

其中：

- $\text{SST} = \sum_{i=1}^{n} (y_i - \bar{y})^2$ (总平方和)
- $\text{SSR} = \sum_{i=1}^{n} (\hat{y}_i - \bar{y})^2$ (回归平方和)
- $\text{SSE} = \sum_{i=1}^{n} (y_i - \hat{y}_i)^2$ (残差平方和)

### 5.2 多元线性回归 / Multiple Linear Regression

**模型**:
$$Y = \beta_0 + \beta_1 X_1 + \beta_2 X_2 + \cdots + \beta_p X_p + \epsilon$$

**矩阵形式**:
$$\mathbf{Y} = \mathbf{X}\boldsymbol{\beta} + \boldsymbol{\epsilon}$$

**最小二乘估计**:
$$\hat{\boldsymbol{\beta}} = (\mathbf{X}^T\mathbf{X})^{-1}\mathbf{X}^T\mathbf{Y}$$

### 5.3 回归诊断 / Regression Diagnostics

**残差分析**:

- 正态性检验
- 独立性检验
- 同方差性检验
- 线性性检验

**影响分析**:

- 杠杆值 (Leverage)
- 库克距离 (Cook's Distance)
- DFFITS

## 6. 方差分析 / Analysis of Variance

### 6.1 单因素方差分析 / One-Way ANOVA

**模型**:
$$Y_{ij} = \mu + \tau_i + \epsilon_{ij}$$

其中：

- $\mu$ 是总体均值
- $\tau_i$ 是第 $i$ 个处理的效应
- $\epsilon_{ij} \sim \text{Normal}(0, \sigma^2)$

**检验统计量**:
$$F = \frac{\text{MSB}}{\text{MSW}}$$

其中：

- $\text{MSB} = \frac{\text{SSB}}{k-1}$ (组间均方)
- $\text{MSW} = \frac{\text{SSW}}{N-k}$ (组内均方)

### 6.2 双因素方差分析 / Two-Way ANOVA

**模型**:
$$Y_{ijk} = \mu + \alpha_i + \beta_j + (\alpha\beta)_{ij} + \epsilon_{ijk}$$

**主效应检验**:

- 因素A的主效应：$F_A = \frac{\text{MSA}}{\text{MSE}}$
- 因素B的主效应：$F_B = \frac{\text{MSB}}{\text{MSE}}$

**交互效应检验**:

- 交互效应：$F_{AB} = \frac{\text{MSAB}}{\text{MSE}}$

## 7. 非参数统计 / Nonparametric Statistics

### 7.1 符号检验 / Sign Test

**检验统计量**:
$$S = \text{正符号的个数}$$

**决策规则**:

- 如果 $S \geq s_{\alpha/2}$ 或 $S \leq n - s_{\alpha/2}$，拒绝 $H_0$

### 7.2 Wilcoxon符号秩检验 / Wilcoxon Signed-Rank Test

**检验统计量**:
$$W = \sum_{i=1}^{n} \text{sgn}(d_i) R_i$$

其中 $R_i$ 是 $|d_i|$ 的秩。

### 7.3 Mann-Whitney U检验 / Mann-Whitney U Test

**检验统计量**:
$$U = n_1n_2 + \frac{n_1(n_1+1)}{2} - R_1$$

其中 $R_1$ 是第一个样本的秩和。

### 7.4 Kruskal-Wallis检验 / Kruskal-Wallis Test

**检验统计量**:
$$H = \frac{12}{N(N+1)}\sum_{i=1}^{k} \frac{R_i^2}{n_i} - 3(N+1)$$

其中 $R_i$ 是第 $i$ 组的秩和。

## 8. 贝叶斯统计 / Bayesian Statistics

### 8.1 贝叶斯定理 / Bayes' Theorem

**贝叶斯定理**:
$$P(\theta|X) = \frac{P(X|\theta)P(\theta)}{P(X)}$$

其中：

- $P(\theta)$ 是先验分布
- $P(X|\theta)$ 是似然函数
- $P(\theta|X)$ 是后验分布

### 8.2 共轭先验 / Conjugate Priors

**常见共轭先验**:

- 正态分布：正态先验
- 二项分布：Beta先验
- 泊松分布：Gamma先验
- 指数分布：Gamma先验

### 8.3 贝叶斯估计 / Bayesian Estimation

**后验均值**:
$$E[\theta|X] = \int \theta P(\theta|X) d\theta$$

**后验方差**:
$$\text{Var}[\theta|X] = E[(\theta - E[\theta|X])^2|X]$$

## 9. 形式化实现 / Formal Implementation

### 9.1 Lean 4 实现

```lean
-- 描述性统计
def mean (data : List ℝ) : ℝ :=
  sum data / length data

def variance (data : List ℝ) : ℝ :=
  let μ := mean data
  sum (map (λ x, (x - μ)^2) data) / (length data - 1)

def standard_deviation (data : List ℝ) : ℝ :=
  sqrt (variance data)

-- 假设检验
structure HypothesisTest where
  null_hypothesis : Prop
  alternative_hypothesis : Prop
  test_statistic : ℝ
  critical_value : ℝ
  p_value : ℝ

def t_test (data : List ℝ) (μ₀ : ℝ) : HypothesisTest :=
  let n := length data
  let x̄ := mean data
  let s := standard_deviation data
  let t := (x̄ - μ₀) / (s / sqrt n)
  let p_value := 2 * (1 - t_distribution_cdf t (n-1))
  {
    null_hypothesis := x̄ = μ₀,
    alternative_hypothesis := x̄ ≠ μ₀,
    test_statistic := t,
    critical_value := t_critical_value 0.05 (n-1),
    p_value := p_value
  }

-- 回归分析
structure LinearRegression where
  slope : ℝ
  intercept : ℝ
  r_squared : ℝ
  residuals : List ℝ

def simple_linear_regression (x y : List ℝ) : LinearRegression :=
  let n := length x
  let x̄ := mean x
  let ȳ := mean y
  let slope := sum (zip_with (λ xi yi, (xi - x̄) * (yi - ȳ)) x y) /
               sum (map (λ xi, (xi - x̄)^2) x)
  let intercept := ȳ - slope * x̄
  let predicted := map (λ xi, intercept + slope * xi) x
  let residuals := zip_with (λ yi ŷi, yi - ŷi) y predicted
  let r_squared := 1 - (sum (map (λ ri, ri^2) residuals)) /
                   (sum (map (λ yi, (yi - ȳ)^2) y))
  {
    slope := slope,
    intercept := intercept,
    r_squared := r_squared,
    residuals := residuals
  }
```

### 9.2 Haskell 实现

```haskell
-- 描述性统计
mean :: [Double] -> Double
mean xs = sum xs / fromIntegral (length xs)

variance :: [Double] -> Double
variance xs =
  let μ = mean xs
      n = fromIntegral (length xs)
  in sum (map (\x -> (x - μ)^2) xs) / (n - 1)

standardDeviation :: [Double] -> Double
standardDeviation = sqrt . variance

-- 假设检验
data HypothesisTest = HypothesisTest
  { nullHypothesis :: String
  , alternativeHypothesis :: String
  , testStatistic :: Double
  , criticalValue :: Double
  , pValue :: Double
  }

tTest :: [Double] -> Double -> HypothesisTest
tTest data μ₀ =
  let n = fromIntegral (length data)
      x̄ = mean data
      s = standardDeviation data
      t = (x̄ - μ₀) / (s / sqrt n)
      pValue = 2 * (1 - tDistributionCDF t (n-1))
  in HypothesisTest
    { nullHypothesis = "μ = " ++ show μ₀
    , alternativeHypothesis = "μ ≠ " ++ show μ₀
    , testStatistic = t
    , criticalValue = tCriticalValue 0.05 (n-1)
    , pValue = pValue
    }

-- 回归分析
data LinearRegression = LinearRegression
  { slope :: Double
  , intercept :: Double
  , rSquared :: Double
  , residuals :: [Double]
  }

simpleLinearRegression :: [Double] -> [Double] -> LinearRegression
simpleLinearRegression x y =
  let n = fromIntegral (length x)
      x̄ = mean x
      ȳ = mean y
      slope = sum (zipWith (\xi yi -> (xi - x̄) * (yi - ȳ)) x y) /
              sum (map (\xi -> (xi - x̄)^2) x)
      intercept = ȳ - slope * x̄
      predicted = map (\xi -> intercept + slope * xi) x
      residuals = zipWith (\yi ŷi -> yi - ŷi) y predicted
      rSquared = 1 - (sum (map (\ri -> ri^2) residuals)) /
                 (sum (map (\yi -> (yi - ȳ)^2) y))
  in LinearRegression
    { slope = slope
    , intercept = intercept
    , rSquared = rSquared
    , residuals = residuals
    }
```

### 9.3 Rust 实现

```rust
// 描述性统计
pub fn mean(data: &[f64]) -> f64 {
    data.iter().sum::<f64>() / data.len() as f64
}

pub fn variance(data: &[f64]) -> f64 {
    let μ = mean(data);
    let n = data.len() as f64;
    data.iter()
        .map(|x| (x - μ).powi(2))
        .sum::<f64>() / (n - 1.0)
}

pub fn standard_deviation(data: &[f64]) -> f64 {
    variance(data).sqrt()
}

// 假设检验
pub struct HypothesisTest {
    pub null_hypothesis: String,
    pub alternative_hypothesis: String,
    pub test_statistic: f64,
    pub critical_value: f64,
    pub p_value: f64,
}

pub fn t_test(data: &[f64], μ₀: f64) -> HypothesisTest {
    let n = data.len() as f64;
    let x̄ = mean(data);
    let s = standard_deviation(data);
    let t = (x̄ - μ₀) / (s / n.sqrt());
    let p_value = 2.0 * (1.0 - t_distribution_cdf(t, n - 1.0));

    HypothesisTest {
        null_hypothesis: format!("μ = {}", μ₀),
        alternative_hypothesis: format!("μ ≠ {}", μ₀),
        test_statistic: t,
        critical_value: t_critical_value(0.05, n - 1.0),
        p_value,
    }
}

// 回归分析
pub struct LinearRegression {
    pub slope: f64,
    pub intercept: f64,
    pub r_squared: f64,
    pub residuals: Vec<f64>,
}

pub fn simple_linear_regression(x: &[f64], y: &[f64]) -> LinearRegression {
    let n = x.len() as f64;
    let x̄ = mean(x);
    let ȳ = mean(y);

    let slope = x.iter()
        .zip(y.iter())
        .map(|(xi, yi)| (xi - x̄) * (yi - ȳ))
        .sum::<f64>() /
        x.iter()
        .map(|xi| (xi - x̄).powi(2))
        .sum::<f64>();

    let intercept = ȳ - slope * x̄;
    let predicted: Vec<f64> = x.iter()
        .map(|xi| intercept + slope * xi)
        .collect();

    let residuals: Vec<f64> = y.iter()
        .zip(predicted.iter())
        .map(|(yi, ŷi)| yi - ŷi)
        .collect();

    let r_squared = 1.0 - residuals.iter()
        .map(|ri| ri.powi(2))
        .sum::<f64>() /
        y.iter()
        .map(|yi| (yi - ȳ).powi(2))
        .sum::<f64>();

    LinearRegression {
        slope,
        intercept,
        r_squared,
        residuals,
    }
}
```

---

**相关链接**:

- [概率论](01-概率论.md)
- [随机过程](03-随机过程.md)
- [数理统计](04-数理统计.md)
- [时间序列分析](05-时间序列分析.md)
- [机器学习数学基础](06-机器学习数学基础.md)

---

## 总结 / Summary

统计学作为数据科学的数学基础，为从数据中提取信息和做出推断提供了系统的方法。通过描述性统计、推断性统计和回归分析，统计学在各个领域发挥着重要作用。

**Statistics, as the mathematical foundation of data science, provides systematic methods for extracting information from data and making inferences. Through descriptive statistics, inferential statistics, and regression analysis, statistics plays an important role in various fields.**

### 关键要点 / Key Points

1. **描述性统计**: 通过数值和图表描述数据的基本特征
2. **推断性统计**: 从样本推断总体特征的科学方法
3. **假设检验**: 评估统计假设有效性的重要工具
4. **回归分析**: 研究变量间关系的强大方法
5. **置信区间**: 量化估计不确定性的有效工具
6. **实际应用**: 在科学研究、商业决策、政策制定等领域广泛应用

**1. Descriptive Statistics**: Describing basic characteristics of data through numbers and charts
**2. Inferential Statistics**: Scientific methods for inferring population characteristics from samples
**3. Hypothesis Testing**: Important tools for evaluating the validity of statistical hypotheses
**4. Regression Analysis**: Powerful methods for studying relationships between variables
**5. Confidence Intervals**: Effective tools for quantifying estimation uncertainty
**6. Practical Applications**: Wide applications in scientific research, business decisions, policy making, etc.

### 知识关联 / Knowledge Connections

- **与概率论的关系**: 统计学基于概率论的理论基础
- **与机器学习的关系**: 统计方法为机器学习提供理论基础
- **与实验设计的关系**: 统计学指导科学实验的设计和分析
- **与数据科学的关系**: 统计学是数据科学的核心组成部分

### 进一步学习 / Further Learning

- **高级统计学**: 多元统计分析、时间序列分析、贝叶斯统计
- **实验设计**: 随机化试验、因子设计、响应面方法
- **机器学习**: 监督学习、无监督学习、深度学习
- **应用领域**: 生物统计、金融统计、社会统计、工程统计

---

**参考文献 / References**:

1. Fisher, R.A. "Statistical Methods for Research Workers". 1925.
2. Neyman, J. "On the Problem of Confidence Intervals". 1937.
3. Box, G.E.P. and Cox, D.R. "An Analysis of Transformations". 1964.
4. Efron, B. "Bootstrap Methods: Another Look at the Jackknife". 1979.
5. Hastie, T., Tibshirani, R., and Friedman, J. "The Elements of Statistical Learning". 2001.

---

## 交互与补充资源 / Interactive & Supplementary Resources

### 交互式图表增强

- [统计分布可视化](../交互式图表增强-2025年1月.md#统计分布可视化器)
- [假设检验演示器](../交互式图表增强-2025年1月.md#假设检验演示器)
- [回归分析工具](../交互式图表增强-2025年1月.md#回归分析工具)

### 定理证明补充

- [中心极限定理证明](../定理证明补充-2025年1月.md#中心极限定理证明)
- [Fisher信息量定理](../定理证明补充-2025年1月.md#Fisher信息量定理)
- [Neyman-Pearson引理](../定理证明补充-2025年1月.md#Neyman-Pearson引理)

### 反例与特殊情况补充

- [统计推断失效反例](../反例与特殊情况补充-2025年1月.md#统计推断失效反例)
- [病态数据分布构造](../反例与特殊情况补充-2025年1月.md#病态数据分布构造)
- [假设检验错误案例](../反例与特殊情况补充-2025年1月.md#假设检验错误案例)

### 历史背景补充

- [统计学发展史](../历史背景补充-2025年1月.md#统计学发展史)
- [重要统计学家贡献](../历史背景补充-2025年1月.md#统计学重要人物)
- [现代统计学发展](../历史背景补充-2025年1月.md#现代统计学发展)

## 12.8 应用案例 / Application Cases

### 12.8.1 商业数据分析 / Business Data Analysis

#### 市场调研 / Market Research

**应用场景**: 产品市场定位与消费者行为分析
**统计方法**: 描述性统计、假设检验、回归分析
**具体实例**:

- **问题**: 分析不同年龄段消费者对新产品A的购买意愿差异
- **数据收集**: 随机抽样调查1000名消费者，记录年龄、收入、购买意愿评分
- **描述性统计**: 计算各年龄段的平均购买意愿、标准差、置信区间
- **假设检验**: $H_0: \mu_{18-25} = \mu_{26-35} = \mu_{36-45}$ vs $H_1$: 至少两个均值不等
- **方差分析**: 使用ANOVA检验年龄组间差异的显著性
- **实际应用**: 产品设计、营销策略制定、定价决策

#### 客户满意度分析 / Customer Satisfaction Analysis

**应用场景**: 服务质量评估与改进
**统计方法**: 满意度调查、相关性分析、因子分析
**具体实例**:

- **问题**: 评估银行服务质量对客户满意度的影响
- **调查设计**: 李克特量表（1-5分）评估服务态度、效率、专业性等维度
- **相关性分析**: 计算各服务维度与总体满意度的相关系数
- **回归分析**: 建立满意度预测模型 $Satisfaction = \beta_0 + \beta_1 X_1 + \beta_2 X_2 + \epsilon$
- **因子分析**: 识别潜在的服务质量因子
- **实际应用**: 服务改进、员工培训、绩效考核

### 12.8.2 医学研究与临床试验 / Medical Research and Clinical Trials

#### 药物疗效评估 / Drug Efficacy Evaluation

**应用场景**: 新药开发与疗效验证
**统计方法**: 随机对照试验、生存分析、荟萃分析
**具体实例**:

- **问题**: 评估新降压药相比标准治疗的效果
- **实验设计**: 随机双盲对照试验，200名患者随机分配到治疗组和对照组
- **主要终点**: 血压降低幅度（mmHg）
- **统计检验**: 独立样本t检验 $H_0: \mu_{treatment} = \mu_{control}$ vs $H_1: \mu_{treatment} < \mu_{control}$
- **效应大小**: 计算Cohen's d和95%置信区间
- **生存分析**: 分析血压控制持续时间（Kaplan-Meier曲线）
- **实际应用**: 药物审批、临床指南制定、医保政策

#### 流行病学研究 / Epidemiological Studies

**应用场景**: 疾病风险因素识别与预防策略
**统计方法**: 队列研究、病例对照研究、逻辑回归
**具体实例**:

- **问题**: 研究吸烟与肺癌的关联性
- **研究设计**: 前瞻性队列研究，随访10年
- **暴露定义**: 吸烟史（包年）、戒烟时间、被动吸烟
- **结局事件**: 肺癌发病率
- **相对风险**: $RR = \frac{I_{exposed}}{I_{unexposed}}$，其中 $I$ 是发病率
- **逻辑回归**: $\log(\frac{p}{1-p}) = \beta_0 + \beta_1 X_1 + \beta_2 X_2 + \beta_3 X_3$
- **实际应用**: 公共卫生政策、健康教育、烟草控制

### 12.8.3 工业质量控制 / Industrial Quality Control

#### 制造过程监控 / Manufacturing Process Monitoring

**应用场景**: 产品质量保证与过程改进
**统计方法**: 控制图、过程能力分析、实验设计
**具体实例**:

- **问题**: 监控汽车发动机缸体直径的生产稳定性
- **数据收集**: 每小时抽取5个样本，测量缸体直径
- **控制图**: 建立 $\bar{X}$ 图和 $R$ 图，设置控制限
- **过程能力**: 计算 $C_p$ 和 $C_{pk}$ 指数
- **异常检测**: 识别超出控制限或显示特殊模式的点
- **改进措施**: 基于统计分析的工艺参数调整
- **实际应用**: 汽车制造、电子产品、食品加工

#### 六西格玛改进 / Six Sigma Improvement

**应用场景**: 业务流程优化与缺陷减少
**统计方法**: DMAIC方法、实验设计、回归分析
**具体实例**:

- **问题**: 减少银行信用卡申请处理时间
- **定义阶段**: 明确CTQ（关键质量特性）和缺陷定义
- **测量阶段**: 收集当前处理时间数据，建立基线
- **分析阶段**: 识别影响处理时间的关键因素
- **改进阶段**: 设计实验优化流程参数
- **控制阶段**: 建立监控系统维持改进效果
- **实际应用**: 金融服务、物流、医疗保健

### 12.8.4 环境监测与评估 / Environmental Monitoring and Assessment

#### 空气质量监测 / Air Quality Monitoring

**应用场景**: 环境污染评估与预警
**统计方法**: 时间序列分析、空间统计、趋势分析
**具体实例**:

- **问题**: 监测城市PM2.5浓度的时空变化
- **监测网络**: 在全市设置20个监测站点
- **时间序列**: 分析PM2.5浓度的日、周、月、季节变化
- **空间分析**: 使用克里金插值法绘制污染分布图
- **趋势分析**: 检验污染浓度的长期变化趋势
- **预警系统**: 基于统计模型建立污染预警机制
- **实际应用**: 环境保护、城市规划、健康风险评估

#### 生态系统评估 / Ecosystem Assessment

**应用场景**: 生物多样性保护与生态恢复
**统计方法**: 抽样调查、多样性指数、群落分析
**具体实例**:

- **问题**: 评估森林砍伐对鸟类多样性的影响
- **调查设计**: 在砍伐前后分别进行鸟类调查
- **多样性指数**: 计算Shannon指数 $H = -\sum_{i=1}^S p_i \ln p_i$
- **群落比较**: 使用相似性指数比较砍伐前后的群落组成
- **统计分析**: 配对t检验比较砍伐前后的多样性差异
- **影响评估**: 量化砍伐对生态系统的影响程度
- **实际应用**: 自然保护区管理、生态修复、环境影响评价

### 12.8.5 金融风险管理 / Financial Risk Management

#### 投资组合分析 / Portfolio Analysis

**应用场景**: 资产配置与风险控制
**统计方法**: 相关性分析、风险度量、VaR计算
**具体实例**:

- **问题**: 构建最优投资组合，平衡收益与风险
- **数据收集**: 收集各资产的历史收益率数据
- **相关性分析**: 计算资产间的相关系数矩阵
- **风险度量**: 计算投资组合的方差、VaR、CVaR
- **优化模型**: 使用均值-方差模型求解最优权重
- **回测分析**: 验证投资组合的历史表现
- **实际应用**: 基金管理、银行投资、保险资金运用

#### 信用风险评估 / Credit Risk Assessment

**应用场景**: 银行贷款审批与风险管理
**统计方法**: 逻辑回归、判别分析、生存分析
**具体实例**:

- **问题**: 预测个人贷款的违约概率
- **特征变量**: 年龄、收入、信用历史、债务收入比等
- **模型构建**: 逻辑回归模型 $P(default) = \frac{1}{1+e^{-(\beta_0 + \sum \beta_i X_i)}}$
- **模型验证**: 使用ROC曲线和AUC评估模型性能
- **风险分层**: 根据预测概率将客户分为不同风险等级
- **监控系统**: 建立贷款组合的风险监控指标
- **实际应用**: 银行信贷、信用卡、消费金融

---

**应用案例状态**: 涵盖商业、医学、工业、环境、金融等主要领域
**案例质量**: 理论联系实际 + 统计方法明确 + 应用价值突出
**扩展方向**: 可继续添加更多行业和新兴技术应用案例
