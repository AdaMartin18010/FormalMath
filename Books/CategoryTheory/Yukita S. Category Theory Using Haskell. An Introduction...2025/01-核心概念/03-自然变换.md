# è‡ªç„¶å˜æ¢ (Natural Transformation)

**åˆ›å»ºæ—¥æœŸ**: 2025å¹´12æœˆ11æ—¥
**æ¥æº**: Category Theory Using Haskell, Chapter 1.6
**ä¸»é¢˜ç¼–å·**: CT.YUKITA.01.03

---

## ğŸ“‘ ç›®å½•

- [è‡ªç„¶å˜æ¢ (Natural Transformation)](#è‡ªç„¶å˜æ¢-natural-transformation)
  - [ğŸ“‘ ç›®å½•](#-ç›®å½•)
  - [ä¸€ã€è‡ªç„¶å˜æ¢çš„å®šä¹‰](#ä¸€è‡ªç„¶å˜æ¢çš„å®šä¹‰)
    - [1.1 è‡ªç„¶å˜æ¢çš„æ•°å­¦å®šä¹‰](#11-è‡ªç„¶å˜æ¢çš„æ•°å­¦å®šä¹‰)
    - [1.2 è‡ªç„¶å˜æ¢çš„è®°å·](#12-è‡ªç„¶å˜æ¢çš„è®°å·)
  - [äºŒã€Haskellä¸­çš„è‡ªç„¶å˜æ¢](#äºŒhaskellä¸­çš„è‡ªç„¶å˜æ¢)
    - [2.1 å¤šæ€å‡½æ•°ä½œä¸ºè‡ªç„¶å˜æ¢](#21-å¤šæ€å‡½æ•°ä½œä¸ºè‡ªç„¶å˜æ¢)
    - [2.2 è‡ªç„¶æ€§æ¡ä»¶](#22-è‡ªç„¶æ€§æ¡ä»¶)
    - [2.3 è‡ªç„¶å˜æ¢çš„ç±»å‹](#23-è‡ªç„¶å˜æ¢çš„ç±»å‹)
  - [ä¸‰ã€è‡ªç„¶å˜æ¢çš„æ€§è´¨](#ä¸‰è‡ªç„¶å˜æ¢çš„æ€§è´¨)
    - [3.1 è‡ªç„¶å˜æ¢çš„å¤åˆ](#31-è‡ªç„¶å˜æ¢çš„å¤åˆ)
    - [3.2 è‡ªç„¶å˜æ¢çš„æ°´å¹³å¤åˆ](#32-è‡ªç„¶å˜æ¢çš„æ°´å¹³å¤åˆ)
  - [å››ã€è‡ªç„¶åŒæ„](#å››è‡ªç„¶åŒæ„)
    - [4.1 è‡ªç„¶åŒæ„çš„å®šä¹‰](#41-è‡ªç„¶åŒæ„çš„å®šä¹‰)
    - [4.2 å‡½å­çš„ç­‰ä»·](#42-å‡½å­çš„ç­‰ä»·)

---

## ä¸€ã€è‡ªç„¶å˜æ¢çš„å®šä¹‰

### 1.1 è‡ªç„¶å˜æ¢çš„æ•°å­¦å®šä¹‰

**è‡ªç„¶å˜æ¢ (Natural Transformation)** $\eta: F \Rightarrow G$ æ˜¯å‡½å­ $F, G: \mathcal{C} \to \mathcal{D}$ ä¹‹é—´çš„æ˜ å°„ï¼Œç”±ä»¥ä¸‹æ•°æ®ç»„æˆï¼š

1. **åˆ†é‡æ˜ å°„**: å¯¹æ¯ä¸ªå¯¹è±¡ $A \in \mathcal{C}$ï¼Œæ˜ å°„ $\eta_A: F(A) \to G(A)$

**æ»¡è¶³çš„è‡ªç„¶æ€§æ¡ä»¶**ï¼š

å¯¹ä»»æ„æ˜ å°„ $f: A \to B$ï¼Œä»¥ä¸‹å›¾äº¤æ¢ï¼š
$$
\begin{CD}
F(A) @>{\eta_A}>> G(A) \\
@V{F(f)}VV @VV{G(f)}V \\
F(B) @>>{\eta_B}> G(B)
\end{CD}
$$

å³ï¼š$\eta_B \circ F(f) = G(f) \circ \eta_A$

### 1.2 è‡ªç„¶å˜æ¢çš„è®°å·

**æ•°å­¦è®°å·**ï¼š

- $\eta: F \Rightarrow G$ è¡¨ç¤ºè‡ªç„¶å˜æ¢ä»å‡½å­ $F$ åˆ°å‡½å­ $G$
- $\eta_A$ è¡¨ç¤ºè‡ªç„¶å˜æ¢åœ¨å¯¹è±¡ $A$ å¤„çš„åˆ†é‡
- è‡ªç„¶æ€§æ¡ä»¶ï¼š$\eta_B \circ F(f) = G(f) \circ \eta_A$

**äº¤æ¢å›¾**ï¼š
è‡ªç„¶æ€§æ¡ä»¶ç¡®ä¿å¯¹ä»»æ„æ˜ å°„ $f: A \to B$ï¼Œç›¸åº”çš„å›¾äº¤æ¢ã€‚

---

## äºŒã€Haskellä¸­çš„è‡ªç„¶å˜æ¢

### 2.1 å¤šæ€å‡½æ•°ä½œä¸ºè‡ªç„¶å˜æ¢

**å¤šæ€å‡½æ•°**åœ¨Haskellä¸­å¯¹åº”è‡ªç„¶å˜æ¢ï¼š

```haskell
-- å¤šæ€å‡½æ•°
f :: Maybe a -> [a]
f Nothing = []
f (Just x) = [x]
```

**æ•°å­¦å¯¹åº”**ï¼š

- `Maybe` å’Œ `[]` éƒ½æ˜¯å‡½å­ $F, G: \mathbf{Hask} \to \mathbf{Hask}$
- å¤šæ€å‡½æ•° `f :: Maybe a -> [a]` å¯¹åº”è‡ªç„¶å˜æ¢ $\eta: F \Rightarrow G$
- å¯¹æ¯ä¸ªç±»å‹ $A$ï¼Œ$\eta_A: F(A) \to G(A)$ å¯¹åº” `f :: Maybe A -> [A]`

### 2.2 è‡ªç„¶æ€§æ¡ä»¶

**è‡ªç„¶æ€§æ¡ä»¶**åœ¨Haskellä¸­è‡ªåŠ¨æ»¡è¶³ï¼š

```haskell
-- è‡ªç„¶æ€§æ¡ä»¶ï¼šå¯¹ä»»æ„å‡½æ•° g :: a -> b
-- fmap g . f = f . fmap g

-- éªŒè¯
fmap g . f $ Nothing = fmap g [] = []
f . fmap g $ Nothing = f Nothing = []

fmap g . f $ Just x = fmap g [x] = [g x]
f . fmap g $ Just x = f (Just (g x)) = [g x]
```

**æ•°å­¦è¡¨ç¤º**ï¼š

- è‡ªç„¶æ€§æ¡ä»¶ï¼š$\eta_B \circ F(f) = G(f) \circ \eta_A$
- Haskellå¯¹åº”ï¼š`fmap f . eta = eta . fmap f`

### 2.3 è‡ªç„¶å˜æ¢çš„ç±»å‹

**è‡ªç„¶å˜æ¢çš„ç±»å‹ç­¾å**ï¼š

```haskell
-- è‡ªç„¶å˜æ¢çš„ç±»å‹
type Nat f g = forall a. f a -> g a

-- ä¾‹å­
maybeToList :: Nat Maybe []
maybeToList Nothing = []
maybeToList (Just x) = [x]
```

**æ•°å­¦è¡¨ç¤º**ï¼š

- `Nat f g` å¯¹åº”æ‰€æœ‰ä»å‡½å­ $F$ åˆ°å‡½å­ $G$ çš„è‡ªç„¶å˜æ¢çš„é›†åˆ
- `forall a` ç¡®ä¿è‡ªç„¶æ€§æ¡ä»¶è‡ªåŠ¨æ»¡è¶³

---

## ä¸‰ã€è‡ªç„¶å˜æ¢çš„æ€§è´¨

### 3.1 è‡ªç„¶å˜æ¢çš„å¤åˆ

**è‡ªç„¶å˜æ¢çš„å‚ç›´å¤åˆ**ï¼š

ç»™å®šè‡ªç„¶å˜æ¢ $\eta: F \Rightarrow G$ å’Œ $\epsilon: G \Rightarrow H$ï¼Œå¯ä»¥æ„é€ å¤åˆè‡ªç„¶å˜æ¢ $\epsilon \circ \eta: F \Rightarrow H$ã€‚

**å®šä¹‰**ï¼š

- $(\epsilon \circ \eta)_A = \epsilon_A \circ \eta_A$

**Haskellå®ç°**ï¼š

```haskell
-- è‡ªç„¶å˜æ¢çš„å¤åˆ
composeNat :: Nat g h -> Nat f g -> Nat f h
composeNat epsilon eta = epsilon . eta

-- ä¾‹å­
maybeToList :: Nat Maybe []
listToSet :: Nat [] Set

maybeToSet :: Nat Maybe Set
maybeToSet = composeNat listToSet maybeToList
```

**æ•°å­¦è¯æ˜**ï¼š

- è‡ªç„¶æ€§æ¡ä»¶ï¼š$(\epsilon \circ \eta)_B \circ F(f) = \epsilon_B \circ \eta_B \circ F(f) = \epsilon_B \circ G(f) \circ \eta_A = H(f) \circ \epsilon_A \circ \eta_A = H(f) \circ (\epsilon \circ \eta)_A$

### 3.2 è‡ªç„¶å˜æ¢çš„æ°´å¹³å¤åˆ

**è‡ªç„¶å˜æ¢çš„æ°´å¹³å¤åˆ**ï¼š

ç»™å®šè‡ªç„¶å˜æ¢ $\eta: F \Rightarrow G$ å’Œ $\epsilon: H \Rightarrow K$ï¼Œä»¥åŠå‡½å­ $F, G: \mathcal{C} \to \mathcal{D}$ å’Œ $H, K: \mathcal{D} \to \mathcal{E}$ï¼Œå¯ä»¥æ„é€ æ°´å¹³å¤åˆ $\epsilon * \eta: H \circ F \Rightarrow K \circ G$ã€‚

**å®šä¹‰**ï¼š

- $(\epsilon * \eta)_A = \epsilon_{G(A)} \circ H(\eta_A)$

**Haskellå®ç°**ï¼š

```haskell
-- æ°´å¹³å¤åˆ
horizontalCompose :: Nat h k -> Nat f g -> Nat (Compose h f) (Compose k g)
horizontalCompose epsilon eta (Compose x) = Compose (epsilon (fmap eta x))
```

---

## å››ã€è‡ªç„¶åŒæ„

### 4.1 è‡ªç„¶åŒæ„çš„å®šä¹‰

**è‡ªç„¶åŒæ„ (Natural Isomorphism)** æ˜¯æ¯ä¸ªåˆ†é‡éƒ½æ˜¯åŒæ„çš„è‡ªç„¶å˜æ¢ã€‚

**å®šä¹‰**ï¼šè‡ªç„¶å˜æ¢ $\eta: F \Rightarrow G$ æ˜¯è‡ªç„¶åŒæ„ï¼Œå¦‚æœå¯¹æ¯ä¸ªå¯¹è±¡ $A$ï¼Œ$\eta_A: F(A) \to G(A)$ æ˜¯åŒæ„ã€‚

**è®°å·**ï¼š$\eta: F \cong G$ æˆ– $F \cong G$

### 4.2 å‡½å­çš„ç­‰ä»·

**å‡½å­çš„ç­‰ä»·**ï¼š

å‡½å­ $F$ å’Œ $G$ æ˜¯ç­‰ä»·çš„ï¼Œå¦‚æœå­˜åœ¨è‡ªç„¶åŒæ„ $\eta: F \cong G$ã€‚

**æ€§è´¨**ï¼š

- å‡½å­çš„ç­‰ä»·æ˜¯ç­‰ä»·å…³ç³»
- ç­‰ä»·çš„å‡½å­ä¿æŒæ‰€æœ‰èŒƒç•´æ€§è´¨

**Haskellä¾‹å­**ï¼š

```haskell
-- Maybeå’ŒEither ()æ˜¯åŒæ„çš„
maybeToEither :: Nat Maybe (Either ())
maybeToEither Nothing = Left ()
maybeToEither (Just x) = Right x

eitherToMaybe :: Nat (Either ()) Maybe
eitherToMaybe (Left _) = Nothing
eitherToMaybe (Right x) = Just x

-- éªŒè¯å®ƒä»¬æ˜¯äº’é€†çš„
eitherToMaybe . maybeToEither = id
maybeToEither . eitherToMaybe = id
```

**æ•°å­¦è¡¨ç¤º**ï¼š

- $\eta: F \cong G$ è¡¨ç¤ºå­˜åœ¨è‡ªç„¶åŒæ„
- ç­‰ä»·å‡½å­ $F \cong G$ æ„å‘³ç€å®ƒä»¬åœ¨èŒƒç•´è®ºæ„ä¹‰ä¸‹"ç›¸åŒ"

---

**æœ€åæ›´æ–°**: 2025å¹´12æœˆ11æ—¥
**å‚è€ƒç« èŠ‚**: Chapter 1.6
