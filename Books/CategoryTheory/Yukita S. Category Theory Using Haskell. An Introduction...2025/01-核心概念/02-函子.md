# å‡½å­ (Functor)

**åˆ›å»ºæ—¥æœŸ**: 2025å¹´12æœˆ11æ—¥
**æ¥æº**: Category Theory Using Haskell, Chapter 1.4
**ä¸»é¢˜ç¼–å·**: CT.YUKITA.01.02

---

## ğŸ“‘ ç›®å½•

- [å‡½å­ (Functor)](#å‡½å­-functor)
  - [ğŸ“‘ ç›®å½•](#-ç›®å½•)
  - [ä¸€ã€å‡½å­çš„å®šä¹‰](#ä¸€å‡½å­çš„å®šä¹‰)
    - [1.1 å‡½å­çš„æ•°å­¦å®šä¹‰](#11-å‡½å­çš„æ•°å­¦å®šä¹‰)
    - [1.2 å‡½å­çš„è®°å·](#12-å‡½å­çš„è®°å·)
  - [äºŒã€Haskellä¸­çš„å‡½å­](#äºŒhaskellä¸­çš„å‡½å­)
    - [2.1 Functorç±»å‹ç±»](#21-functorç±»å‹ç±»)
    - [2.2 å‡½å­å®šå¾‹](#22-å‡½å­å®šå¾‹)
  - [ä¸‰ã€åå˜å‡½å­ä¸åå˜å‡½å­](#ä¸‰åå˜å‡½å­ä¸åå˜å‡½å­)
    - [3.1 åå˜å‡½å­](#31-åå˜å‡½å­)
    - [3.2 åå˜å‡½å­](#32-åå˜å‡½å­)
  - [å››ã€å‡½å­çš„æ€§è´¨](#å››å‡½å­çš„æ€§è´¨)
    - [4.1 å¿ å®å‡½å­ä¸æ»¡å‡½å­](#41-å¿ å®å‡½å­ä¸æ»¡å‡½å­)
    - [4.2 å‡½å­çš„å¤åˆ](#42-å‡½å­çš„å¤åˆ)

---

## ä¸€ã€å‡½å­çš„å®šä¹‰

### 1.1 å‡½å­çš„æ•°å­¦å®šä¹‰

**å‡½å­ (Functor)** $F: \mathcal{C} \to \mathcal{D}$ ç”±ä»¥ä¸‹æ•°æ®ç»„æˆï¼š

1. **å¯¹è±¡æ˜ å°„**: å¯¹æ¯ä¸ªå¯¹è±¡ $A \in \mathcal{C}$ï¼Œå¯¹è±¡ $F(A) \in \mathcal{D}$
2. **æ˜ å°„æ˜ å°„**: å¯¹æ¯ä¸ªæ˜ å°„ $f: A \to B$ï¼Œæ˜ å°„ $F(f): F(A) \to F(B)$

**æ»¡è¶³çš„æ¡ä»¶**ï¼š

- **æ’ç­‰ä¿æŒ**: $F(1_A) = 1_{F(A)}$
- **å¤åˆä¿æŒ**: $F(g \circ f) = F(g) \circ F(f)$

### 1.2 å‡½å­çš„è®°å·

**æ•°å­¦è®°å·**ï¼š

- $F: \mathcal{C} \to \mathcal{D}$ è¡¨ç¤ºå‡½å­ä»èŒƒç•´ $\mathcal{C}$ åˆ°èŒƒç•´ $\mathcal{D}$
- $F(A)$ è¡¨ç¤ºå¯¹è±¡ $A$ çš„åƒ
- $F(f)$ è¡¨ç¤ºæ˜ å°„ $f$ çš„åƒ

**äº¤æ¢å›¾**ï¼š
$$
\begin{CD}
A @>{f}>> B \\
@V{F}VV @VV{F}V \\
F(A) @>{F(f)}>> F(B)
\end{CD}
$$

---

## äºŒã€Haskellä¸­çš„å‡½å­

### 2.1 Functorç±»å‹ç±»

**Functorç±»å‹ç±»**å®šä¹‰ï¼š

```haskell
class Functor f where
    fmap :: (a -> b) -> f a -> f b
```

**æ•°å­¦å¯¹åº”**ï¼š

- `Functor f` å¯¹åº”å‡½å­ $F: \mathbf{Hask} \to \mathbf{Hask}$
- `fmap` å¯¹åº”æ˜ å°„æ˜ å°„ $F(f): F(A) \to F(B)$
- `f a` å¯¹åº”å¯¹è±¡ $F(A)$

### 2.2 å‡½å­å®šå¾‹

**Functorå¿…é¡»æ»¡è¶³çš„å®šå¾‹**ï¼š

1. **æ’ç­‰å¾‹**: `fmap id = id`
   - æ•°å­¦è¡¨ç¤ºï¼š$F(1_A) = 1_{F(A)}$

2. **å¤åˆå¾‹**: `fmap (g . f) = fmap g . fmap f`
   - æ•°å­¦è¡¨ç¤ºï¼š$F(g \circ f) = F(g) \circ F(f)$

**ä¾‹å­**ï¼š

```haskell
-- Maybeæ˜¯å‡½å­
instance Functor Maybe where
    fmap f Nothing = Nothing
    fmap f (Just x) = Just (f x)

-- éªŒè¯æ’ç­‰å¾‹
fmap id Nothing = Nothing = id Nothing
fmap id (Just x) = Just (id x) = Just x = id (Just x)

-- éªŒè¯å¤åˆå¾‹
fmap (g . f) (Just x) = Just ((g . f) x) = Just (g (f x))
(fmap g . fmap f) (Just x) = fmap g (Just (f x)) = Just (g (f x))
```

---

## ä¸‰ã€åå˜å‡½å­ä¸åå˜å‡½å­

### 3.1 åå˜å‡½å­

**åå˜å‡½å­ (Covariant Functor)** ä¿æŒæ˜ å°„æ–¹å‘ï¼š

- æ˜ å°„ $f: A \to B$ æ˜ å°„åˆ° $F(f): F(A) \to F(B)$
- æ–¹å‘ï¼š$A \to B$ ä¿æŒä¸º $F(A) \to F(B)$

**Haskellä¸­çš„åå˜å‡½å­**ï¼š

- `Maybe`, `[]`, `Either a` éƒ½æ˜¯åå˜å‡½å­
- `Functor` ç±»å‹ç±»å®šä¹‰åå˜å‡½å­

### 3.2 åå˜å‡½å­

**åå˜å‡½å­ (Contravariant Functor)** åè½¬æ˜ å°„æ–¹å‘ï¼š

- æ˜ å°„ $f: A \to B$ æ˜ å°„åˆ° $F(f): F(B) \to F(A)$
- æ–¹å‘ï¼š$A \to B$ åè½¬ä¸º $F(B) \to F(A)$

**Haskellä¸­çš„åå˜å‡½å­**ï¼š

```haskell
class Contravariant f where
    contramap :: (b -> a) -> f a -> f b
```

**æ•°å­¦å®šä¹‰**ï¼š

- åå˜å‡½å­ $F: \mathcal{C}^{\text{op}} \to \mathcal{D}$ å¯¹åº”åå˜å‡½å­ $F: \mathcal{C} \to \mathcal{D}^{\text{op}}$
- å…¶ä¸­ $\mathcal{C}^{\text{op}}$ æ˜¯ $\mathcal{C}$ çš„å¯¹å¶èŒƒç•´

**ä¾‹å­**ï¼š

```haskell
-- å‡½æ•°ç±»å‹ (-> r) æ˜¯åå˜å‡½å­
instance Contravariant ((->) r) where
    contramap f g = g . f
    -- contramap :: (b -> a) -> (a -> r) -> (b -> r)
```

---

## å››ã€å‡½å­çš„æ€§è´¨

### 4.1 å¿ å®å‡½å­ä¸æ»¡å‡½å­

**å¿ å®å‡½å­ (Faithful Functor)**ï¼š

- å®šä¹‰ï¼šå¯¹ä»»æ„å¯¹è±¡ $A, B$ï¼Œæ˜ å°„ $\text{Hom}(A, B) \to \text{Hom}(F(A), F(B))$ æ˜¯å•å°„
- æ„ä¹‰ï¼šä¸åŒçš„æ˜ å°„æ˜ å°„åˆ°ä¸åŒçš„æ˜ å°„

**æ»¡å‡½å­ (Full Functor)**ï¼š

- å®šä¹‰ï¼šå¯¹ä»»æ„å¯¹è±¡ $A, B$ï¼Œæ˜ å°„ $\text{Hom}(A, B) \to \text{Hom}(F(A), F(B))$ æ˜¯æ»¡å°„
- æ„ä¹‰ï¼šç›®æ ‡èŒƒç•´ä¸­çš„æ¯ä¸ªæ˜ å°„éƒ½æ¥è‡ªæºèŒƒç•´

**å®Œå…¨å¿ å®å‡½å­ (Fully Faithful Functor)**ï¼š

- å®šä¹‰ï¼šæ—¢æ˜¯å¿ å®å‡½å­åˆæ˜¯æ»¡å‡½å­
- æ„ä¹‰ï¼š$\text{Hom}(A, B) \cong \text{Hom}(F(A), F(B))$

### 4.2 å‡½å­çš„å¤åˆ

**å‡½å­çš„å¤åˆ**ï¼š

- ç»™å®šå‡½å­ $F: \mathcal{C} \to \mathcal{D}$ å’Œ $G: \mathcal{D} \to \mathcal{E}$ï¼Œå¤åˆ $G \circ F: \mathcal{C} \to \mathcal{E}$ ä¹Ÿæ˜¯å‡½å­
- $(G \circ F)(A) = G(F(A))$
- $(G \circ F)(f) = G(F(f))$

**Haskellä¸­çš„å‡½å­å¤åˆ**ï¼š

```haskell
-- å‡½å­å¤åˆ
newtype Compose f g a = Compose { getCompose :: f (g a) }

instance (Functor f, Functor g) => Functor (Compose f g) where
    fmap f (Compose x) = Compose (fmap (fmap f) x)
```

---

**æœ€åæ›´æ–°**: 2025å¹´12æœˆ11æ—¥
**å‚è€ƒç« èŠ‚**: Chapter 1.4
