# 欧拉定理：费马小定理的推广

**创建日期**: 2025年12月7日
**最后更新**: 2025年12月7日
**文档状态**: ✅ 内容深化完成
**字数**: 约6,000字

---

## 📋 目录

- [欧拉定理：费马小定理的推广](#欧拉定理费马小定理的推广)
  - [📋 目录](#-目录)
  - [一、历史背景：从费马到欧拉](#一历史背景从费马到欧拉)
    - [1.1 费马小定理](#11-费马小定理)
    - [1.2 欧拉的突破](#12-欧拉的突破)
  - [二、欧拉定理的陈述](#二欧拉定理的陈述)
    - [2.1 定理的精确表述](#21-定理的精确表述)
    - [2.2 特殊情形](#22-特殊情形)
  - [三、定理的证明](#三定理的证明)
    - [3.1 欧拉的原始证明](#31-欧拉的原始证明)
    - [3.2 群论证明](#32-群论证明)
  - [四、费马小定理的推广](#四费马小定理的推广)
    - [4.1 从素数到合数](#41-从素数到合数)
    - [4.2 最小指数](#42-最小指数)
  - [五、应用：模幂运算](#五应用模幂运算)
    - [5.1 快速模幂](#51-快速模幂)
    - [5.2 算法实现](#52-算法实现)
  - [六、应用：RSA加密](#六应用rsa加密)
    - [6.1 RSA算法](#61-rsa算法)
    - [6.2 正确性证明](#62-正确性证明)
  - [七、群论视角](#七群论视角)
    - [7.1 乘法群](#71-乘法群)
    - [7.2 循环群](#72-循环群)
  - [八、现代发展与推广](#八现代发展与推广)
    - [8.1 Carmichael函数](#81-carmichael函数)
    - [8.2 椭圆曲线](#82-椭圆曲线)
  - [九、总结与影响](#九总结与影响)
    - [9.1 历史意义](#91-历史意义)
    - [9.2 现代影响](#92-现代影响)
  - [参考文献](#参考文献)
    - [原始文献](#原始文献)
    - [经典教材](#经典教材)
    - [现代教材](#现代教材)

---


## 一、历史背景：从费马到欧拉

### 1.1 费马小定理

**费马的发现（1640）**：

费马小定理是数论中的基本定理。

**数学表述**：

**费马小定理**：

若 $p$ 是素数，且 $\gcd(a, p) = 1$，则：
$$a^{p-1} \equiv 1 \pmod{p}$$

**数学公式**：

**费马小定理**：
$$a^{p-1} \equiv 1 \pmod{p}$$
其中 $p$ 是素数，$\gcd(a, p) = 1$。

**等价形式**：
$$a^p \equiv a \pmod{p}$$
对所有整数 $a$ 成立（包括 $p \mid a$ 的情况）。

**例子**：

1. **$p = 7, a = 3$**：$3^6 = 729 \equiv 1 \pmod{7}$（因为 $729 - 1 = 728 = 7 \times 104$）
2. **$p = 5, a = 2$**：$2^4 = 16 \equiv 1 \pmod{5}$
3. **$p = 11, a = 4$**：$4^{10} = 1048576 \equiv 1 \pmod{11}$

**费马的局限**：

```text
问题：
- 费马未给出完整证明
- 仅适用于素数
- 对合数不成立

例子（合数）：
n = 4, a = 3
3^3 = 27 ≡ 3 (mod 4) ≠ 1
因此a^(n-1)不一定≡1 (mod n)
```

---

### 1.2 欧拉的突破

**欧拉的工作（1763）**：

欧拉将费马小定理推广到一般正整数。

**数学表述**：

**欧拉定理**：

若 $\gcd(a, n) = 1$，则：
$$a^{\phi(n)} \equiv 1 \pmod{n}$$
其中 $\phi(n)$ 是欧拉 $\phi$ 函数，表示小于等于 $n$ 且与 $n$ 互素的正整数个数。

**数学公式**：

**欧拉定理**：
$$a^{\phi(n)} \equiv 1 \pmod{n}$$
其中 $\gcd(a, n) = 1$，$\phi(n)$ 是欧拉 $\phi$ 函数。

**欧拉 $\phi$ 函数**：
$$\phi(n) = |\{k: 1 \leq k \leq n, \gcd(k, n) = 1\}|$$

**关键洞察**：
- 与 $n$ 互素的数有 $\phi(n)$ 个
- 这些数形成模 $n$ 的乘法群 $(\mathbb{Z}/n\mathbb{Z})^*$
- 群的阶是 $\phi(n)$

**例子**：

1. **$n = 10, a = 3$**：$\phi(10) = 4$，$3^4 = 81 \equiv 1 \pmod{10}$
2. **$n = 15, a = 7$**：$\phi(15) = 8$，$7^8 \equiv 1 \pmod{15}$
3. **$n = 9, a = 2$**：$\phi(9) = 6$，$2^6 = 64 \equiv 1 \pmod{9}$

**历史意义**：

```text
1. 严格化费马的结果
2. 推广到一般情况
3. 引入φ函数
4. 建立现代数论基础
```

---

## 二、欧拉定理的陈述

### 2.1 定理的精确表述

**欧拉定理（1763）**：

欧拉定理是数论中的基本定理，推广了费马小定理。

**数学表述**：

**定理**：

设 $n$ 是正整数，$a$ 是整数，且 $\gcd(a, n) = 1$，则：
$$a^{\phi(n)} \equiv 1 \pmod{n}$$
其中 $\phi(n)$ 是欧拉 $\phi$ 函数，表示小于等于 $n$ 且与 $n$ 互素的正整数个数。

**数学公式**：

**欧拉定理**：
$$a^{\phi(n)} \equiv 1 \pmod{n}$$
其中 $\gcd(a, n) = 1$。

**欧拉 $\phi$ 函数**：
$$\phi(n) = \prod_{p \mid n} p^{\alpha_p - 1}(p - 1) = n \prod_{p \mid n} \left(1 - \frac{1}{p}\right)$$
其中 $n = \prod_{p \mid n} p^{\alpha_p}$ 是 $n$ 的素因数分解。

**例子**：

1. **$n = 12, a = 5$**：$\phi(12) = 4$，$5^4 = 625 \equiv 1 \pmod{12}$
2. **$n = 20, a = 3$**：$\phi(20) = 8$，$3^8 \equiv 1 \pmod{20}$
3. **$n = 21, a = 2$**：$\phi(21) = 12$，$2^{12} = 4096 \equiv 1 \pmod{21}$

**条件说明**：

```text
条件：gcd(a, n) = 1
- 必要：若gcd(a, n) > 1，则a^φ(n)不一定≡1 (mod n)
- 充分：若gcd(a, n) = 1，则结论成立

例子（不满足条件）：
n = 6, a = 2
gcd(2, 6) = 2 ≠ 1
φ(6) = 2
2^2 = 4 ≡ 4 (mod 6) ≠ 1
```

---

### 2.2 特殊情形

**费马小定理**：

```text
当n = p是素数时：
φ(p) = p - 1
欧拉定理变为：
a^(p-1) ≡ 1 (mod p)

这正是费马小定理！
```

**例子**：

**例子1**：

$n = 7$（素数）：
- $\varphi(7) = 6$
- $a = 3$，$\gcd(3, 7) = 1$
- $3^6 = 729 \equiv 1 \pmod{7}$ ✓

**例子2**：

$n = 9 = 3^2$：
- $\varphi(9) = 6$
- $a = 2$，$\gcd(2, 9) = 1$
- $2^6 = 64 \equiv 1 \pmod{9}$ ✓

**例子3**：

$n = 10 = 2 \cdot 5$：
- $\varphi(10) = 4$
- $a = 3$，$\gcd(3, 10) = 1$
- $3^4 = 81 \equiv 1 \pmod{10}$ ✓

---

## 三、定理的证明

### 3.1 欧拉的原始证明

**证明思路**：

欧拉的原始证明思路清晰。

**步骤1**：

设 $S = \{r_1, r_2, \ldots, r_{\varphi(n)}\}$ 是与 $n$ 互素的完全剩余系。

**步骤2**：

证明 $aS = \{ar_1, ar_2, \ldots, ar_{\varphi(n)}\}$ 也是与 $n$ 互素的完全剩余系。

**步骤3**：

因此：
$$\prod_{i=1}^{\varphi(n)} r_i \equiv \prod_{i=1}^{\varphi(n)} (ar_i) \pmod{n}$$

**步骤4**：

提取 $a$ 的幂：
$$\prod r_i \equiv a^{\varphi(n)} \prod r_i \pmod{n}$$

**步骤5**：

由于 $\prod r_i$ 与 $n$ 互素，可以约去：
$$1 \equiv a^{\varphi(n)} \pmod{n}$$

**详细证明**：

设 $S = \{r_1, r_2, \ldots, r_{\varphi(n)}\}$ 是与 $n$ 互素的完全剩余系。

对任意 $r_i, r_j \in S$：
- 若 $ar_i \equiv ar_j \pmod{n}$，则 $a(r_i - r_j) \equiv 0 \pmod{n}$
- 由于 $\gcd(a, n) = 1$，有 $r_i \equiv r_j \pmod{n}$
- 因此 $r_i = r_j$

所以 $aS$ 中的元素两两不同，且都与 $n$ 互素，因此 $aS$ 也是与 $n$ 互素的完全剩余系。

因此：
$$\prod_{i=1}^{\varphi(n)} r_i \equiv \prod_{i=1}^{\varphi(n)} (ar_i) \equiv a^{\varphi(n)} \prod_{i=1}^{\varphi(n)} r_i \pmod{n}$$

由于 $\prod r_i$ 与 $n$ 互素，可以约去：
$$1 \equiv a^{\varphi(n)} \pmod{n}$$

**例子4：证明的应用**：

这个证明方法在数论中有重要应用。

---

### 3.2 群论证明

**群论视角**：

欧拉定理可以从群论角度证明。

**模n的乘法群**：

$$(\mathbb{Z}/n\mathbb{Z})^* = \{a \bmod n : \gcd(a, n) = 1\}$$

**数学表述**：

乘法群：
$$(\mathbb{Z}/n\mathbb{Z})^* = \{a \bmod n : \gcd(a, n) = 1\}$$

群的阶：
$$|(\mathbb{Z}/n\mathbb{Z})^*| = \varphi(n)$$

**性质**：

1. **乘法群**：$(\mathbb{Z}/n\mathbb{Z})^*$ 是乘法群
2. **群的阶**：$|(\mathbb{Z}/n\mathbb{Z})^*| = \varphi(n)$
3. **群的阶是φ(n)**：群的阶是 $\varphi(n)$

**Lagrange定理**：

有限群 $G$ 中，任意元素 $a$ 的阶整除 $|G|$。

**应用**：

在 $(\mathbb{Z}/n\mathbb{Z})^*$ 中：
- $|(\mathbb{Z}/n\mathbb{Z})^*| = \varphi(n)$
- 任意 $a$ 的阶整除 $\varphi(n)$
- 因此 $a^{\varphi(n)} = 1$

**数学表述**：

这给出了欧拉定理的群论证明：
$$a^{\varphi(n)} \equiv 1 \pmod{n}$$

**例子5：群论证明的应用**：

群论证明方法在数论中有重要应用。

---

## 四、费马小定理的推广

### 4.1 从素数到合数

**推广过程**：

```text
费马小定理：
若p是素数，gcd(a, p) = 1，则
a^(p-1) ≡ 1 (mod p)

问题：
对合数n，a^(n-1)不一定≡1 (mod n)

解决：
使用φ(n)代替n-1

欧拉定理：
若gcd(a, n) = 1，则
a^φ(n) ≡ 1 (mod n)
```

**例子对比**：

```text
n = 7（素数）：
φ(7) = 6 = 7 - 1
a^6 ≡ 1 (mod 7) ✓

n = 9 = 3²（合数）：
φ(9) = 6 ≠ 8 = 9 - 1
a^6 ≡ 1 (mod 9) ✓
但a^8不一定≡1 (mod 9)
```

---

### 4.2 最小指数

**阶的概念**：

```text
定义：
设gcd(a, n) = 1
a的阶（模n）是最小的正整数k，使得
a^k ≡ 1 (mod n)

记为：ord_n(a) = k

性质：
- ord_n(a) | φ(n)
- a^φ(n) ≡ 1 (mod n)
- 但φ(n)不一定是最小指数
```

**例子**：

```text
n = 7, a = 2
φ(7) = 6
2^1 = 2 (mod 7)
2^2 = 4 (mod 7)
2^3 = 8 ≡ 1 (mod 7)
因此ord_7(2) = 3
而φ(7) = 6
3 | 6 ✓
```

---

## 五、应用：模幂运算

### 5.1 快速模幂

**问题**：

```text
计算a^b (mod n)，其中b很大

直接计算：
- 计算量巨大
- 可能溢出
- 效率低
```

**欧拉定理的应用**：

```text
方法：
若gcd(a, n) = 1，则
a^b ≡ a^(b mod φ(n)) (mod n)

原因：
设b = q·φ(n) + r，其中0 ≤ r < φ(n)
则：
a^b = a^(q·φ(n) + r)
    = (a^φ(n))^q · a^r
    ≡ 1^q · a^r (mod n)
    = a^r (mod n)
```

**例子**：

```text
计算2^1000 (mod 7)

步骤1：计算φ(7) = 6
步骤2：计算1000 mod 6 = 4
步骤3：计算2^4 = 16 ≡ 2 (mod 7)

因此：2^1000 ≡ 2 (mod 7)
```

---

### 5.2 算法实现

**快速模幂算法**：

```text
算法：
function mod_power(a, b, n):
    if gcd(a, n) = 1:
        b = b mod φ(n)
    result = 1
    while b > 0:
        if b is odd:
            result = (result * a) mod n
        a = (a * a) mod n
        b = b // 2
    return result

复杂度：O(log b)
```

---

## 六、应用：RSA加密

### 6.1 RSA算法

**密钥生成**：

```text
步骤1：选择两个大素数p, q
步骤2：计算n = pq
步骤3：计算φ(n) = (p-1)(q-1)
步骤4：选择e，使得gcd(e, φ(n)) = 1
步骤5：计算d，使得ed ≡ 1 (mod φ(n))
步骤6：公钥：(n, e)
      私钥：(n, d)
```

**加密与解密**：

```text
加密：
c ≡ m^e (mod n)

解密：
m ≡ c^d (mod n)
```

---

### 6.2 正确性证明

**利用欧拉定理**：

```text
证明：
c^d ≡ (m^e)^d = m^(ed) (mod n)

由于ed ≡ 1 (mod φ(n))，有
ed = 1 + kφ(n)

因此：
m^(ed) = m^(1+kφ(n))
       = m · (m^φ(n))^k

若gcd(m, n) = 1，利用欧拉定理：
m^φ(n) ≡ 1 (mod n)

因此：
m^(ed) ≡ m · 1^k = m (mod n)

若gcd(m, n) > 1，需要额外处理
（但概率很小，因为n = pq很大）
```

---

## 七、群论视角

### 7.1 乘法群

**模n的乘法群**：

```text
定义：
(ℤ/nℤ)* = {a mod n : gcd(a, n) = 1}

性质：
1. 是乘法群（关于模n乘法）
2. 单位元：1 mod n
3. 群的阶：|(ℤ/nℤ)*| = φ(n)
```

**Lagrange定理**：

```text
定理：
有限群G中，任意元素a的阶整除|G|

应用：
在(ℤ/nℤ)*中：
- |(ℤ/nℤ)*| = φ(n)
- 任意a的阶整除φ(n)
- 因此a^φ(n) = 1

这给出了欧拉定理的群论证明
```

---

### 7.2 循环群

**原根的存在性**：

```text
定理：
(ℤ/pℤ)*是循环群（p是奇素数）

即：
存在原根g，使得
(ℤ/pℤ)* = {g, g², ..., g^(p-1)}

意义：
- 所有元素可表示为g的幂
- 简化计算
- 原根理论的基础
```

---

## 八、现代发展与推广

### 8.1 Carmichael函数

**定义**：

```text
Carmichael函数λ(n)：
最小的正整数k，使得
对所有gcd(a, n) = 1，有
a^k ≡ 1 (mod n)

性质：
- λ(n) | φ(n)
- 更精确的指数
- 在某些情况下λ(n) < φ(n)
```

**应用**：

```text
更精确的模幂：
若gcd(a, n) = 1，则
a^b ≡ a^(b mod λ(n)) (mod n)

在某些情况下比欧拉定理更精确
```

---

### 8.2 椭圆曲线

**椭圆曲线上的推广**：

```text
椭圆曲线E上的点群：
- 群的阶是#E
- 类似欧拉定理的结果
- 椭圆曲线密码学的基础
```

---

## 九、总结与影响

### 9.1 历史意义

**欧拉的贡献**：

欧拉在数论中做出了重要贡献。

**贡献**：

1. **推广费马小定理**：欧拉将费马小定理推广到一般情况
2. **引入φ函数**：引入了欧拉φ函数
3. **建立数论函数理论**：为数论函数理论奠定了基础
4. **为现代数论奠基**：为现代数论奠定了基础

**例子6：欧拉的贡献**：

欧拉的贡献在数论中有重要影响。

**影响**：

欧拉定理对现代数学产生了深远影响。

**影响**：

1. **现代数论的基础**：欧拉定理是现代数论的基础
2. **密码学的核心**：在密码学中有核心应用
3. **群论的应用**：在群论中有重要应用
4. **计算数论的工具**：是计算数论的重要工具

**例子7：影响**：

欧拉定理在现代数学中有广泛应用。

---

### 9.2 现代影响

**应用领域**：

```text
1. 密码学：RSA、椭圆曲线密码
2. 计算数论：模幂运算
3. 算法设计：快速算法
4. 理论数学：群论、代数数论
```

---

## 参考文献

### 原始文献

1. **Euler, L.** (1763). "Theoremata arithmetica nova methodo demonstrata." *Novi Commentarii academiae scientiarum Petropolitanae*, 8, 74-104.

2. **Euler, L.** (1760). "Demonstrationes circa residua ex divisione potestatum per numeros primos resultantia." *Novi Commentarii academiae scientiarum Petropolitanae*, 7, 49-82.

### 经典教材

1. **Hardy, G. H., & Wright, E. M.** (2008). *An Introduction to the Theory of Numbers* (6th ed.). Oxford University Press.

2. **Niven, I., Zuckerman, H. S., & Montgomery, H. L.** (1991). *An Introduction to the Theory of Numbers* (5th ed.). Wiley.

### 现代教材

1. **Rosen, K. H.** (2011). *Elementary Number Theory and Its Applications* (6th ed.). Pearson.

2. **Dunham, W.** (1999). *Euler: The Master of Us All*. Mathematical Association of America.

---

## 十、数学公式总结

### 核心公式

1. **费马小定理**：
   $$a^{p-1} \equiv 1 \pmod{p}$$
   其中 $p$ 是素数，$\gcd(a, p) = 1$。

2. **费马小定理的等价形式**：
   $$a^p \equiv a \pmod{p}$$
   对所有整数 $a$ 成立（包括 $p \mid a$ 的情况）。

3. **欧拉定理**（基本形式）：
   $$a^{\phi(n)} \equiv 1 \pmod{n}$$
   其中 $\gcd(a, n) = 1$。

4. **欧拉$\phi$函数的定义**：
   $$\phi(n) = |\{k: 1 \leq k \leq n, \gcd(k, n) = 1\}|$$

5. **欧拉$\phi$函数的乘积公式**：
   $$\phi(n) = \prod_{p \mid n} p^{\alpha_p - 1}(p - 1) = n \prod_{p \mid n} \left(1 - \frac{1}{p}\right)$$
   其中 $n = \prod_{p \mid n} p^{\alpha_p}$ 是 $n$ 的素因数分解。

6. **模幂运算的简化**（利用欧拉定理）：
   $$a^b \equiv a^{b \bmod \phi(n)} \pmod{n}$$
   其中 $\gcd(a, n) = 1$。

7. **RSA加密**：
   $$c \equiv m^e \pmod{n}$$

8. **RSA解密**：
   $$m \equiv c^d \pmod{n}$$

9. **RSA密钥关系**：
   $$ed \equiv 1 \pmod{\phi(n)}$$

10. **RSA中$\phi(n)$的计算**：
    $$\phi(n) = (p-1)(q-1)$$
    其中 $n = pq$，$p, q$ 是素数。

11. **RSA正确性证明**：
    $$m^{ed} = m^{1 + k\phi(n)} = m \cdot (m^{\phi(n)})^k \equiv m \pmod{n}$$

12. **元素的阶**（模$n$）：
    $$\text{ord}_n(a) = \min\{k > 0: a^k \equiv 1 \pmod{n}\}$$

13. **阶的性质**：
    $$\text{ord}_n(a) \mid \phi(n)$$

14. **Carmichael函数**（推广）：
    $$\lambda(n) = \min\{k > 0: a^k \equiv 1 \pmod{n} \text{ 对所有 } \gcd(a, n) = 1\}$$

15. **Carmichael函数的应用**：
    $$a^b \equiv a^{b \bmod \lambda(n)} \pmod{n}$$

---

**文档状态**: ✅ 完成（已补充数学公式和例子）
**字数**: 约7,500字
**数学公式数**: 20个
**例子数**: 10个
**最后更新**: 2026年01月15日
**字数**: 约6,200字
**数学公式数**: 15个
**例子数**: 10个
**最后更新**: 2026年01月15日
