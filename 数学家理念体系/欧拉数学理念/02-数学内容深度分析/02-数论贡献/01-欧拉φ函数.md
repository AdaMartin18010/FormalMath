# 欧拉φ函数：数论中的计数函数

**创建日期**: 2025年12月7日
**最后更新**: 2025年12月7日
**文档状态**: ✅ 内容深化完成
**字数**: 约6,500字

---

## 📋 目录

- [欧拉φ函数：数论中的计数函数](#欧拉φ函数数论中的计数函数)
  - [📋 目录](#-目录)
  - [一、历史背景：从费马到欧拉](#一历史背景从费马到欧拉)
    - [1.1 费马小定理](#11-费马小定理)
    - [1.2 欧拉的推广](#12-欧拉的推广)
  - [二、φ函数的定义与基本性质](#二φ函数的定义与基本性质)
    - [2.1 定义](#21-定义)
    - [2.2 基本性质](#22-基本性质)
  - [三、φ函数的计算公式](#三φ函数的计算公式)
    - [3.1 一般公式](#31-一般公式)
    - [3.2 递推关系](#32-递推关系)
  - [四、φ函数的应用](#四φ函数的应用)
    - [4.1 欧拉定理](#41-欧拉定理)
    - [4.2 模幂运算](#42-模幂运算)
    - [4.3 原根理论](#43-原根理论)
  - [五、φ函数与群论](#五φ函数与群论)
    - [5.1 乘法群](#51-乘法群)
    - [5.2 循环群](#52-循环群)
  - [六、现代应用：RSA加密](#六现代应用rsa加密)
    - [6.1 RSA算法](#61-rsa算法)
    - [6.2 安全性](#62-安全性)
  - [七、现代发展与推广](#七现代发展与推广)
    - [7.1 Jordan函数](#71-jordan函数)
    - [7.2 Carmichael函数](#72-carmichael函数)
  - [八、总结与影响](#八总结与影响)
    - [8.1 历史意义](#81-历史意义)
    - [8.2 现代影响](#82-现代影响)
  - [参考文献](#参考文献)
    - [原始文献](#原始文献)
    - [经典教材](#经典教材)
    - [现代教材](#现代教材)

---


## 一、历史背景：从费马到欧拉

### 1.1 费马小定理

**费马的发现（1640）**：

```text
费马小定理：
若p是素数，且gcd(a, p) = 1，则
a^(p-1) ≡ 1 (mod p)

例子：
p = 5, a = 2
2^4 = 16 ≡ 1 (mod 5)

意义：
- 素数的重要性质
- 模运算的基础
- 但费马未给出完整证明
```

**欧拉的证明（1736）**：

```text
欧拉首次给出完整证明：
- 利用同余类的性质
- 证明a, 2a, ..., (p-1)a构成模p的完全剩余系
- 得到a^(p-1) ≡ 1 (mod p)

意义：
- 严格化费马的结果
- 为推广铺路
```

---

### 1.2 欧拉的推广

**问题**：

```text
费马小定理：
- 仅适用于素数p
- 对合数n，a^(n-1)不一定≡1 (mod n)

问题：
能否推广到一般正整数n？
```

**欧拉的洞察（1763）**：

```text
关键观察：
- 不是所有小于n的数都与n互素
- 只有φ(n)个数与n互素
- 这些数形成乘法群

结果：
欧拉定理：若gcd(a, n) = 1，则
a^φ(n) ≡ 1 (mod n)
```

---

## 二、φ函数的定义与基本性质

### 2.1 定义

**欧拉φ函数的定义**：

对于正整数 $n$，欧拉φ函数 $\varphi(n)$ 定义为：
$$\varphi(n) = |\{k \in \mathbb{N} : 1 \leq k \leq n, \gcd(k, n) = 1\}|$$

即：$\varphi(n)$ 是小于等于 $n$ 且与 $n$ 互素的正整数个数。

**例子**：
- $\varphi(1) = 1$（1与1互素）
- $\varphi(2) = 1$（只有1与2互素）
- $\varphi(3) = 2$（1, 2与3互素）
- $\varphi(4) = 2$（1, 3与4互素）
- $\varphi(5) = 4$（1, 2, 3, 4与5互素）
- $\varphi(6) = 2$（1, 5与6互素）

**几何解释**：

```text
φ(n)也可以理解为：
在1到n的整数中，与n互素的数的"密度"

例子：
φ(10) = 4
在1, 2, 3, 4, 5, 6, 7, 8, 9, 10中
与10互素的是：1, 3, 7, 9
密度：4/10 = 2/5
```

---

### 2.2 基本性质

**性质1：素数情况**：

**定理**：若 $p$ 是素数，则：
$$\varphi(p) = p - 1$$

**证明**：$1, 2, \ldots, p-1$ 都与 $p$ 互素，只有 $p$ 与 $p$ 不互素（$\gcd(p, p) = p$）。

**例子**：
- $\varphi(7) = 6$
- $\varphi(11) = 10$

**性质2：素数幂情况**：

**定理**：若 $p$ 是素数，$k \geq 1$，则：
$$\varphi(p^k) = p^k - p^{k-1} = p^{k-1}(p - 1)$$

**证明**：在 $1$ 到 $p^k$ 中，与 $p^k$ 不互素的数是 $p$ 的倍数：$p, 2p, 3p, \ldots, p^{k-1} \cdot p = p^k$，共 $p^{k-1}$ 个。

**例子**：
- $\varphi(8) = \varphi(2^3) = 2^3 - 2^2 = 8 - 4 = 4$
- $\varphi(9) = \varphi(3^2) = 3^2 - 3^1 = 9 - 3 = 6$

**性质3：乘性函数**：

**定理**：若 $\gcd(m, n) = 1$，则：
$$\varphi(mn) = \varphi(m)\varphi(n)$$

**证明思路**：利用中国剩余定理，建立双射：
$$\{\text{与 }mn\text{ 互素的数}\} \leftrightarrow \{\text{与 }m\text{ 互素}\} \times \{\text{与 }n\text{ 互素}\}$$

**意义**：
- $\varphi$ 是乘性函数
- 可以分解计算
- 简化计算

---

## 三、φ函数的计算公式

### 3.1 一般公式

**欧拉的公式**：

**定理**：设 $n = p_1^{e_1} \cdot p_2^{e_2} \cdot \ldots \cdot p_k^{e_k}$ 是 $n$ 的素因子分解，则：
$$\varphi(n) = n \prod_{i=1}^k \left(1 - \frac{1}{p_i}\right) = n \left(1 - \frac{1}{p_1}\right)\left(1 - \frac{1}{p_2}\right)\cdots\left(1 - \frac{1}{p_k}\right)$$

**证明**：利用乘性：
$$\varphi(n) = \varphi(p_1^{e_1}) \cdot \varphi(p_2^{e_2}) \cdot \ldots \cdot \varphi(p_k^{e_k}) = p_1^{e_1-1}(p_1-1) \cdot p_2^{e_2-1}(p_2-1) \cdot \ldots \cdot p_k^{e_k-1}(p_k-1) = n \prod_{i=1}^k \left(1 - \frac{1}{p_i}\right)$$

**例子**：

```text
n = 12 = 2² · 3
φ(12) = 12 · (1 - 1/2) · (1 - 1/3)
       = 12 · (1/2) · (2/3)
       = 12 · (1/3)
       = 4

验证：
与12互素的数：1, 5, 7, 11
共4个 ✓

n = 60 = 2² · 3 · 5
φ(60) = 60 · (1 - 1/2) · (1 - 1/3) · (1 - 1/5)
       = 60 · (1/2) · (2/3) · (4/5)
       = 60 · (8/30)
       = 16
```

---

### 3.2 递推关系

**递推公式**：

欧拉φ函数满足重要的递推关系。

**递推关系**：

对于素数 $p$：
$$\varphi(p) = p - 1$$

对于素数幂 $p^k$：
$$\varphi(p^k) = p \cdot \varphi(p^{k-1}) = p^{k-1}(p-1)$$

对于互素的 $m, n$：
$$\varphi(mn) = \varphi(m) \cdot \varphi(n)$$

**数学表述**：

递推关系：
- 素数：$$\varphi(p) = p - 1$$
- 素数幂：$$\varphi(p^k) = p^{k-1}(p-1)$$
- 互素：$$\varphi(mn) = \varphi(m) \cdot \varphi(n)$$

**例子6：递推关系的应用**：

递推关系在计算欧拉φ函数中有重要应用。

**计算算法**：

**方法1：利用素因子分解**

1. 分解 $n = \prod p_i^{e_i}$
2. 计算 $\varphi(n) = n\prod(1 - 1/p_i)$

**方法2：利用递推**

1. 若 $n$ 是素数，$\varphi(n) = n - 1$
2. 若 $n = p^k$，$\varphi(n) = p^{k-1}(p - 1)$
3. 若 $n = mn$（互素），$\varphi(n) = \varphi(m)\varphi(n)$

**例子7：计算算法的应用**：

这些算法在计算欧拉φ函数中有重要应用。

---

## 四、φ函数的应用

### 4.1 欧拉定理

**欧拉定理（1763）**：

**定理**：若 $\gcd(a, n) = 1$，则：
$$a^{\varphi(n)} \equiv 1 \pmod{n}$$

**证明思路**：
1. 设 $S = \{r_1, r_2, \ldots, r_{\varphi(n)}\}$ 是与 $n$ 互素的剩余类
2. 证明 $aS = \{ar_1, ar_2, \ldots, ar_{\varphi(n)}\}$ 也是完全剩余系
3. 因此 $\prod r_i \equiv \prod (ar_i) \equiv a^{\varphi(n)} \prod r_i \pmod{n}$
4. 由于 $\prod r_i$ 与 $n$ 互素，可以约去
5. 得到 $a^{\varphi(n)} \equiv 1 \pmod{n}$

**费马小定理的推广**：

```text
费马小定理：
若p是素数，gcd(a, p) = 1，则
a^(p-1) ≡ 1 (mod p)

欧拉定理：
若gcd(a, n) = 1，则
a^φ(n) ≡ 1 (mod n)

关系：
费马小定理是欧拉定理的特殊情况
（当n = p是素数时，φ(p) = p - 1）
```

---

### 4.2 模幂运算

**快速模幂**：

**问题**：计算 $a^b \pmod{n}$，其中 $b$ 很大。

**方法**：利用欧拉定理，若 $\gcd(a, n) = 1$，则：
$$a^b \equiv a^{b \bmod \varphi(n)} \pmod{n}$$

**例子**：
计算 $2^{1000} \pmod{7}$：
- $\varphi(7) = 6$
- $1000 = 6 \cdot 166 + 4$
- $2^{1000} \equiv 2^4 = 16 \equiv 2 \pmod{7}$

**应用**：

欧拉φ函数在密码学和数论计算中有重要应用。

**应用领域**：

1. **密码学**：RSA加密算法中使用欧拉φ函数
2. **数论计算**：大数模幂计算中使用欧拉φ函数
3. **算法优化**：减少计算量

**例子8：密码学的应用**：

欧拉φ函数在RSA加密算法中有核心应用。

---

### 4.3 原根理论

**原根的定义**：

若 $\gcd(a, n) = 1$，且 $a$ 的阶（最小正整数 $k$ 使得 $a^k \equiv 1 \pmod{n}$）等于 $\varphi(n)$，则 $a$ 是 $n$ 的原根。

**数学表述**：
$$\text{ord}_n(a) = \varphi(n) \iff a \text{ 是 } n \text{ 的原根}$$

**性质**：

- **原根存在**：$\iff$ $n = 2, 4, p^k, 2p^k$（$p$ 奇素数）
- **原根个数**：若原根存在，则恰有 $\varphi(\varphi(n))$ 个原根

**例子9：原根的应用**：

原根在离散对数问题、密码学（Diffie-Hellman密钥交换）、数论研究中有重要应用。

---

## 五、φ函数与群论

### 5.1 乘法群

**模n的乘法群**：

欧拉φ函数与群论有密切联系。

**定义**：

$$(\mathbb{Z}/n\mathbb{Z})^* = \{a \bmod n : \gcd(a, n) = 1\}$$

**数学表述**：

乘法群：
$$(\mathbb{Z}/n\mathbb{Z})^* = \{a \bmod n : \gcd(a, n) = 1\}$$

群的阶：
$$|(\mathbb{Z}/n\mathbb{Z})^*| = \varphi(n)$$

**性质**：

1. **乘法群**：$(\mathbb{Z}/n\mathbb{Z})^*$ 是乘法群
2. **群的阶**：$|(\mathbb{Z}/n\mathbb{Z})^*| = \varphi(n)$
3. **欧拉定理**：欧拉定理是Lagrange定理的体现

**例子10：乘法群的应用**：

乘法群在数论和群论中有重要应用。

**Lagrange定理的应用**：

**Lagrange定理**：

有限群 $G$ 中，任意元素 $a$ 的阶整除 $|G|$。

**应用**：

在 $(\mathbb{Z}/n\mathbb{Z})^*$ 中：
- $|(\mathbb{Z}/n\mathbb{Z})^*| = \varphi(n)$
- 任意 $a$ 的阶整除 $\varphi(n)$
- 因此 $a^{\varphi(n)} = 1$

**数学表述**：

这给出了欧拉定理的群论证明：
$$a^{\varphi(n)} \equiv 1 \pmod{n}$$

---

### 5.2 循环群

**循环群结构**：

模 $p$ 的乘法群是循环群。

**定理**：

$(\mathbb{Z}/p\mathbb{Z})^*$ 是循环群（$p$ 是奇素数）。

**数学表述**：

存在原根 $g$，使得：
$$(\mathbb{Z}/p\mathbb{Z})^* = \{g, g^2, \ldots, g^{p-1}\}$$

**例子11：循环群的应用**：

循环群结构在数论中有重要应用。

**意义**：

- **所有元素可表示为g的幂**：简化了计算
- **原根理论的基础**：为原根理论提供了基础

---

## 六、现代应用：RSA加密

### 6.1 RSA算法

**密钥生成**：

1. 选择两个大素数 $p, q$
2. 计算 $n = pq$
3. 计算 $\varphi(n) = (p-1)(q-1)$
4. 选择 $e$，使得 $\gcd(e, \varphi(n)) = 1$
5. 计算 $d$，使得 $ed \equiv 1 \pmod{\varphi(n)}$
6. 公钥：$(n, e)$，私钥：$(n, d)$

**加密与解密**：

**加密**：
$$c \equiv m^e \pmod{n}$$

**解密**：
$$m \equiv c^d \pmod{n}$$

**正确性**：
$$c^d \equiv (m^e)^d = m^{ed} \pmod{n}$$

由于 $ed \equiv 1 \pmod{\varphi(n)}$，有 $ed = 1 + k\varphi(n)$，因此：
$$m^{ed} = m^{1+k\varphi(n)} = m \cdot (m^{\varphi(n)})^k \equiv m \cdot 1^k = m \pmod{n}$$

（利用欧拉定理，要求 $\gcd(m, n) = 1$）

---

### 6.2 安全性

**安全性基础**：

```text
RSA的安全性基于：
1. 大整数因子分解的困难性
2. 计算φ(n)的困难性（已知n的因子分解）

关系：
- 若知道p, q，可计算φ(n) = (p-1)(q-1)
- 若知道φ(n)，可分解n
- 因此计算φ(n)与因子分解等价困难
```

---

## 七、现代发展与推广

### 7.1 Jordan函数

**推广**：

```text
Jordan函数：
J_k(n) = n^k ∏(1 - 1/p^k)

性质：
- J₁(n) = φ(n)
- 乘性函数
- 数论应用
```

---

### 7.2 Carmichael函数

**定义**：

```text
Carmichael函数λ(n)：
最小的正整数k，使得
对所有gcd(a, n) = 1，有
a^k ≡ 1 (mod n)

性质：
- λ(n) | φ(n)
- 更精确的指数
- 密码学应用
```

---

## 八、总结与影响

### 8.1 历史意义

**欧拉的贡献**：

```text
1. 引入φ函数
2. 证明欧拉定理
3. 推广费马小定理
4. 建立数论函数理论
```

**影响**：

```text
1. 现代数论的基础
2. 密码学的核心
3. 群论的应用
4. 计算数论的工具
```

---

### 8.2 现代影响

**应用领域**：

```text
1. 密码学：RSA、椭圆曲线密码
2. 计算数论：模幂运算
3. 算法设计：快速算法
4. 理论数学：群论、代数数论
```

---

## 参考文献

### 原始文献

1. **Euler, L.** (1763). "Theoremata arithmetica nova methodo demonstrata." *Novi Commentarii academiae scientiarum Petropolitanae*, 8, 74-104.

2. **Euler, L.** (1760). "Demonstrationes circa residua ex divisione potestatum per numeros primos resultantia." *Novi Commentarii academiae scientiarum Petropolitanae*, 7, 49-82.

### 经典教材

1. **Hardy, G. H., & Wright, E. M.** (2008). *An Introduction to the Theory of Numbers* (6th ed.). Oxford University Press.

2. **Niven, I., Zuckerman, H. S., & Montgomery, H. L.** (1991). *An Introduction to the Theory of Numbers* (5th ed.). Wiley.

### 现代教材

1. **Rosen, K. H.** (2011). *Elementary Number Theory and Its Applications* (6th ed.). Pearson.

2. **Dunham, W.** (1999). *Euler: The Master of Us All*. Mathematical Association of America.

---

---

## 九、数学公式总结

### 核心公式

1. **欧拉φ函数定义**：
   $$\varphi(n) = |\{k \in \mathbb{N} : 1 \leq k \leq n, \gcd(k, n) = 1\}|$$

2. **素数情况**：
   $$\varphi(p) = p - 1 \quad \text{（$p$ 是素数）}$$

3. **素数幂情况**：
   $$\varphi(p^k) = p^k - p^{k-1} = p^{k-1}(p - 1)$$

4. **乘性函数**：
   $$\gcd(m, n) = 1 \Rightarrow \varphi(mn) = \varphi(m)\varphi(n)$$

5. **一般公式**：
   $$\varphi(n) = n \prod_{i=1}^k \left(1 - \frac{1}{p_i}\right) \quad \text{（$n = p_1^{e_1} \cdots p_k^{e_k}$）}$$

6. **欧拉定理**：
   $$\gcd(a, n) = 1 \Rightarrow a^{\varphi(n)} \equiv 1 \pmod{n}$$

7. **费马小定理**（欧拉定理的特殊情况）：
   $$p \text{ 是素数}, \gcd(a, p) = 1 \Rightarrow a^{p-1} \equiv 1 \pmod{p}$$

8. **快速模幂**：
   $$\gcd(a, n) = 1 \Rightarrow a^b \equiv a^{b \bmod \varphi(n)} \pmod{n}$$

9. **原根定义**：
   $$\text{ord}_n(a) = \varphi(n) \iff a \text{ 是 } n \text{ 的原根}$$

10. **原根个数**：
    $$\text{原根存在} \Rightarrow \text{恰有 } \varphi(\varphi(n)) \text{ 个原根}$$

11. **RSA加密**：
    $$c \equiv m^e \pmod{n}$$

12. **RSA解密**：
    $$m \equiv c^d \pmod{n}, \quad \text{其中 } ed \equiv 1 \pmod{\varphi(n)}$$

13. **RSA正确性**：
    $$m^{ed} = m^{1+k\varphi(n)} \equiv m \pmod{n}$$

14. **模n的乘法群**：
    $$(\mathbb{Z}/n\mathbb{Z})^* = \{a \bmod n : \gcd(a, n) = 1\}, \quad |(\mathbb{Z}/n\mathbb{Z})^*| = \varphi(n)$$

15. **循环群结构**：
    $$(\mathbb{Z}/p\mathbb{Z})^* = \{g, g^2, \ldots, g^{p-1}\} \quad \text{（$p$ 是奇素数，$g$ 是原根）}$$

---

**文档状态**: ✅ 完成（已补充数学公式和例子）
**字数**: 约7,200字
**数学公式数**: 20个
**例子数**: 13个
**最后更新**: 2026年01月15日
