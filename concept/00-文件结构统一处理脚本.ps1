# æ–‡ä»¶ç»“æ„ç»Ÿä¸€å¤„ç†è„šæœ¬
# ä¸ºæ‰€æœ‰æ ¸å¿ƒæ¦‚å¿µæ–‡ä»¶æ·»åŠ ç»Ÿä¸€çš„ç›®å½•å’Œç¼–å·

$conceptFiles = Get-ChildItem "g:\_src\FormalMath\concept\æ ¸å¿ƒæ¦‚å¿µ\*.md" | Sort-Object Name

foreach ($file in $conceptFiles) {
    Write-Host "å¤„ç†æ–‡ä»¶: $($file.Name)"
    
    $content = Get-Content $file.FullName -Raw -Encoding UTF8
    
    # æ£€æŸ¥æ˜¯å¦å·²æœ‰ç›®å½•
    if ($content -notmatch "## ğŸ“‘ ç›®å½•") {
        # åœ¨æ¦‚è¿°ä¹‹å‰æ’å…¥ç›®å½•
        $content = $content -replace "(?s)(---\s*\n\s*)(## ğŸ“‹ æ¦‚è¿°)", "`$1## ğŸ“‘ ç›®å½•`n`n1. [æ¦‚è¿°](#1-æ¦‚è¿°)`n2. [ä¸¥æ ¼å®šä¹‰](#2-ä¸¥æ ¼å®šä¹‰)`n   - 2.1 [åŸºç¡€å®šä¹‰ (L0)](#21-åŸºç¡€å®šä¹‰-l0)`n   - 2.2 [å½¢å¼åŒ–å®šä¹‰ (L1)](#22-å½¢å¼åŒ–å®šä¹‰-l1)`n3. [å†å²èƒŒæ™¯](#3-å†å²èƒŒæ™¯)`n   - 3.1 [å‘å±•è„‰ç»œ](#31-å‘å±•è„‰ç»œ)`n   - 3.2 [å…³é”®äººç‰©](#32-å…³é”®äººç‰©)`n   - 3.3 [é‡è¦äº‹ä»¶](#33-é‡è¦äº‹ä»¶)`n4. [æ€§è´¨ä¸å®šç†](#4-æ€§è´¨ä¸å®šç†)`n   - 4.1 [åŸºæœ¬æ€§è´¨ (L1)](#41-åŸºæœ¬æ€§è´¨-l1)`n   - 4.2 [é‡è¦å®šç† (L2)](#42-é‡è¦å®šç†-l2)`n5. [å½¢å¼åŒ–è¯æ˜](#5-å½¢å¼åŒ–è¯æ˜)ï¼ˆå¦‚æœæœ‰ï¼‰`n6. [åº”ç”¨å®ä¾‹](#6-åº”ç”¨å®ä¾‹)`n   - 6.1 [ç†è®ºåº”ç”¨](#61-ç†è®ºåº”ç”¨)`n   - 6.2 [å®é™…åº”ç”¨](#62-å®é™…åº”ç”¨)`n7. [å…³è”æ¦‚å¿µ](#7-å…³è”æ¦‚å¿µ)`n8. [å‚è€ƒæ–‡çŒ®](#8-å‚è€ƒæ–‡çŒ®)`n9. [å…¶ä»–éƒ¨åˆ†](#9-å…¶ä»–éƒ¨åˆ†)`n`n---`n`n`$2"
    }
    
    # ç»Ÿä¸€ç¼–å·ä¸»è¦ç« èŠ‚
    $content = $content -replace "## ğŸ“‹ æ¦‚è¿°", "## 1. ğŸ“‹ æ¦‚è¿°"
    $content = $content -replace "## ğŸ¯ ä¸¥æ ¼å®šä¹‰", "## 2. ğŸ¯ ä¸¥æ ¼å®šä¹‰"
    $content = $content -replace "## ğŸ“š å†å²èƒŒæ™¯", "## 3. ğŸ“š å†å²èƒŒæ™¯"
    $content = $content -replace "## ğŸ” æ€§è´¨ä¸å®šç†", "## 4. ğŸ” æ€§è´¨ä¸å®šç†"
    $content = $content -replace "## ğŸ”¬ å½¢å¼åŒ–è¯æ˜", "## 5. ğŸ”¬ å½¢å¼åŒ–è¯æ˜"
    $content = $content -replace "## ğŸ’¡ åº”ç”¨å®ä¾‹", "## 6. ğŸ’¡ åº”ç”¨å®ä¾‹"
    $content = $content -replace "## ğŸ”— å…³è”æ¦‚å¿µ", "## 7. ğŸ”— å…³è”æ¦‚å¿µ"
    $content = $content -replace "## ğŸ“– å‚è€ƒæ–‡çŒ®", "## 8. ğŸ“– å‚è€ƒæ–‡çŒ®"
    
    # ç»Ÿä¸€ç¼–å·å­ç« èŠ‚
    $content = $content -replace "### åŸºç¡€å®šä¹‰ \(L0\)", "### 2.1 åŸºç¡€å®šä¹‰ (L0)"
    $content = $content -replace "### å½¢å¼åŒ–å®šä¹‰ \(L1\)", "### 2.2 å½¢å¼åŒ–å®šä¹‰ (L1)"
    $content = $content -replace "### é«˜çº§å®šä¹‰ \(L2\)", "### 2.3 é«˜çº§å®šä¹‰ (L2)"
    
    $content = $content -replace "### å‘å±•è„‰ç»œ", "### 3.1 å‘å±•è„‰ç»œ"
    $content = $content -replace "### å…³é”®äººç‰©", "### 3.2 å…³é”®äººç‰©"
    $content = $content -replace "### é‡è¦äº‹ä»¶", "### 3.3 é‡è¦äº‹ä»¶"
    
    $content = $content -replace "### åŸºæœ¬æ€§è´¨ \(L1\)", "### 4.1 åŸºæœ¬æ€§è´¨ (L1)"
    $content = $content -replace "### é‡è¦å®šç† \(L2\)", "### 4.2 é‡è¦å®šç† (L2)"
    
    $content = $content -replace "### ç†è®ºåº”ç”¨", "### 6.1 ç†è®ºåº”ç”¨"
    $content = $content -replace "### å®é™…åº”ç”¨", "### 6.2 å®é™…åº”ç”¨"
    
    # ä¿å­˜æ–‡ä»¶
    Set-Content -Path $file.FullName -Value $content -Encoding UTF8 -NoNewline
    
    Write-Host "å®Œæˆ: $($file.Name)"
}

Write-Host "`næ‰€æœ‰æ–‡ä»¶å¤„ç†å®Œæˆï¼"
