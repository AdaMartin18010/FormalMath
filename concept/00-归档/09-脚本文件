# æ–‡ä»¶ç»“æ„æœ€ç»ˆå®Œå–„è„šæœ¬
# ç¡®ä¿æ‰€æœ‰æ–‡ä»¶çš„ç›®å½•å®Œæ•´ï¼Œæ‰€æœ‰ç« èŠ‚éƒ½æœ‰æ­£ç¡®ç¼–å·

$conceptFiles = Get-ChildItem "g:\_src\FormalMath\concept\æ ¸å¿ƒæ¦‚å¿µ\*.md" -Exclude "*ä¸‰è§†è§’ç‰ˆ*","*ç´¢å¼•*","*å…³ç³»*" | Sort-Object Name

foreach ($file in $conceptFiles) {
    Write-Host "å®Œå–„æ–‡ä»¶: $($file.Name)"

    $content = Get-Content $file.FullName -Raw -Encoding UTF8
    $modified = $false

    # æ£€æŸ¥å¹¶ä¿®å¤ç›®å½•ä¸­çš„å…¶ä»–éƒ¨åˆ†é“¾æ¥
    if ($content -match '9\. \[å…¶ä»–éƒ¨åˆ†\]\(#9-å…¶ä»–éƒ¨åˆ†\)' -and $content -notmatch '9\.1 \[æ€ç»´å¯¼å›¾\]') {
        $content = $content -replace '9\. \[å…¶ä»–éƒ¨åˆ†\]\(#9-å…¶ä»–éƒ¨åˆ†\)', "9. [å…¶ä»–éƒ¨åˆ†](#9-å…¶ä»–éƒ¨åˆ†)`n   - 9.1 [æ€ç»´å¯¼å›¾](#91-æ€ç»´å¯¼å›¾)ï¼ˆå¦‚æœæœ‰ï¼‰`n   - 9.2 [çŸ¥è¯†å¤šç»´å…³ç³»çŸ©é˜µ](#92-çŸ¥è¯†å¤šç»´å…³ç³»çŸ©é˜µ)ï¼ˆå¦‚æœæœ‰ï¼‰`n   - 9.3 [å½¢è±¡åŒ–è§£é‡Šä¸è®ºè¯](#93-å½¢è±¡åŒ–è§£é‡Šä¸è®ºè¯)ï¼ˆå¦‚æœæœ‰ï¼‰`n   - 9.4 [å­¦ä¹ è·¯å¾„](#94-å­¦ä¹ è·¯å¾„)ï¼ˆå¦‚æœæœ‰ï¼‰`n   - 9.5 [ä¹ é¢˜åº“](#95-ä¹ é¢˜åº“)ï¼ˆå¦‚æœæœ‰ï¼‰`n   - 9.6 [è®¤çŸ¥ç»´åº¦è¡¨å¾](#96-è®¤çŸ¥ç»´åº¦è¡¨å¾)ï¼ˆå¦‚æœæœ‰ï¼‰`n   - 9.7 [ç†æ€§ç»´åº¦è¡¨å¾](#97-ç†æ€§ç»´åº¦è¡¨å¾)ï¼ˆå¦‚æœæœ‰ï¼‰`n   - 9.8 [ç»¼åˆæ•´åˆè¡¨å¾](#98-ç»¼åˆæ•´åˆè¡¨å¾)ï¼ˆå¦‚æœæœ‰ï¼‰"
        $modified = $true
    }

    # ç¡®ä¿æ‰€æœ‰å…¶ä»–éƒ¨åˆ†éƒ½æœ‰ç¼–å·
    if ($content -match '## ğŸ—ºï¸ æ€ç»´å¯¼å›¾' -and $content -notmatch '## 9\.1 ğŸ—ºï¸') {
        $content = $content -replace '## ğŸ—ºï¸ æ€ç»´å¯¼å›¾', '## 9.1 ğŸ—ºï¸ æ€ç»´å¯¼å›¾'
        $modified = $true
    }
    if ($content -match '## ğŸ“Š çŸ¥è¯†å¤šç»´å…³ç³»çŸ©é˜µ' -and $content -notmatch '## 9\.2 ğŸ“Š') {
        $content = $content -replace '## ğŸ“Š çŸ¥è¯†å¤šç»´å…³ç³»çŸ©é˜µ', '## 9.2 ğŸ“Š çŸ¥è¯†å¤šç»´å…³ç³»çŸ©é˜µ'
        $modified = $true
    }
    if ($content -match '## ğŸ’­ å½¢è±¡åŒ–è§£é‡Šä¸è®ºè¯' -and $content -notmatch '## 9\.3 ğŸ’­') {
        $content = $content -replace '## ğŸ’­ å½¢è±¡åŒ–è§£é‡Šä¸è®ºè¯', '## 9.3 ğŸ’­ å½¢è±¡åŒ–è§£é‡Šä¸è®ºè¯'
        $modified = $true
    }
    if ($content -match '## ğŸ“ å­¦ä¹ è·¯å¾„' -and $content -notmatch '## 9\.4 ğŸ“') {
        $content = $content -replace '## ğŸ“ å­¦ä¹ è·¯å¾„', '## 9.4 ğŸ“ å­¦ä¹ è·¯å¾„'
        $modified = $true
    }
    if ($content -match '## ğŸ“š ä¹ é¢˜åº“' -and $content -notmatch '## 9\.5 ğŸ“š') {
        $content = $content -replace '## ğŸ“š ä¹ é¢˜åº“', '## 9.5 ğŸ“š ä¹ é¢˜åº“'
        $modified = $true
    }
    if ($content -match '## ğŸ§  è®¤çŸ¥ç»´åº¦è¡¨å¾' -and $content -notmatch '## 9\.6 ğŸ§ ') {
        $content = $content -replace '## ğŸ§  è®¤çŸ¥ç»´åº¦è¡¨å¾', '## 9.6 ğŸ§  è®¤çŸ¥ç»´åº¦è¡¨å¾'
        $modified = $true
    }
    if ($content -match '## ğŸ§© ç†æ€§ç»´åº¦è¡¨å¾' -and $content -notmatch '## 9\.7 ğŸ§©') {
        $content = $content -replace '## ğŸ§© ç†æ€§ç»´åº¦è¡¨å¾', '## 9.7 ğŸ§© ç†æ€§ç»´åº¦è¡¨å¾'
        $modified = $true
    }
    if ($content -match '## ğŸ§¬ ç»¼åˆæ•´åˆè¡¨å¾' -and $content -notmatch '## 9\.8 ğŸ§¬') {
        $content = $content -replace '## ğŸ§¬ ç»¼åˆæ•´åˆè¡¨å¾', '## 9.8 ğŸ§¬ ç»¼åˆæ•´åˆè¡¨å¾'
        $modified = $true
    }
    if ($content -match '## ğŸ‘¨â€ğŸ« ä¸“å®¶è§‚ç‚¹ä¸è®ºè¯' -and $content -notmatch '## 9\.') {
        $content = $content -replace '## ğŸ‘¨â€ğŸ« ä¸“å®¶è§‚ç‚¹ä¸è®ºè¯', '## 9.9 ğŸ‘¨â€ğŸ« ä¸“å®¶è§‚ç‚¹ä¸è®ºè¯'
        $modified = $true
    }

    # ç¡®ä¿æ‰€æœ‰ä¸»è¦ç« èŠ‚éƒ½æœ‰ç¼–å·
    if ($content -match '## ğŸ“‹ æ¦‚è¿°' -and $content -notmatch '## 1\. ğŸ“‹') {
        $content = $content -replace '## ğŸ“‹ æ¦‚è¿°', '## 1. ğŸ“‹ æ¦‚è¿°'
        $modified = $true
    }
    if ($content -match '## ğŸ¯ ä¸¥æ ¼å®šä¹‰' -and $content -notmatch '## 2\. ğŸ¯') {
        $content = $content -replace '## ğŸ¯ ä¸¥æ ¼å®šä¹‰', '## 2. ğŸ¯ ä¸¥æ ¼å®šä¹‰'
        $modified = $true
    }
    if ($content -match '## ğŸ“š å†å²èƒŒæ™¯' -and $content -notmatch '## 3\. ğŸ“š') {
        $content = $content -replace '## ğŸ“š å†å²èƒŒæ™¯', '## 3. ğŸ“š å†å²èƒŒæ™¯'
        $modified = $true
    }
    if ($content -match '## ğŸ” æ€§è´¨ä¸å®šç†' -and $content -notmatch '## 4\. ğŸ”') {
        $content = $content -replace '## ğŸ” æ€§è´¨ä¸å®šç†', '## 4. ğŸ” æ€§è´¨ä¸å®šç†'
        $modified = $true
    }
    if ($content -match '## ğŸ”¬ å½¢å¼åŒ–è¯æ˜' -and $content -notmatch '## 5\. ğŸ”¬') {
        $content = $content -replace '## ğŸ”¬ å½¢å¼åŒ–è¯æ˜', '## 5. ğŸ”¬ å½¢å¼åŒ–è¯æ˜'
        $modified = $true
    }
    if ($content -match '## ğŸ’¡ åº”ç”¨å®ä¾‹' -and $content -notmatch '## 6\. ğŸ’¡') {
        $content = $content -replace '## ğŸ’¡ åº”ç”¨å®ä¾‹', '## 6. ğŸ’¡ åº”ç”¨å®ä¾‹'
        $modified = $true
    }
    if ($content -match '## ğŸ”— å…³è”æ¦‚å¿µ' -and $content -notmatch '## 7\. ğŸ”—') {
        $content = $content -replace '## ğŸ”— å…³è”æ¦‚å¿µ', '## 7. ğŸ”— å…³è”æ¦‚å¿µ'
        $modified = $true
    }
    if ($content -match '## ğŸ“– å‚è€ƒæ–‡çŒ®' -and $content -notmatch '## 8\. ğŸ“–') {
        $content = $content -replace '## ğŸ“– å‚è€ƒæ–‡çŒ®', '## 8. ğŸ“– å‚è€ƒæ–‡çŒ®'
        $modified = $true
    }

    # ç¡®ä¿æ‰€æœ‰å­ç« èŠ‚éƒ½æœ‰ç¼–å·
    if ($content -match '### åŸºç¡€å®šä¹‰ \(L0\)' -and $content -notmatch '### 2\.1 åŸºç¡€å®šä¹‰') {
        $content = $content -replace '### åŸºç¡€å®šä¹‰ \(L0\)', '### 2.1 åŸºç¡€å®šä¹‰ (L0)'
        $modified = $true
    }
    if ($content -match '### å½¢å¼åŒ–å®šä¹‰ \(L1\)' -and $content -notmatch '### 2\.2 å½¢å¼åŒ–å®šä¹‰') {
        $content = $content -replace '### å½¢å¼åŒ–å®šä¹‰ \(L1\)', '### 2.2 å½¢å¼åŒ–å®šä¹‰ (L1)'
        $modified = $true
    }
    if ($content -match '### å‘å±•è„‰ç»œ' -and $content -notmatch '### 3\.1 å‘å±•è„‰ç»œ') {
        $content = $content -replace '### å‘å±•è„‰ç»œ', '### 3.1 å‘å±•è„‰ç»œ'
        $modified = $true
    }
    if ($content -match '### å…³é”®äººç‰©' -and $content -notmatch '### 3\.2 å…³é”®äººç‰©') {
        $content = $content -replace '### å…³é”®äººç‰©', '### 3.2 å…³é”®äººç‰©'
        $modified = $true
    }
    if ($content -match '### é‡è¦äº‹ä»¶' -and $content -notmatch '### 3\.3 é‡è¦äº‹ä»¶') {
        $content = $content -replace '### é‡è¦äº‹ä»¶', '### 3.3 é‡è¦äº‹ä»¶'
        $modified = $true
    }
    if ($content -match '### åŸºæœ¬æ€§è´¨ \(L1\)' -and $content -notmatch '### 4\.1 åŸºæœ¬æ€§è´¨') {
        $content = $content -replace '### åŸºæœ¬æ€§è´¨ \(L1\)', '### 4.1 åŸºæœ¬æ€§è´¨ (L1)'
        $modified = $true
    }
    if ($content -match '### é‡è¦å®šç† \(L2\)' -and $content -notmatch '### 4\.2 é‡è¦å®šç†') {
        $content = $content -replace '### é‡è¦å®šç† \(L2\)', '### 4.2 é‡è¦å®šç† (L2)'
        $modified = $true
    }
    if ($content -match '### ç†è®ºåº”ç”¨' -and $content -notmatch '### 6\.1 ç†è®ºåº”ç”¨') {
        $content = $content -replace '### ç†è®ºåº”ç”¨', '### 6.1 ç†è®ºåº”ç”¨'
        $modified = $true
    }
    if ($content -match '### å®é™…åº”ç”¨' -and $content -notmatch '### 6\.2 å®é™…åº”ç”¨') {
        $content = $content -replace '### å®é™…åº”ç”¨', '### 6.2 å®é™…åº”ç”¨'
        $modified = $true
    }

    if ($modified) {
        Set-Content -Path $file.FullName -Value $content -Encoding UTF8 -NoNewline
        Write-Host "å·²æ›´æ–°: $($file.Name)"
    } else {
        Write-Host "æ— éœ€æ›´æ–°: $($file.Name)"
    }
}

Write-Host "`næ‰€æœ‰æ–‡ä»¶æ£€æŸ¥å®Œæˆï¼"
